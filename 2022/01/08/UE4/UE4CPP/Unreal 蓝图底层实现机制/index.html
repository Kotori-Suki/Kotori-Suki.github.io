<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹" href="https://kotori_suki.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹" href="https://kotori_suki.github.io/atom.xml"><link rel="alternate" type="application/json" title="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹" href="https://kotori_suki.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://kotori_suki.github.io/2022/01/08/UE4/UE4CPP/Unreal%20%E8%93%9D%E5%9B%BE%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/"><title>Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶ - UE4_C++ - UE4 | Afei's Blog = ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹ = Welcome to my blog !</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2022-01-08 10:03:48"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2022-01-08T10:03:48+08:00">2022-01-08</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Afei's Blog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicliierfjj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclh5u05ej20zk0m87df.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giciub8ja1j20zk0m81ky.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclffsa1cj20zk0m811l.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipewr8iypj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giph4lm9i7j20zk0m84qp.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/UE4/" itemprop="item" rel="index" title="åˆ†ç±»äº UE4"><span itemprop="name">UE4</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/UE4/UE4CPP/" itemprop="item" rel="index" title="åˆ†ç±»äº UE4_C++"><span itemprop="name">UE4_C++</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://kotori_suki.github.io/2022/01/08/UE4/UE4CPP/Unreal%20%E8%93%9D%E5%9B%BE%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="-YIFEI-"><meta itemprop="description" content="Welcome to my blog !, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹"></span><div class="body md" itemprop="articleBody"><h1 id="unreal-è“å›¾åº•å±‚å®ç°æœºåˆ¶"><a class="anchor" href="#unreal-è“å›¾åº•å±‚å®ç°æœºåˆ¶">#</a> Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶</h1><p>ç®€ä»‹ï¼šæœ¬ç¯‡ä¸»è¦è§£æè“å›¾çš„åº•å±‚å®ç°æœºåˆ¶ï¼Œä»è“å›¾çš„åˆ›å»ºç¼–è¯‘åˆ°è“å›¾ç¼–è¾‘å™¨çš„å·¥ä½œæœºåˆ¶çš„ä»‹ç»ã€‚æœ¬ç¯‡å°†å¸¦ä½ è¿›å…¥è“å›¾å¯è§†åŒ–ç¼–ç¨‹çš„åº•å±‚ï¼Œåˆ†æå…¶è“å›¾è¿è¡ŒèƒŒåçš„ç§˜å¯†ã€‚å¦å¤–ä¸çŸ¥é“è¯»è€…æ˜¯å¦é‡åˆ°è¿‡ &quot;SpawnActorFromClass&quot; ç­‰è“å›¾èŠ‚ç‚¹æ— æ³•åœ¨å‡½æ•°åˆ—è¡¨ä¸­æ‰¾åˆ°çš„æƒ…å†µã€‚<a href="#SpawnActor">åŸå› </a>å˜›ï¼Œå’±åé¢åˆ†æï¼Œæ­£å¥½å¯ä»¥è®©æˆ‘å–ä¸ªå…³å­å“ˆå“ˆã€‚</p><h2 id="è“å›¾åº•å±‚å®ç°æœºåˆ¶æ¦‚è¦"><a class="anchor" href="#è“å›¾åº•å±‚å®ç°æœºåˆ¶æ¦‚è¦">#</a> è“å›¾åº•å±‚å®ç°æœºåˆ¶æ¦‚è¦</h2><p>é¦–å…ˆï¼Œè“å›¾ç±»åªä¸è¿‡æ˜¯ <code>UObject</code> çš„ä¸€ä¸ªå­ç±»ï¼Œå…¶åä¸º <code>UBlueprint</code> ã€‚è·Ÿ <code>UObject</code> ä¸€æ ·ï¼Œ <code>UBlueprint</code> æœ‰ç€å±äºè‡ªå·±çš„ <code>UClass</code> ï¼Œåä¸º <code>UBlueprintGeneratedClass</code> ã€‚</p><p>è“å›¾å®é™…ä¸Šæ˜¯ ue ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…å¯è§†åŒ–ç¼–ç¨‹è€Œæ¨å‡ºçš„è„šæœ¬è¯­è¨€ï¼Œå¼•æ“ä¼šæ ¹æ®æˆ‘ä»¬åœ¨ç¼–è¾‘å™¨ä¸­çš„æ“ä½œè‡ªåŠ¨åœ°è½¬æ¢æˆäº†ç›¸åº”çš„ CPP ä»£ç ï¼Œå¦‚ï¼šåˆ›å»ºè“å›¾ï¼Œæ·»åŠ è“å›¾èŠ‚ç‚¹ï¼Œç¼–è¯‘è“å›¾ç­‰ã€‚</p><p>é‚£ä¹ˆï¼Œè¦ç†è§£è“å›¾å®ç°æœºåˆ¶ï¼Œæˆ‘ä»¬åªéœ€è¦ææ¸…æ¥šï¼š</p><ol><li>å¼•æ“æ˜¯æ€ä¹ˆæŠŠç¼–è¾‘å™¨ä¸­çš„è“å›¾è½¬æ¢ä¸ºå¼•æ“å¯è¯†åˆ«çš„ä»£ç ï¼Œå¹¶è¿è¡Œèµ·æ¥çš„ï¼Ÿ</li><li>æˆ‘ä»¬åœ¨ç¼–è¾‘å™¨ä¸­ åˆ›å»ºè“å›¾ï¼Œæ·»åŠ è“å›¾èŠ‚ç‚¹ï¼Œç¼–è¯‘è“å›¾æ—¶ï¼Œå¼•æ“éƒ½åšäº†ä»€ä¹ˆï¼Ÿ</li><li>å¦‚æœè¦è‡ªå®šä¹‰è“å›¾èŠ‚ç‚¹ï¼Œæˆ‘éœ€è¦åšäº›ä»€ä¹ˆï¼Ÿ</li></ol><p>åœ¨å¼€å§‹åˆ†æä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹è¿™å¼ æœ‰è¶£çš„ç±»å›¾ï¼š</p><p><img data-src="%E8%93%9D%E5%9B%BE%E7%B1%BB%E5%9B%BE.png" alt="è“å›¾ç±»å›¾"></p><p>çœ‹èµ·æ¥ä¼¼ä¹æœ‰ç‚¹å¤æ‚...</p><p>ä½†æ²¡å…³ç³»ï¼Œè¯·é™ä¸‹å¿ƒï¼Œä¸å†™è€…ä¸€åŒæ¢ç©¶ ç¼–è¾‘å™¨ä¸­è“å›¾å¼€å‘çš„å„ä¸ªæ­¥éª¤ä¸­çš„å¥¥ç§˜ ğŸ˜ƒ</p><h2 id="åˆ›å»ºè“å›¾"><a class="anchor" href="#åˆ›å»ºè“å›¾">#</a> åˆ›å»ºè“å›¾</h2><p><img data-src="%E5%88%9B%E5%BB%BA%E8%93%9D%E5%9B%BE.png" alt="åˆ›å»ºè“å›¾"></p><p>å¦‚å›¾ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦åˆ›å»ºè“å›¾èµ„æºï¼Œåªéœ€è¦å³é”®ï¼Œé€‰æ‹©è“å›¾ç±»ï¼Œå¹¶æŒ‘é€‰çˆ¶ç±»å³å¯ã€‚</p><p>å½“æˆ‘ä»¬ç¡®è®¤åˆ›å»ºèµ„äº§æ—¶ï¼Œå®é™…ä¸Šå¼•æ“çš„èµ„äº§å·¥å…·ä¼šè°ƒç”¨ <code>CreateAsset</code> ï¼Œä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…ï¼Œå¹¶ç”¨äºè°ƒç”¨ç‰¹å®šå·¥å‚çš„ <code>FactoryCreateNew()</code> ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>CreateAsset</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AssetTools.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function">UObject* <span class="title">UAssetToolsImpl::CreateAsset</span><span class="params">(<span class="keyword">const</span> FString&amp; AssetName, <span class="keyword">const</span> FString&amp; PackagePath, UClass* AssetClass, UFactory* Factory, FName CallingContext)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// .......</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> FString PackageName = UPackageTools::<span class="built_in">SanitizePackageName</span>(PackagePath + <span class="built_in">TEXT</span>(<span class="string">&quot;/&quot;</span>) + AssetName);</span><br><span class="line">    </span><br><span class="line">    UClass* ClassToUse = AssetClass ? AssetClass : (Factory ? Factory-&gt;<span class="built_in">GetSupportedClass</span>() : <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">	UPackage* Pkg = <span class="built_in">CreatePackage</span>(*PackageName);</span><br><span class="line">	UObject* NewObj = <span class="literal">nullptr</span>;</span><br><span class="line">	EObjectFlags Flags = RF_Public|RF_Standalone|RF_Transactional;</span><br><span class="line">	<span class="keyword">if</span> ( Factory )</span><br><span class="line">	&#123;</span><br><span class="line">		NewObj = Factory-&gt;<span class="built_in">FactoryCreateNew</span>(ClassToUse, Pkg, <span class="built_in">FName</span>( *AssetName ), Flags, <span class="literal">nullptr</span>, GWarn, CallingContext);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> ( AssetClass )</span><br><span class="line">	&#123;</span><br><span class="line">		NewObj = NewObject&lt;UObject&gt;(Pkg, ClassToUse, <span class="built_in">FName</span>(*AssetName), Flags);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> NewObj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>è“å›¾èµ„äº§ä¹Ÿä¸ä¾‹å¤–ï¼Œè“å›¾å·¥å‚åˆ›å»ºæ–°è“å›¾çš„ä»£ç å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>UBlueprintFactory::FactoryCreateNew</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// EditorFactories.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function">UObject* <span class="title">UBlueprintFactory::FactoryCreateNew</span><span class="params">(UClass* Class, UObject* InParent, FName Name, EObjectFlags Flags, UObject* Context, FFeedbackContext* Warn, FName CallingContext)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">    </span><br><span class="line">    UClass* BlueprintClass = <span class="literal">nullptr</span>;</span><br><span class="line">	UClass* BlueprintGeneratedClass = <span class="literal">nullptr</span>;</span><br><span class="line">    </span><br><span class="line">    IKismetCompilerInterface&amp; KismetCompilerModule = FModuleManager::LoadModuleChecked&lt;IKismetCompilerInterface&gt;(<span class="string">&quot;KismetCompiler&quot;</span>);</span><br><span class="line">	KismetCompilerModule.<span class="built_in">GetBlueprintTypesForClass</span>(ParentClass, BlueprintClass, BlueprintGeneratedClass);</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">return</span> FKismetEditorUtilities::<span class="built_in">CreateBlueprint</span>(ParentClass, InParent, Name, BPTYPE_Normal, BlueprintClass, BlueprintGeneratedClass, CallingContext);</span><br><span class="line">	</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">UBlueprint* <span class="title">FKismetEditorUtilities::CreateBlueprint</span><span class="params">(UClass* ParentClass, UObject* Outer, <span class="keyword">const</span> FName NewBPName, EBlueprintType BlueprintType, TSubclassOf&lt;UBlueprint&gt; BlueprintClassType, TSubclassOf&lt;UBlueprintGeneratedClass&gt; BlueprintGeneratedClassType, FName CallingContext)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// debugä»£ç </span></span><br><span class="line">    	</span><br><span class="line">    <span class="comment">// åˆ›å»ºæ–°è“å›¾å¯¹è±¡</span></span><br><span class="line">	UBlueprint* NewBP = NewObject&lt;UBlueprint&gt;(Outer, *BlueprintClassType, NewBPName, RF_Public | RF_Standalone | RF_Transactional | RF_LoadCompleted);</span><br><span class="line">	NewBP-&gt;Status = BS_BeingCreated;</span><br><span class="line">	NewBP-&gt;BlueprintType = BlueprintType;</span><br><span class="line">	NewBP-&gt;ParentClass = ParentClass;</span><br><span class="line">	NewBP-&gt;BlueprintSystemVersion = UBlueprint::<span class="built_in">GetCurrentBlueprintSystemVersion</span>();</span><br><span class="line">	NewBP-&gt;bIsNewlyCreated = <span class="literal">true</span>;</span><br><span class="line">	NewBP-&gt;bLegacyNeedToPurgeSkelRefs = <span class="literal">false</span>;</span><br><span class="line">	NewBP-&gt;<span class="built_in">GenerateNewGuid</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºé€šå¸¸æ„é€ è„šæœ¬</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºé»˜è®¤äº‹ä»¶å›¾è¡¨</span></span><br><span class="line">    <span class="comment">// å¤„ç†åŠ¨ç”»è“å›¾</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * åˆ›å»ºåˆå§‹UClass </span></span><br><span class="line"><span class="comment">     * è·³è¿‡CDOéªŒè¯ï¼Œå› ä¸ºç”¨æˆ·æ²¡æœ‰æœºä¼šæ”¹å˜ä»»ä½•é»˜è®¤å€¼ï¼Œ</span></span><br><span class="line"><span class="comment">     * ä¸”æŸäº›æƒ…å†µä¸‹ï¼Œæ–°è“å›¾CDOçš„é»˜è®¤å€¼çš„è®¾ç½®å¯èƒ½è¢«å»¶è¿Ÿåˆ°ç¼–è¯‘å®Œæˆå</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    	<span class="keyword">const</span> EBlueprintCompileOptions CompileOptions =</span><br><span class="line">		EBlueprintCompileOptions::SkipGarbageCollection |</span><br><span class="line">		EBlueprintCompileOptions::SkipDefaultObjectValidation |</span><br><span class="line">		EBlueprintCompileOptions::SkipFiBSearchMetaUpdate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¼–è¯‘UClass</span></span><br><span class="line">	FBlueprintCompilationManager::<span class="built_in">CompileSynchronously</span>(</span><br><span class="line">		<span class="built_in">FBPCompileRequest</span>(NewBP, CompileOptions, <span class="literal">nullptr</span>)</span><br><span class="line">	);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†è“å›¾æ ‡è®°ä¸ºå·²è¢«é‡æ–°ç”Ÿæˆ</span></span><br><span class="line">    NewBP-&gt;bHasBeenRegenerated = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	UBlueprintEditorSettings* Settings = GetMutableDefault&lt;UBlueprintEditorSettings&gt;();</span><br><span class="line">	<span class="keyword">if</span>(Settings &amp;&amp; Settings-&gt;bSpawnDefaultBlueprintNodes)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">// ..... ç”Ÿæˆé»˜è®¤è“å›¾èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºç¨€ç–ç±»æ•°æ®å¹¶è®¾ç½®flag</span></span><br><span class="line">    <span class="comment">// å‘åˆ†æå™¨æŠ¥å‘Šè“å›¾åˆ›å»ºæˆåŠŸ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>ä»¥ä¸Šä»£ç ï¼Œæ ¸å¿ƒåœ¨äºåˆå§‹åŒ–æ–°è“å›¾ç±» <code>UBlueprint</code> çš„åŸºæœ¬å±æ€§ï¼Œç¼–è¯‘æ–°è“å›¾ç±»çš„ <code>UBlueprintGeneratedClass</code> å¯¹è±¡</p><h2 id="ç¼–è¯‘è“å›¾"><a class="anchor" href="#ç¼–è¯‘è“å›¾">#</a> ç¼–è¯‘è“å›¾</h2><p>ç¼–è¯‘è“å›¾åœ¨ <code>FBlueprintCompilationManagerImpl::CompileSynchronouslyImpl</code> ä¸­è¿›è¡Œï¼Œå…¶ä¸»è¦å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š</p><ol><li>å°†éœ€è¦ç¼–è¯‘çš„è“å›¾æ·»åŠ åˆ° <code>QueuedRequests</code> æ•°ç»„ä¸­</li><li><strong>è°ƒç”¨ <code>FlushCompilationQueueImpl()</code> ç¼–è¯‘ <code>QueuedRequests</code> æ•°ç»„ä¸­çš„è“å›¾åŠå…¶ä¾èµ–è“å›¾</strong> (ä¸‹æ–‡å±•å¼€)</li><li>è°ƒç”¨ <code>FlushReinstancingQueueImpl()</code> é‡æ–°å®ä¾‹åŒ–æ‰€æœ‰ç¼–è¯‘çš„è“å›¾ (åªæ˜¯æ›¿æ¢å·²æ›´æ”¹çš„å®ä¾‹)</li><li>æ ¹æ®ç¼–è¯‘çš„è“å›¾ç±»å‹ï¼Œå†³å®šæ˜¯å¦æ›´æ–°å…³å¡è„šæœ¬è“å›¾ï¼Œæ˜¯å¦è¿›è¡Œ GCï¼Œæ˜¯å¦æ›´æ–°æ¡†æ¶ç±»ç­‰</li><li>æœ€åè°ƒç”¨ <code>FEditorFileUtils::PromptForCheckoutAndSave()</code> å°†ç¼–è¯‘è¿‡ä¸”éœ€è¦ä¿å­˜çš„è“å›¾ä¿å­˜èµ·æ¥</li></ol><p>ä»¥ä¸‹æ˜¯ <code>CompileSynchronouslyImpl()</code> å‡½æ•°çš„æ ¸å¿ƒä»£ç ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>FBlueprintCompilationManager::CompileSynchronously</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BlueprintCompilationManager.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FBlueprintCompilationManagerImpl::CompileSynchronouslyImpl</span><span class="params">(<span class="keyword">const</span> FBPCompileRequestInternal&amp; Request)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// .......</span></span><br><span class="line">    QueuedRequests.<span class="built_in">Add</span>(Request);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">bool</span> bSuppressBroadcastCompiled = <span class="literal">true</span>;</span><br><span class="line">	TArray&lt;UBlueprint*&gt; CompiledBlueprints;</span><br><span class="line">	TArray&lt;UBlueprint*&gt; SkeletonCompiledBlueprints;</span><br><span class="line">	<span class="built_in">FlushCompilationQueueImpl</span>(bSuppressBroadcastCompiled, &amp;CompiledBlueprints, &amp;SkeletonCompiledBlueprints, <span class="literal">nullptr</span>);</span><br><span class="line">	<span class="built_in">FlushReinstancingQueueImpl</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// .......</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (CompiledBlueprintsToSave.<span class="built_in">Num</span>() &gt; <span class="number">0</span> &amp;&amp; !bRegenerateSkeletonOnly)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (!bSkipSaving)</span><br><span class="line">		&#123;</span><br><span class="line">			TArray&lt;UPackage*&gt; PackagesToSave;</span><br><span class="line">			<span class="keyword">for</span> (UBlueprint* BP : CompiledBlueprintsToSave)</span><br><span class="line">			&#123;</span><br><span class="line">				PackagesToSave.<span class="built_in">Add</span>(BP-&gt;<span class="built_in">GetOutermost</span>());</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			FEditorFileUtils::<span class="built_in">PromptForCheckoutAndSave</span>(PackagesToSave, <span class="comment">/*bCheckDirty =*/</span><span class="literal">true</span>, <span class="comment">/*bPromptToSave =*/</span><span class="literal">false</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		CompiledBlueprintsToSave.<span class="built_in">Empty</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å·²ç»æ‰‹åŠ¨GCï¼Œé‡Šæ”¾å¯¹æ—§CDOçš„å¼•ç”¨</span></span><br><span class="line">	OldCDOs.<span class="built_in">Empty</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>åœ¨æ·±å…¥è®²è§£è“å›¾çš„ç¼–è¯‘ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼š<strong>ä¸ºä»€ä¹ˆè¦ç¼–è¯‘è“å›¾ï¼Ÿç¼–è¯‘è“å›¾çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>ç›¸ä¿¡èªæ˜çš„ä½ ä¸€ä¸‹å°±èƒ½å›ç­”ä¸Šæ¥ï¼š<strong>å› ä¸ºè“å›¾åªæ˜¯è„šæœ¬ï¼Œæˆ‘ä»¬è¦å°†å…¶ç¼–è¯‘ä¸º CPP ä»£ç æ‰èƒ½è¢«å¼•æ“ä½¿ç”¨ã€‚</strong></p><p>ä¸Šæ–‡å¯çŸ¥ï¼Œ<strong>ç¼–è¯‘è“å›¾çš„é‡ä»»å…¶å®æ˜¯åœ¨ <code>FlushCompilationQueueImpl()</code> ä¸­å®Œæˆçš„</strong>ï¼Œå…¶ä»£ç è¾ƒé•¿ï¼Œæ€»ç»“æ­¥éª¤å¤§è‡´å¦‚ä¸‹ï¼š</p><ol><li>æ·»åŠ ç›¸å…³ä¸”æœªç¼–è¯‘çš„è“å›¾åˆ° <code>CurrentlyCompilingBPs</code> å’Œ <code>BlueprintsToRecompile</code> æ•°ç»„ä¸­ï¼Œå¹¶æ·»åŠ æ‰€æœ‰å­è“å›¾ä»¥ä¾¿å¯ä»¥é‡æ–°é“¾æ¥ã€‚</li><li>è¿‡æ»¤ä¸åŒ…å«ä»»ä½•éœ€è¦é‡ç¼–è¯‘çš„é€»è¾‘æˆ–å˜é‡æˆ–å…ƒç´ çš„è“å›¾ï¼Œå¦‚æœéœ€è¦é‡ç¼–è¯‘åˆ™å°†å…¶æ·»åŠ åˆ° <code>BlueprintsToRecompile</code> æ•°ç»„ä¸­ã€‚</li><li>å°† <code>BlueprintsToRecompile</code> æ•°ç»„ä¸­çš„æ‰€æœ‰è“å›¾å’ŒåŠå…¶æ‰€æœ‰éœ€è¦é‡ç¼–è¯‘çš„å­ç±»è“å›¾æ·»åŠ åˆ° <code>CurrentlyCompilingBPs</code> æ•°ç»„ä¸­ã€‚</li><li>å°† <code>CurrentlyCompilingBPs</code> æ•°ç»„æ’åºä¸ºæ­£ç¡®çš„ç¼–è¯‘é¡ºåºï¼ŒåŸºç±»éœ€è¦åœ¨å­ç±»ä¹‹å‰ç¼–è¯‘ã€‚</li><li>è®¾ç½® <code>CurrentlyCompilingBPs</code> æ•°ç»„ä¸­è“å›¾çš„æ ‡è®° (bBeingCompiled, bIsRegeneratingOnLoad)ã€‚</li><li>éªŒè¯ <code>CurrentlyCompilingBPs</code> æ•°ç»„ä¸­ç¼–è¯‘æ•°æ®çš„æ­£ç¡®æ€§ï¼Œå¹¶ç»™äºˆè“å›¾ç¼–è¾‘çš„å¯èƒ½ã€‚</li><li>æ¸…é™¤ç©ºå›¾ï¼Œä¿®å¤æ•°æ®ã€‚</li><li>å®‰å…¨ç§»é™¤æ—§æ¡†æ¶è“å›¾ CDOs</li><li>é‡ç¼–è¯‘æ¡†æ¶è“å›¾ç±»ï¼Œä¿®å¤ä»£ç†å‚æ•°ï¼Œå¦‚æœå‡½æ•°ç­¾åè¢«æ›´æ”¹ï¼Œåˆ™éœ€è¦é‡ç°ç¼–è¯‘æ‰€æœ‰ä¾èµ–ã€‚</li><li>é‡æ„é€ èŠ‚ç‚¹å¹¶æ›¿æ¢ä¸æ¨èä½¿ç”¨çš„èŠ‚ç‚¹ï¼Œå¹¿æ’­ &quot;è“å›¾é¢„ç¼–è¯‘&quot; ä»£ç†ã€‚</li><li>é‡æ–°å®ä¾‹åŒ–é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªè“å›¾ã€‚æ³¨æ„ï¼šè¿™æ„å‘³ç€ç»§æ‰¿å…³ç³»ä¸­æœªè¢«ç¼–è¯‘çš„ç±»å°†æˆä¸ºé‡æ–°å®ä¾‹åŒ–ç‰ˆæœ¬ç±»çš„çˆ¶ç±»ï¼Œå› æ­¤æ¶‰åŠè¿™äº›ç±»å‹çš„ç±»å‹æ£€æŸ¥ (å¦‚ï¼šIsA ç­‰) å°†ä¸ä¸€è‡´</li><li>é‡æ–°å®ä¾‹åŒ–å®Œæˆï¼Œä¿®å¤å­ç±»çš„çˆ¶ç±»æŒ‡é’ˆã€‚</li><li>** é‡ç¼–è¯‘è“å›¾ã€‚å°†è“å›¾ç¼–è¯‘åˆ° BPGC ä¸­ã€‚** å…³é”®æ­¥éª¤ï¼Œä¸‹æ–‡å±•å¼€</li><li>** ç¼–è¯‘å‡½æ•°ã€‚æ ¹æ®å„ç§å›¾ç”Ÿæˆå­—èŠ‚ç ã€‚** å…³é”®æ­¥éª¤ï¼Œä¸‹æ–‡å±•å¼€</li><li>ç»“æŸé‡æ–°å®ä¾‹åŒ–æ“ä½œçš„ç¬¬ä¸€æ­¥ï¼Œå°†æ—§ç±»ç§»åŠ¨åˆ°æ–°ç±»ä¸­</li><li>åå¤„ç† CDO ç¼–è¯‘</li><li>æ¸…é™¤ä¸´æ—¶æ ‡è®°</li></ol><p>å‚è€ƒä»£ç ï¼šUE_4.27\Engine\Source\Editor\Kismet\PrivateBlueprintCompilationManager.cpp</p><h3 id="é‡ç¼–è¯‘è“å›¾"><a class="anchor" href="#é‡ç¼–è¯‘è“å›¾">#</a> é‡ç¼–è¯‘è“å›¾</h3><p>é‡ç¼–è¯‘è“å›¾ä¸»è¦è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li>æ›´æ–°äº† BPGC ä¸­çš„å±æ€§å‡½æ•°å…ƒä¿¡æ¯</li><li>ä¿®å¤ BPGC ä¸­é‡å†™çš„å‡½æ•°äº‹ä»¶æ¥å£</li><li><strong>åˆ›å»º <code>FunctionList</code> å¹¶å°†è“å›¾ä¸­çš„å‡½æ•°é¢„ç¼–è¯‘åˆ°å…¶ä¸­</strong>ï¼ˆç¼–è¯‘å‡½æ•°çš„å¿…è¦å‰ç½®æ­¥éª¤ï¼‰</li><li>é‡æ–°é“¾æ¥æ­¤ <code>BPGC</code> å’Œå­ç±»è“å›¾ <code>BPGC</code> çš„å±æ€§ä¸ç»“æ„</li><li>æœ€åå¤„ç†é¢å¤–çš„ç¼–è¯‘ä»»åŠ¡ (å¦‚æœæœ‰)ã€‚</li></ol><p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ (é‡è¦æ­¥éª¤æ ‡è®°æ³¨é‡Š)ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>FlushCompilationQueueImpl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BlueprintCompilationManager.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FBlueprintCompilationManagerImpl::FlushCompilationQueueImpl</span><span class="params">(<span class="keyword">bool</span> bSuppressBroadcastCompiled, TArray&lt;UBlueprint*&gt;* BlueprintsCompiled, TArray&lt;UBlueprint*&gt;* BlueprintsCompiledOrSkeletonCompiled, FUObjectSerializeContext* InLoadContext)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// .......</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (FCompilerData&amp; CompilerData : CurrentlyCompilingBPs)</span><br><span class="line">	&#123;</span><br><span class="line">        UBlueprint* BP = CompilerData.BP;</span><br><span class="line">        <span class="keyword">if</span>(CompilerData.<span class="built_in">ShouldCompileClassLayout</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(BP-&gt;ParentClass)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(BP-&gt;GeneratedClass &amp;&amp; !CompilerData.<span class="built_in">IsCppCompileType</span>())</span><br><span class="line">                &#123;</span><br><span class="line">                    BP-&gt;GeneratedClass-&gt;ClassDefaultObject = <span class="literal">nullptr</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// é‡ç½®æ ‡è®°ï¼Œä»¥ä¾¿è“å›¾æœªç¼–è¯‘æ—¶åœ¨PIEä¸­ä½¿ç”¨æ—¶å‘å‡ºè­¦å‘Š</span></span><br><span class="line">                BP-&gt;bDisplayCompilePIEWarning = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// ç¼–è¯‘ BPGC çš„æ ¸å¿ƒå‡½æ•°</span></span><br><span class="line">                FKismetCompilerContext&amp; CompilerContext = *(CompilerData.Compiler);</span><br><span class="line">                CompilerContext.<span class="built_in">CompileClassLayout</span>( EInternalCompilerFlags::PostponeLocalsGenerationUntilPhaseTwo );</span><br><span class="line"></span><br><span class="line">                <span class="comment">// é‡æ–°é“¾æ¥å­è“å›¾ç±»</span></span><br><span class="line">                TArray&lt;UClass*&gt; ClassesToRelink;</span><br><span class="line">                <span class="built_in">GetDerivedClasses</span>(BP-&gt;GeneratedClass, ClassesToRelink, <span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">for</span> (UClass* ChildClass : ClassesToRelink)</span><br><span class="line">                &#123;</span><br><span class="line">                    ChildClass-&gt;<span class="built_in">Bind</span>();</span><br><span class="line">                    ChildClass-&gt;<span class="built_in">StaticLink</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿›è¡Œé¢å¤–çš„ç¼–è¯‘å¤„ç†</span></span><br><span class="line">    <span class="built_in">ProcessExtensions</span>(CurrentlyCompilingBPs);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// .......</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetCompilerContext::CompileClassLayout</span><span class="params">(EInternalCompilerFlags InternalFlags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">PreCompile</span>();</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// .......</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ¸…é™¤æ—§ç±»å¯¹è±¡ä¸­çš„å±æ€§ä»¥ä¾¿åœ¨åŸæ¥çš„ä½ç½®æ·»åŠ æ–°çš„å€¼</span></span><br><span class="line">    <span class="built_in">CleanAndSanitizeClass</span>(TargetClass, OldCDO);</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">		<span class="function">TGuardValue&lt;<span class="keyword">bool</span>&gt; <span class="title">LockDependenciesUpToDate</span><span class="params">(Blueprint-&gt;bCachedDependenciesUpToDate, Blueprint-&gt;bCachedDependenciesUpToDate)</span></span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ç¡®ä¿æ­¤è“å›¾æ›´æ–°åçˆ¶ç±»å‡½æ•°è°ƒç”¨ä»æœ‰æ•ˆï¼Œæ— æ•ˆåˆ™æ¸…é™¤è°ƒç”¨èŠ‚ç‚¹</span></span><br><span class="line">		FBlueprintEditorUtils::<span class="built_in">ConformCallsToParentFunctions</span>(Blueprint);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ç¡®ä¿å¤„ç†çš„äº‹ä»¶å…¨éƒ¨å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æ›´æ¢ä¸ºè‡ªå®šä¹‰äº‹ä»¶</span></span><br><span class="line">		FBlueprintEditorUtils::<span class="built_in">ConformImplementedEvents</span>(Blueprint);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ç¡®ä¿ç»§æ‰¿çš„æ‰€æœ‰æ¥å£çš„æ‰€æœ‰å›¾å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ </span></span><br><span class="line">		FBlueprintEditorUtils::<span class="built_in">ConformImplementedInterfaces</span>(Blueprint);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç”¨ BP åˆ›å»ºå˜é‡ï¼Œå¹¶æ³¨å†Œåˆ° BPGC ä¸­</span></span><br><span class="line">	<span class="built_in">CreateClassVariablesFromBlueprint</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾€ BPGC çš„ Interfaces æ•°ç»„ä¸­æ·»åŠ æ¥å£</span></span><br><span class="line">	<span class="built_in">AddInterfacesFromBlueprint</span>(NewClass);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆå¹¶äº‹ä»¶å›¾ä¸º UberGraph(ä»¥ä¸‹ç®€ç§°ä¸»å›¾)ï¼Œæ ¹æ®ä¸»å›¾å‡½æ•°å…¥å£å¯¹åº”åˆ›å»ºå­˜æ ¹å‡½æ•°</span></span><br><span class="line">    <span class="comment">// ä¸ºå‡½æ•°ä»£ç†æ¥å£å›¾ä¸­çš„å‡½æ•°æ„é€ ä¸Šä¸‹æ–‡ï¼Œå¹¶æ·»åŠ åˆ° FunctionList ä¸­</span></span><br><span class="line">	<span class="built_in">CreateFunctionList</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// é¢„ç¼–è¯‘å‡½æ•°ï¼Œé¦–å…ˆå¤„ç†ä»£ç†ç­¾åï¼Œå› ä¸ºä»£ç†ç­¾åå¯èƒ½è¢«å…¶ä»–å‡½æ•°æ‰€éœ€è¦</span></span><br><span class="line">    <span class="comment">/* é¢„ç¼–è¯‘å‡½æ•°ï¼Œè¿‡ç¨‹å¦‚ä¸‹:</span></span><br><span class="line"><span class="comment">     * æ¸…é™¤ä¸éœ€è¦çš„èŠ‚ç‚¹ï¼Œç¿»è¯‘èŠ‚ç‚¹ï¼Œåˆ›å»ºå­˜æ ¹å‡½æ•°å¹¶å­˜åˆ° FunctionContext çš„ Function ä¸­ï¼Œ</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ– Function ä¸­çš„å„é¡¹å±æ€§å…ƒæ•°æ®ç­‰ï¼Œå°† Function é“¾æ¥åˆ° BPGC çš„å±æ€§é“¾å’Œ FunctionMap ä¸­</span></span><br><span class="line"><span class="comment">     * ä¸ºå‡½æ•°å†…çš„æ¯ä¸ªèŠ‚ç‚¹æ³¨å†Œ Netsï¼ŒNetå¯ä»¥ç†è§£ä¸ºå¼•è„šä¸å€¼çš„å¯¹åº”å…³ç³»ï¼Œæ³¨å†ŒNetå³æ˜¯æŠŠè¿™ç§å¯¹åº”å…³ç³»æ·»åŠ åˆ°å‡½æ•°ä¸Šä¸‹æ–‡çš„ NetMap ä¸­</span></span><br><span class="line"><span class="comment">     * ä¸ºå‡½æ•°åˆ›å»ºå‚æ•°ï¼Œåˆ›å»ºå‡½æ•°æœ¬åœ°å˜é‡ï¼Œåˆ›å»ºæ‰§è¡Œæ¨¡å¼(ä¸ºå‡½æ•°ä¸Šä¸‹æ–‡çš„LinearExecutionListçš„èŠ‚ç‚¹æ’åº)ï¼Œé“¾æ¥ Function ä¸­çš„å‚æ•°åˆ—è¡¨ï¼ŒéªŒè¯å‡½æ•°ç­¾å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; FunctionList.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(FunctionList[i].<span class="built_in">IsDelegateSignature</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">PrecompileFunction</span>(FunctionList[i], InternalFlags);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; FunctionList.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!FunctionList[i].<span class="built_in">IsDelegateSignature</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">PrecompileFunction</span>(FunctionList[i], InternalFlags);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    &#123; </span><br><span class="line">		<span class="comment">// é‡ç°é“¾æ¥æ­¤è“å›¾ç±»çš„å±æ€§å’Œç»“æ„</span></span><br><span class="line">		NewClass-&gt;<span class="built_in">Bind</span>();</span><br><span class="line">		NewClass-&gt;<span class="built_in">StaticLink</span>(<span class="literal">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="ç¼–è¯‘å‡½æ•°"><a class="anchor" href="#ç¼–è¯‘å‡½æ•°">#</a> ç¼–è¯‘å‡½æ•°</h3><p>ç¼–è¯‘å‡½æ•°è¦è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li>ç¼–è¯‘ <code>FunctionList</code> ä¸­çš„æ‰€æœ‰å‡½æ•°<ol><li><strong>ä¸ºæ¯ä¸ªå‡½æ•°ç”Ÿæˆä»£ç  (ä¸æ˜¯çœŸæ­£çš„ä»£ç ï¼Œè€Œæ˜¯è“å›¾ç¼–è¯‘è¯­å¥ï¼Œä¹Ÿå°±æ˜¯ FBlueprintCompiledStatement)</strong></li><li><strong>åå¤„ç†æ‰€æœ‰å‡½æ•°ç¼–è¯‘ (è¿›è¡Œçº¿æ€§æ‰§è¡Œåˆ—è¡¨çš„æœ€ç»ˆæ’åºï¼Œå¤„ç†æ‰€æœ‰æŒ‚èµ·çš„è·³è½¬ä¿®å¤ï¼Œä¼˜åŒ–æ— ç”¨è·³è½¬)</strong></li><li>å¹¿æ’­ <code>FunctionListCompiledEvent</code> äº‹ä»¶ (å‡½æ•°åˆ—è¡¨ç¼–è¯‘å®Œæˆ)</li><li>è®¾ç½® BPGC çš„ç»“æŸæ ‡è®°ï¼Œæ„å»º CDOï¼Œæ„å»ºä»£ç†ç»‘å®šæ˜ å°„ï¼Œæ‹·è´é»˜è®¤å€¼åˆ° CDO ä¸­ï¼Œæ‰§è¡Œ CDO ç¼–è¯‘åå¤„ç† (ä¿®å¤å’Œç¼“å­˜æ–° CDO çš„æ•°æ®)</li><li><strong>å¡«å……å‡½æ•°ä½“å’Œæ¡†æ¶è“å›¾ç±»çš„æ ¹å­˜å‡½æ•°ä½“ (ç”Ÿæˆå­—èŠ‚ç å’Œ cpp ä»£ç ï¼Œä¸‹æ–‡å±•å¼€)</strong></li><li>å°†éœ€è¦ä¾èµ–è¯¥è“å›¾çš„è“å›¾æ ‡è®°ä¸ºè„</li><li>åºåˆ—åŒ– CDO å’Œ BPGC</li><li>ç¼–è¯‘åå¤„ç†</li></ol></li><li>ä¿å­˜éœ€è¦åœ¨ç¼–è¯‘åä¿å­˜çš„è“å›¾</li><li>è®¾ç½® BPGC è¿è¡Œæ—¶å¤åˆ¶æ‰€éœ€çš„æ•°æ®</li><li>æ›´æ–°ä¾èµ–æ­¤è“å›¾çš„æ‰€æœ‰è“å›¾</li></ol><p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ (é‡è¦æ­¥éª¤æ ‡è®°æ³¨é‡Š)ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>FlushCompilationQueueImpl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BlueprintCompilationManager.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FBlueprintCompilationManagerImpl::FlushCompilationQueueImpl</span><span class="params">(<span class="keyword">bool</span> bSuppressBroadcastCompiled, TArray&lt;UBlueprint*&gt;* BlueprintsCompiled, TArray&lt;UBlueprint*&gt;* BlueprintsCompiledOrSkeletonCompiled, FUObjectSerializeContext* InLoadContext)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">    </span><br><span class="line">    <span class="function">FKismetCompilerVMBackend <span class="title">Backend_VM</span><span class="params">(Blueprint, Schema, *<span class="keyword">this</span>)</span></span>;	<span class="comment">// VMåç«¯ï¼Œç”¨äºç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (FCompilerData&amp; CompilerData : CurrentlyCompilingBPs)</span><br><span class="line">    &#123;</span><br><span class="line">        UBlueprint* BP = CompilerData.BP;</span><br><span class="line">        UClass* BPGC = BP-&gt;GeneratedClass;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(BPGC)</span><br><span class="line">        &#123;</span><br><span class="line">            BPGC-&gt;ClassDefaultObject = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç±»å¸ƒå±€å·²å°±ç»ªï¼Œæˆ‘ä»¬å¯ä»¥æ¸…é™¤ CLASS_LayoutChanging æ ‡è®°ï¼ŒCompileFunctions å°†åˆ›å»º CDO </span></span><br><span class="line">            BPGC-&gt;ClassFlags &amp;= ~CLASS_LayoutChanging;</span><br><span class="line"></span><br><span class="line">            FKismetCompilerContext&amp; CompilerContext = *(CompilerData.Compiler);</span><br><span class="line">            CompilerContext.<span class="built_in">CompileFunctions</span>(</span><br><span class="line">                EInternalCompilerFlags::PostponeLocalsGenerationUntilPhaseTwo</span><br><span class="line">                |EInternalCompilerFlags::PostponeDefaultObjectAssignmentUntilReinstancing</span><br><span class="line">                |EInternalCompilerFlags::SkipRefreshExternalBlueprintDependencyNodes</span><br><span class="line">            ); </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¿å­˜éœ€è¦åœ¨ç¼–è¯‘åä¿å­˜çš„è“å›¾</span></span><br><span class="line">        <span class="keyword">if</span>(!BP-&gt;bIsRegeneratingOnLoad)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(bSaveBlueprintsAfterCompile || (bSaveBlueprintAfterCompileSucceeded &amp;&amp; BP-&gt;Status == BS_UpToDate))</span><br><span class="line">            &#123;</span><br><span class="line">                CompiledBlueprintsToSave.<span class="built_in">Add</span>(BP);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¾ç½® BPGC è¿è¡Œæ—¶å¤åˆ¶æ‰€éœ€çš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span>(BPGC)</span><br><span class="line">        &#123;</span><br><span class="line">            BPGC-&gt;ClassFlags &amp;= ~CLASS_ReplicationDataIsSetUp;</span><br><span class="line">            BPGC-&gt;<span class="built_in">SetUpRuntimeReplicationData</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›´æ–°ä¾èµ–è¯¥è“å›¾çš„æ‰€æœ‰è“å›¾</span></span><br><span class="line">        FKismetCompilerUtilities::<span class="built_in">UpdateDependentBlueprints</span>(BP);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetCompilerContext::CompileFunctions</span><span class="params">(EInternalCompilerFlags InternalFlags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (bIsFullCompile &amp;&amp; !MessageLog.NumErrors)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">// ä¸ºæ¯ä¸ªå‡½æ•°ç”Ÿæˆä»£ç ï¼Œä¸‹æ–‡å±•å¼€</span></span><br><span class="line">        <span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; FunctionList.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (FunctionList[i].<span class="built_in">IsValid</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">CompileFunction</span>(FunctionList[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åå¤„ç†æ‰€æœ‰å‡½æ•°ï¼Œä¸‹æ–‡å±•å¼€</span></span><br><span class="line">        <span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; FunctionList.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (FunctionList[i].<span class="built_in">IsValid</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">PostcompileFunction</span>(FunctionList[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¯¹äºæ¡†æ¶ç±»ä»éœ€è®¾ç½®å‡½æ•°çš„æ ‡è®°</span></span><br><span class="line">		<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; FunctionList.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			FKismetFunctionContext&amp; Function = FunctionList[i];</span><br><span class="line">			<span class="keyword">if</span> (Function.<span class="built_in">IsValid</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">FinishCompilingFunction</span>(Function);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¹¿æ’­ &quot;å‡½æ•°åˆ—è¡¨ç¼–è¯‘å®Œæˆäº‹ä»¶&quot; ä»£ç†</span></span><br><span class="line">    FunctionListCompiledEvent.<span class="built_in">Broadcast</span>(<span class="keyword">this</span>);</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®æ‰€æœ‰ç»“æŸæ ‡è®°ï¼Œå…³é—­å¯¹ç±»çš„ä¿®æ”¹ï¼Œæ„å»ºCDOç­‰</span></span><br><span class="line">        <span class="built_in">FinishCompilingClass</span>(NewClass);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¦‚æœæœ‰ä¸»å›¾ï¼Œæ„å»ºä»£ç†ç»‘å®šæ˜ å°„</span></span><br><span class="line">		<span class="keyword">if</span> (ConsolidatedEventGraph)</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// æ„å»ºè¯¥ç±»çš„æ‰€æœ‰åŠ¨æ€ç»‘å®šä¿¡æ¯</span></span><br><span class="line">			<span class="built_in">BuildDynamicBindingObjects</span>(NewClass);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		UObject* NewCDO = NewClass-&gt;<span class="built_in">GetDefaultObject</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‹·è´æ‰€æœ‰åœ¨è¯»å–æ—¶æœªé‡æ–°ç”Ÿæˆçš„çˆ¶ç±»è“å›¾ç±»çš„å±æ€§åˆ°æ­¤è“å›¾æ¡†æ¶ CDO ä¸­ï¼Œæ‹·è´çš„å±æ€§å°†åœ¨åŠ è½½ç¼–è¯‘ç»“æŸåè¢«å¤„ç†</span></span><br><span class="line">		FBlueprintEditorUtils::<span class="built_in">PropagateParentBlueprintDefaults</span>(NewClass);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(bPropagateValuesToCDO)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>( !Blueprint-&gt;<span class="built_in">HasAnyFlags</span>(RF_BeingRegenerated) )</span><br><span class="line">			&#123;</span><br><span class="line">                <span class="comment">// å°†æ—§ CDO ä¸­çš„å€¼ä¼ è¾¾æ–° CDO ä¸­</span></span><br><span class="line">				<span class="keyword">if</span>( OldCDO )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span> (OldLinker &amp;&amp; OldGenLinkerIdx != INDEX_NONE)</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="comment">// å¦‚æœæœ‰æ­£åœ¨åŠ è½½çš„å¯¹è±¡åˆ—è¡¨ï¼Œåˆ™ä¿®å¤å¯¼å‡ºè¡¨ã€‚æ­¤æ­¥éª¤ä¹Ÿå°†ä¿®å¤åŠ è½½æ ‡è®°</span></span><br><span class="line">						FBlueprintEditorUtils::<span class="built_in">PatchNewCDOIntoLinker</span>(Blueprint-&gt;GeneratedClass-&gt;<span class="built_in">GetDefaultObject</span>(), OldLinker, OldGenLinkerIdx, <span class="literal">nullptr</span>);</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					UEditorEngine::FCopyPropertiesForUnrelatedObjectsParams CopyDetails;</span><br><span class="line">					CopyDetails.bCopyDeprecatedProperties = Blueprint-&gt;bIsRegeneratingOnLoad;</span><br><span class="line">					CopyDetails.bNotifyObjectReplacement = <span class="literal">true</span>; </span><br><span class="line">					UEditorEngine::<span class="built_in">CopyPropertiesForUnrelatedObjects</span>(OldCDO, NewCDO, CopyDetails);</span><br><span class="line">					FBlueprintEditorUtils::<span class="built_in">PatchCDOSubobjectsIntoExport</span>(OldCDO, NewCDO);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">					<span class="comment">// ä¸æ‰§è¡Œç”Ÿæˆç±»éªŒè¯ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹ä»»ä½•å€¼</span></span><br><span class="line">					bSkipGeneratedClassValidation = <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">PropagateValuesToCDO</span>(NewCDO, OldCDO);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// åŸºäºæ–°CDOæ‰§è¡Œä¿®å¤å’Œç¼“å­˜</span></span><br><span class="line">			<span class="built_in">PostCDOCompiled</span>();</span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ›´æ–°ç”¨äºæ„é€ åå¤„ç†çš„è‡ªå®šä¹‰å±æ€§åˆ—è¡¨</span></span><br><span class="line">        <span class="comment">// æ³¨æ„: BPGCé‡æ–°ç”Ÿæˆæ—¶ï¼Œæ—§CDOåˆ°æ–°CDOçš„æ‹·è´æ—¶å»¶è¿Ÿæ‰§è¡Œçš„ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹ï¼Œå°†è·³è¿‡æ­¤æ­¥éª¤</span></span><br><span class="line">		<span class="keyword">if</span> (!Blueprint-&gt;<span class="built_in">HasAnyFlags</span>(RF_BeingRegenerated))</span><br><span class="line">		&#123;</span><br><span class="line">			TargetClass-&gt;<span class="built_in">UpdateCustomPropertyListForPostConstruction</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡ŒVMåç«¯ï¼Œç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">const</span> <span class="keyword">bool</span> bGenerateStubsOnly = !bIsFullCompile || (<span class="number">0</span> != MessageLog.NumErrors);</span><br><span class="line">			Backend_VM.<span class="built_in">GenerateCodeFromClass</span>(NewClass, FunctionList, bGenerateStubsOnly);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¡«å……å‡½æ•°çš„ ScriptAndPropertyObjectReferences æ•°ç»„</span></span><br><span class="line">		<span class="keyword">if</span> (bIsFullCompile &amp;&amp; (<span class="number">0</span> == MessageLog.NumErrors))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (FKismetFunctionContext&amp; FunctionContext : FunctionList)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (FunctionContext.<span class="built_in">IsValid</span>())</span><br><span class="line">				&#123;</span><br><span class="line">					UFunction* Function = FunctionContext.Function; </span><br><span class="line">					<span class="function">FArchiveScriptReferenceCollector <span class="title">ObjRefCollector</span><span class="params">(Function-&gt;ScriptAndPropertyObjectReferences)</span></span>;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">for</span> (int32 iCode = <span class="number">0</span>; iCode &lt; Function-&gt;Script.<span class="built_in">Num</span>();)</span><br><span class="line">					&#123;</span><br><span class="line">						Function-&gt;<span class="built_in">SerializeExpr</span>(iCode, ObjRefCollector);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (bDisplayBytecode &amp;&amp; bIsFullCompile &amp;&amp; !<span class="built_in">IsRunningCommandlet</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="function">TGuardValue&lt;ELogTimes::Type&gt; <span class="title">DisableLogTimes</span><span class="params">(GPrintLogTimes, ELogTimes::None)</span></span>;</span><br><span class="line"></span><br><span class="line">			<span class="function">FKismetBytecodeDisassembler <span class="title">Disasm</span><span class="params">(*GLog)</span></span>;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// åæ±‡ç¼–è„šæœ¬ä»£ç ï¼Œè¾“å‡ºå‡½æ•°ç”Ÿæˆçš„å­—èŠ‚ç </span></span><br><span class="line">			<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; FunctionList.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">			&#123;</span><br><span class="line">				FKismetFunctionContext&amp; Function = FunctionList[i];</span><br><span class="line">				<span class="keyword">if</span> (Function.<span class="built_in">IsValid</span>())</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">UE_LOG</span>(LogK2Compiler, Log, <span class="built_in">TEXT</span>(<span class="string">&quot;\n\n[function %s]:\n&quot;</span>), *(Function.Function-&gt;<span class="built_in">GetName</span>()));</span><br><span class="line">					Disasm.<span class="built_in">DisassembleStructure</span>(Function.Function);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// é€šè¿‡cppåç«¯ç”Ÿæˆcppä»£ç </span></span><br><span class="line">		<span class="keyword">if</span> ((bDisplayCpp &amp;&amp; bIsFullCompile &amp;&amp; !<span class="built_in">IsRunningCommandlet</span>()) || CompileOptions.<span class="built_in">DoesRequireCppCodeGeneration</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="function">TUniquePtr&lt;IBlueprintCompilerCppBackend&gt; <span class="title">Backend_CPP</span><span class="params">(IBlueprintCompilerCppBackendModuleInterface::Get().Create())</span></span>;</span><br><span class="line">			HeaderSourceCode = Backend_CPP-&gt;<span class="built_in">GenerateCodeFromClass</span>(NewClass, FunctionList, !bIsFullCompile, CompileOptions.NativizationOptions, CppSourceCode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯å®Œå…¨ç¼–è¯‘ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹ä»£ç å¯»æ‰¾éœ€è¦åˆ·æ–°çš„è“å›¾ï¼Œå¹¶å°†å…¶æ ‡è„</span></span><br><span class="line">	<span class="keyword">if</span>( bIsFullCompile &amp;&amp; !Blueprint-&gt;bIsRegeneratingOnLoad &amp;&amp; !bSkipRefreshExternalBlueprintDependencyNodes )</span><br><span class="line">	&#123;</span><br><span class="line">		TArray&lt;UBlueprint*&gt; DependentBlueprints;</span><br><span class="line">		FBlueprintEditorUtils::<span class="built_in">GetDependentBlueprints</span>(Blueprint, DependentBlueprints);</span><br><span class="line">		<span class="keyword">for</span> (UBlueprint* CurrentBP : DependentBlueprints)</span><br><span class="line">		&#123;</span><br><span class="line">			FBlueprintEditorUtils::<span class="built_in">RefreshExternalBlueprintDependencyNodes</span>(CurrentBP, NewClass);</span><br><span class="line">			<span class="keyword">if</span>(Package != <span class="literal">nullptr</span> &amp;&amp; Package-&gt;<span class="built_in">IsDirty</span>() &amp;&amp; !bStartedWithUnsavedChanges)</span><br><span class="line">			&#123;</span><br><span class="line">				Package-&gt;<span class="built_in">SetDirtyFlag</span>(<span class="literal">false</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åºåˆ—åŒ–æ–°CDOï¼Œå¹¶åˆ·æ–°è“å›¾ä¸­çš„ CrcLastCompiledCDO å±æ€§(è®°å½•ç¼–è¯‘æ˜¯å¦æ”¹å˜é»˜è®¤å€¼)</span></span><br><span class="line">	<span class="comment">// åºåˆ—åŒ–æ–°BPGCï¼Œå¹¶åˆ·æ–°è“å›¾ä¸­çš„ CrcLastCompiledSignature å±æ€§ </span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">// ç¼–è¯‘åå¤„ç†ï¼Œå¹¿æ’­ &quot;OnPostCompile&quot; ä»£ç†</span></span><br><span class="line">	<span class="built_in">PostCompile</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>ç¼–è¯‘å®Œäº†ï¼å“ï¼Œå…ˆåˆ«æ€¥ç€ä¼‘æ¯ï¼Œå’±å…ˆæŠŠä¸€äº›ç»†èŠ‚ææ¸…æ¥šï¼</p><h4 id="ç¼–è¯‘å•ä¸ªå‡½æ•°"><a class="anchor" href="#ç¼–è¯‘å•ä¸ªå‡½æ•°">#</a> ç¼–è¯‘å•ä¸ªå‡½æ•°</h4><p>ç¼–è¯‘å‡½æ•°çš„ç¬¬ä¸€æ­¥å³æ˜¯è°ƒç”¨ <code>CompileFunction</code> ä¸º <code>FunctionList</code> ä¸­çš„æ¯ä¸ªå‡½æ•°ç”Ÿæˆ <code>Statements</code> ï¼Œç„¶åå°†çº¯èŠ‚ç‚¹ (æ²¡æœ‰æ‰§è¡Œå¼•è„šçš„èŠ‚ç‚¹) åˆå¹¶åˆ°éçº¯èŠ‚ç‚¹ä¸­ï¼Œæœ€ååˆ†ç¦»å¯ä»¥ç‹¬ç«‹æ‰§è¡Œçš„èŠ‚ç‚¹ä»¥å¤‡... mark (å¦‚ï¼šäº‹ä»¶èŠ‚ç‚¹)</p><p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>CompileFunction</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetCompilerContext::CompileFunction</span><span class="params">(FKismetFunctionContext&amp; Context)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆ statements (æ³¨æ„: è¿™é‡Œçš„èŠ‚ç‚¹é¡ºåºå¹¶ä¸æ˜¯æœ€ç»ˆæ‰§è¡Œé¡ºåº)</span></span><br><span class="line">	TMap&lt;UEdGraphNode*, int32&gt; SortKeyMap;</span><br><span class="line">	int32 NumNodesAtStart = Context.LinearExecutionList.<span class="built_in">Num</span>();</span><br><span class="line">	<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; Context.LinearExecutionList.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		UEdGraphNode* Node = Context.LinearExecutionList[i];</span><br><span class="line">		SortKeyMap.<span class="built_in">Add</span>(Node, i);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// çœŸæ­£ç”Ÿæˆ statement çš„å‡½æ•°ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰èŠ‚ç‚¹éœ€è¦å®ç°æ­¤æ–¹æ³•</span></span><br><span class="line">		Handler-&gt;<span class="built_in">Compile</span>(Context, Node);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†çº¯èŠ‚ç‚¹ä»£ç å†…è”åˆ°éœ€è¦è¯¥çº¯èŠ‚ç‚¹çš„éçº¯èŠ‚ç‚¹çš„ä»£ç ä¸­ï¼Œå¹¶å°†çº¯èŠ‚ç‚¹æ’¤å‡ºåˆ—è¡¨</span></span><br><span class="line">	TMap&lt; UEdGraphNode*, TSet&lt;UEdGraphNode*&gt; &gt; PureNodesNeeded;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (int32 TestIndex = <span class="number">0</span>; TestIndex &lt; Context.LinearExecutionList.<span class="built_in">Num</span>(); )</span><br><span class="line">	&#123;</span><br><span class="line">		UEdGraphNode* Node = Context.LinearExecutionList[TestIndex];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// æ­¤èŠ‚ç‚¹ä¾èµ–çš„çº¯èŠ‚ç‚¹åˆ—è¡¨</span></span><br><span class="line">		<span class="keyword">bool</span> bHasAntecedentPureNodes = PureNodesNeeded.<span class="built_in">Contains</span>(Node);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">IsNodePure</span>(Node))</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// å¯»æ‰¾æ ‡è®°ä¸ºå‡½æ•°å…¥å£çš„èŠ‚ç‚¹çš„ statement</span></span><br><span class="line">			FBlueprintCompiledStatement* ProfilerStatement = <span class="literal">nullptr</span>;</span><br><span class="line">			TArray&lt;FBlueprintCompiledStatement*&gt;* SourceStatementList = Context.StatementsPerNode.<span class="built_in">Find</span>(Node);</span><br><span class="line">			<span class="keyword">const</span> <span class="keyword">bool</span> bDidNodeGenerateCode = SourceStatementList != <span class="literal">nullptr</span> &amp;&amp; SourceStatementList-&gt;<span class="built_in">Num</span>() &gt; <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span> (bDidNodeGenerateCode)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span> (FBlueprintCompiledStatement* Statement : *SourceStatementList)</span><br><span class="line">				&#123;</span><br><span class="line">                    <span class="comment">// KCST_InstrumentedPureNodeEntry ç±»å‹çš„ statement å¯¹åº”å‡½æ•°å…¥å£çº¯èŠ‚ç‚¹</span></span><br><span class="line">					<span class="keyword">if</span> (Statement &amp;&amp; Statement-&gt;Type == KCST_InstrumentedPureNodeEntry)</span><br><span class="line">					&#123;</span><br><span class="line">						ProfilerStatement = Statement;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// æ ¹æ®è¾“å‡ºå¼•è„šï¼Œå°†å½“å‰èŠ‚ç‚¹æ·»åŠ åˆ°å…¶ä»–èŠ‚ç‚¹çš„ä¾èµ–åˆ—è¡¨ä¸­(å¦‚æœæ­¤èŠ‚ç‚¹æœ‰æ„ä¹‰)</span></span><br><span class="line">			<span class="keyword">if</span> (bDidNodeGenerateCode || bHasAntecedentPureNodes)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span> (int32 PinIndex = <span class="number">0</span>; PinIndex &lt; Node-&gt;Pins.<span class="built_in">Num</span>(); ++PinIndex)</span><br><span class="line">				&#123;</span><br><span class="line">					UEdGraphPin* Pin = Node-&gt;Pins[PinIndex];</span><br><span class="line">					<span class="keyword">if</span> (Pin-&gt;Direction == EGPD_Output &amp;&amp; Pin-&gt;LinkedTo.<span class="built_in">Num</span>() &gt; <span class="number">0</span>)</span><br><span class="line">					&#123;</span><br><span class="line">                        <span class="comment">// è®°å½•çº¯èŠ‚ç‚¹ä¸­å·²è¿æ¥çš„è¾“å‡ºå¼•è„š</span></span><br><span class="line">						<span class="keyword">if</span> (ProfilerStatement)</span><br><span class="line">						&#123;</span><br><span class="line">							ProfilerStatement-&gt;PureOutputContextArray.<span class="built_in">AddUnique</span>(Pin);</span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">for</span> (UEdGraphPin* LinkedTo : Pin-&gt;LinkedTo)</span><br><span class="line">						&#123;</span><br><span class="line">							UEdGraphNode* NodeUsingOutput = LinkedTo-&gt;<span class="built_in">GetOwningNode</span>();</span><br><span class="line">							<span class="keyword">if</span> (NodeUsingOutput != <span class="literal">nullptr</span>)</span><br><span class="line">							&#123;</span><br><span class="line">                                <span class="comment">// æ·»åŠ æ­¤èŠ‚ç‚¹å’Œå…¶ä»–æ­¤èŠ‚ç‚¹ä¾èµ–çš„èŠ‚ç‚¹åˆ°è¾“å‡ºå¼•è„šè¿æ¥çš„èŠ‚ç‚¹çš„éœ€æ±‚åˆ—è¡¨</span></span><br><span class="line">								TSet&lt;UEdGraphNode*&gt;&amp; TargetNodesRequired = PureNodesNeeded.<span class="built_in">FindOrAdd</span>(NodeUsingOutput);</span><br><span class="line">								TargetNodesRequired.<span class="built_in">Add</span>(Node);</span><br><span class="line">								<span class="keyword">if</span> (bHasAntecedentPureNodes)</span><br><span class="line">								&#123;</span><br><span class="line">									TargetNodesRequired.<span class="built_in">Append</span>(PureNodesNeeded.<span class="built_in">FindChecked</span>(Node));</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// ä» LinearExecutionList ä¸­ç§»é™¤æ­¤èŠ‚ç‚¹ï¼Œä¾èµ–èŠ‚ç‚¹å°†å†…è”æ­¤èŠ‚ç‚¹çš„ä»£ç </span></span><br><span class="line">			Context.LinearExecutionList.<span class="built_in">RemoveAt</span>(TestIndex);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (bHasAntecedentPureNodes)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">// å¦‚æœæ­¤èŠ‚ç‚¹è¿æ¥äº†çº¯èŠ‚ç‚¹çš„è¾“å‡ºå¼•è„šï¼Œåœ¨æ­¤å°†çº¯èŠ‚ç‚¹ä»£ç å†…è”åˆ°æ­¤èŠ‚ç‚¹çš„ statement ä¸­</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">// æ ¹æ®æ‰§è¡Œé¡ºåºä¸‹æ ‡æ’åºèŠ‚ç‚¹</span></span><br><span class="line">				TSet&lt;UEdGraphNode*&gt;&amp; AntecedentPureNodes = PureNodesNeeded.<span class="built_in">FindChecked</span>(Node);</span><br><span class="line">				TArray&lt;UEdGraphNode*&gt; SortedPureNodes;</span><br><span class="line">				<span class="keyword">for</span> (TSet&lt;UEdGraphNode*&gt;::TIterator <span class="built_in">It</span>(AntecedentPureNodes); It; ++It)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">OrderedInsertIntoArray</span>(SortedPureNodes, SortKeyMap, *It);</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">// å†…è”ä»£ç </span></span><br><span class="line">				<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; SortedPureNodes.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">				&#123;</span><br><span class="line">					UEdGraphNode* NodeToInline = SortedPureNodes[SortedPureNodes.<span class="built_in">Num</span>() - <span class="number">1</span> - i];</span><br><span class="line"></span><br><span class="line">					Context.<span class="built_in">CopyAndPrependStatements</span>(Node, NodeToInline);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// å¤„ç†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">			++TestIndex;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ°è¿™é‡Œï¼Œå’±çš„çº¯èŠ‚ç‚¹ä»£ç çš„å†…è”å·²ç»ç»“æŸï¼Œä¸”æ‰€æœ‰çº¯èŠ‚ç‚¹å·²è¢«ç§»å‡º LinearExecutionList</span></span><br><span class="line">    <span class="comment">// æ¥ä¸‹æ¥ï¼Œåˆå§‹åŒ– Context.UnsortedSeparateExecutionGroups (å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„æœªæ’åºå•ç‹¬æ‰§è¡Œç»„)</span></span><br><span class="line">    <span class="comment">// æ­¤å˜é‡ç±»å‹ä¸º TArray&lt;TSet&lt;UEdGraphNode*&gt;&gt;ï¼Œæ¯ä¸ªé›†åˆä¸­è£…ç€ä¸€ç»„ç‹¬ç«‹çš„æ‰§è¡Œçº¿</span></span><br><span class="line">	<span class="keyword">if</span> (Context.bIsUbergraph &amp;&amp; CompileOptions.<span class="built_in">DoesRequireCppCodeGeneration</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		Context.UnsortedSeparateExecutionGroups = FKismetCompilerUtilities::<span class="built_in">FindUnsortedSeparateExecutionGroups</span>(Context.LinearExecutionList);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>è¿™é‡Œæœ‰äº›åŒå­¦å¯èƒ½ä¼šé—®ï¼š<strong>åœ¨åˆå§‹åŒ–å’Œä½¿ç”¨ <code>PureNodesNeeded</code> æ—¶ï¼Œæ€ä¹ˆä¿è¯çº¯èŠ‚ç‚¹ä¸€å®šåœ¨éçº¯èŠ‚ç‚¹ä¹‹å‰è¢«å¤„ç†ï¼Ÿ</strong></p><p>å…¶å®æ˜¯å› ä¸ºåœ¨æ­¤ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯é‡ç¼–è¯‘è“å›¾çš„æ—¶å€™ï¼Œå‡†ç¡®åœ°è¯´æ˜¯é¢„ç¼–è¯‘å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å·²ç»å¯¹ <code>LinearExecutionList</code> ä¸­çš„èŠ‚ç‚¹è¿›è¡Œäº†æ’åºã€‚ä»¥ä¸‹æ˜¯æ’åºçš„æ ¸å¿ƒä»£ç ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>CreateExecutionSchedule</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è°ƒç”¨é“¾: CompileClassLayout -&gt; PreCompileFunction -&gt; CreateLocalsAndRegisterNets</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FGraphCompilerContext::CreateExecutionSchedule</span><span class="params">(<span class="keyword">const</span> TArray&lt;UEdGraphNode*&gt;&amp; GraphNodes, <span class="comment">/*out*/</span> TArray&lt;UEdGraphNode*&gt;&amp; LinearExecutionSchedule)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    TArray&lt;UEdGraphNode*&gt; NodesWithNoEdges;</span><br><span class="line">	TMap&lt;UEdGraphNode*, int32&gt; NumIncomingEdges;</span><br><span class="line">	int32 TotalGraphEdgesLeft = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ„å»ºæ²¡æœ‰å‰é¡¹çš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œæ›´æ–°æ¯ä¸ªèŠ‚ç‚¹çš„åˆå§‹è¾“å…¥è¾¹çš„æ•°é‡</span></span><br><span class="line">	<span class="keyword">for</span> (int32 NodeIndex = <span class="number">0</span>; NodeIndex &lt; GraphNodes.<span class="built_in">Num</span>(); ++NodeIndex)</span><br><span class="line">	&#123;</span><br><span class="line">		UEdGraphNode* Node = GraphNodes[NodeIndex];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">const</span> int32 NumEdges = <span class="built_in">CountIncomingEdges</span>(Node);</span><br><span class="line">		NumIncomingEdges.<span class="built_in">Add</span>(Node, NumEdges);</span><br><span class="line">		TotalGraphEdgesLeft += NumEdges;</span><br><span class="line">			</span><br><span class="line">		<span class="keyword">if</span> (NumEdges == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			NodesWithNoEdges.<span class="built_in">Add</span>(Node);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒåº¦èŠ‚ç‚¹å¹¶å°†å¯è°ƒåº¦çš„æ–°èŠ‚ç‚¹è¿›è¡Œæ’é˜Ÿ</span></span><br><span class="line">	<span class="keyword">while</span> (NodesWithNoEdges.<span class="built_in">Num</span>() &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// è°ƒåº¦èŠ‚ç‚¹ï¼Œå°†æ²¡æœ‰å‰é¡¹çš„èŠ‚ç‚¹æ·»åŠ åˆ° LinearExecutionSchedule åˆ—è¡¨ä¸­</span></span><br><span class="line">		UEdGraphNode* Node = NodesWithNoEdges[<span class="number">0</span>];</span><br><span class="line">		NodesWithNoEdges.<span class="built_in">RemoveAtSwap</span>(<span class="number">0</span>);</span><br><span class="line">		LinearExecutionSchedule.<span class="built_in">Add</span>(Node);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// å‡å°‘è¿æ¥æ­¤èŠ‚ç‚¹çš„è¾¹çš„è®¡æ•°ï¼Œå°†å‡å°‘è‡³0çš„èŠ‚ç‚¹æ·»åŠ åˆ° NodesWithNoEdges æ•°ç»„ä¸­ï¼Œç­‰å¾…ä¸‹æ¬¡è°ƒåº¦</span></span><br><span class="line">		<span class="keyword">for</span> (int32 PinIndex = <span class="number">0</span>; PinIndex &lt; Node-&gt;Pins.<span class="built_in">Num</span>(); ++PinIndex)</span><br><span class="line">		&#123;</span><br><span class="line">			UEdGraphPin* OutPin = Node-&gt;Pins[PinIndex];</span><br><span class="line">			<span class="keyword">if</span> ((OutPin-&gt;Direction == EGPD_Output) &amp;&amp; <span class="built_in">PinIsImportantForDependancies</span>(OutPin))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span> (int32 LinkIndex = <span class="number">0</span>; LinkIndex &lt; OutPin-&gt;LinkedTo.<span class="built_in">Num</span>(); ++LinkIndex)</span><br><span class="line">				&#123;</span><br><span class="line">					UEdGraphNode* WasDependentNode = OutPin-&gt;LinkedTo[LinkIndex]-&gt;<span class="built_in">GetOwningNodeUnchecked</span>();</span><br><span class="line">					int32* pNumEdgesLeft = WasDependentNode ? NumIncomingEdges.<span class="built_in">Find</span>(WasDependentNode) : <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// å‡å°‘è¿æ¥è¯¥èŠ‚ç‚¹çš„èŠ‚ç‚¹çš„è¾¹è®¡æ•°ï¼Œå› ä¸ºè¯¥èŠ‚ç‚¹å·²ç»è¢«è°ƒåº¦</span></span><br><span class="line">					<span class="keyword">if</span> (pNumEdgesLeft)</span><br><span class="line">					&#123;</span><br><span class="line">						int32&amp; NumEdgesLeft = *pNumEdgesLeft;</span><br><span class="line"></span><br><span class="line">						NumEdgesLeft--;</span><br><span class="line">						TotalGraphEdgesLeft--;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// ä¸å†æœ‰ä»»ä½•è¾¹è®¡æ•°ï¼Œåˆ™å°†æ­¤è¿æ¥èŠ‚ç‚¹æ·»åŠ åˆ° NodesWithNoEdges åˆ—è¡¨ä¸­</span></span><br><span class="line">						<span class="keyword">if</span> (NumEdgesLeft == <span class="number">0</span>)</span><br><span class="line">						&#123;</span><br><span class="line">							NodesWithNoEdges.<span class="built_in">Add</span>(WasDependentNode);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><code>CreateExecutionSchedule</code> å‡½æ•°æ˜¯æ ¹æ®æ‰€æœ‰èŠ‚ç‚¹å½“å‰æ˜¯å¦æœ‰è¾“å…¥è®¡æ•°æ¥æ’åºçš„ï¼Œæ²¡æœ‰åˆ™å…¥é˜Ÿã€‚ç„¶åéå†ç§»é™¤å…¥é˜ŸèŠ‚ç‚¹ï¼Œå¹¶å°†å…¥é˜ŸèŠ‚ç‚¹çš„è¾“å‡ºå¼•è„šæ‰€è¿æ¥çš„èŠ‚ç‚¹çš„è¾“å…¥è®¡æ•°å‡ä¸€ï¼Œå¦‚æœå‡ä¸€åæ­¤èŠ‚ç‚¹çš„è¾“å…¥è®¡æ•°ä¸ºé›¶ï¼Œåˆ™ç»§ç»­å…¥é˜Ÿç­‰å¾…è°ƒåº¦ã€‚ç›´è‡³å¯è°ƒåº¦èŠ‚ç‚¹ä¸ºé›¶ï¼Œæ’åºå®Œæˆã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼Œå¦‚ä¸‹å›¾ä¸­çš„ <code>Text</code> å‡½æ•°ï¼Œå¤„ç†æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>é¦–å…ˆï¼Œæˆ‘ä»¬çš„å‡½æ•°å…¥å£èŠ‚ç‚¹ (ä»¥ä¸‹ç§°ä¸ºèŠ‚ç‚¹ 1) å’Œ <code>HelloBlueprint.get()</code> èŠ‚ç‚¹ (èŠ‚ç‚¹ 2) æ˜¯ä¸€å¼€å§‹å°±æ²¡æœ‰è¾“å…¥è®¡æ•°çš„ï¼Œæ‰€ä»¥ç›´æ¥å…¥é˜Ÿã€‚(é˜Ÿåˆ—å…ƒç´ ï¼š1ï¼Œ2)</li><li>æ¥ç€ï¼Œå–å‡ºé˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ 1ï¼ŒèŠ‚ç‚¹ 1 çš„è¾“å‡ºå¼•è„šä¸èŠ‚ç‚¹ 3 ç›¸è¿ï¼Œå‡å°‘èŠ‚ç‚¹ 3 çš„è¾“å…¥è®¡æ•°ï¼Œå‡å°‘åå…¶è®¡æ•°ä¸º 0ï¼ŒèŠ‚ç‚¹ 3 å…¥é˜Ÿã€‚(é˜Ÿåˆ—å…ƒç´ ï¼š2ï¼Œ3)</li><li>å–å‡ºèŠ‚ç‚¹ 2ï¼ŒèŠ‚ç‚¹ 4 ä¸èŠ‚ç‚¹ 2 ç›¸è¿ï¼ŒèŠ‚ç‚¹ 4 è¾“å…¥è®¡æ•°å‡ä¸€åå…¶è®¡æ•°ä¸º 1ï¼Œä¸å…¥é˜Ÿ (é˜Ÿåˆ—å…ƒç´ ï¼š3)</li><li>å–å‡ºèŠ‚ç‚¹ 3ï¼ŒèŠ‚ç‚¹ 4 ä¸èŠ‚ç‚¹ 3 ç›¸è¿ï¼ŒèŠ‚ç‚¹ 4 è¾“å…¥è®¡æ•°å‡ä¸€åå…¶è®¡æ•°ä¸º 0ï¼Œå…¥é˜Ÿ (é˜Ÿåˆ—å…ƒç´ ï¼š4)</li><li>...........</li></ul><p><img data-src="%E5%88%9D%E6%AC%A1%E5%BC%95%E8%84%9A%E6%8E%92%E5%BA%8F.png" alt="åˆæ¬¡å¼•è„šæ’åº"></p><h4 id="å‡½æ•°ç¼–è¯‘åå¤„ç†"><a class="anchor" href="#å‡½æ•°ç¼–è¯‘åå¤„ç†">#</a> å‡½æ•°ç¼–è¯‘åå¤„ç†</h4><p><code>PostcompileFunction</code> çš„æ ¸å¿ƒä»»åŠ¡æ˜¯ è¿›è¡Œçº¿æ€§æ‰§è¡Œåˆ—è¡¨çš„æœ€ç»ˆæ’åºï¼Œå¤„ç†æ‰€æœ‰æŒ‚èµ·çš„è·³è½¬ä¿®å¤ï¼Œä¼˜åŒ–æ— ç”¨è·³è½¬ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>PostcompileFunction</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// KismetCompiler.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetCompilerContext::PostcompileFunction</span><span class="params">(FKismetFunctionContext&amp; Context)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è¿›è¡Œçº¿æ€§æ‰§è¡Œåˆ—è¡¨çš„æœ€ç»ˆæ’åºï¼Œå¤„ç†æ‰€æœ‰æŒ‚èµ·çš„è·³è½¬ä¿®å¤ï¼Œä¼˜åŒ–æ— ç”¨è·³è½¬</span></span><br><span class="line">	Context.<span class="built_in">ResolveStatements</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‡½æ•°çš„å±æ€§é“¾æ¥ï¼Œè®¾ç½®ç¼–è¯‘ç»“æŸæ ‡è®°ï¼ŒåŠå‡½æ•°çš„ç›¸å…³å…ƒæ•°æ®</span></span><br><span class="line">	<span class="built_in">FinishCompilingFunction</span>(Context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetFunctionContext::ResolveStatements</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è¿›è¡Œçº¿æ€§æ‰§è¡Œåˆ—è¡¨çš„æœ€ç»ˆæ’åº (ä¸‹æ–‡å±•å¼€)</span></span><br><span class="line">	<span class="built_in">FinalSortLinearExecList</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¤„ç†æ‰€æœ‰æŒ‚èµ·çš„è·³è½¬</span></span><br><span class="line">	<span class="built_in">ResolveGotoFixups</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">const</span> FBoolConfigValueHelper <span class="title">OptimizeAdjacentStates</span><span class="params">(TEXT(<span class="string">&quot;Kismet&quot;</span>), TEXT(<span class="string">&quot;bOptimizeAdjacentStates&quot;</span>), GEngineIni)</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (OptimizeAdjacentStates)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">// ä¼˜åŒ– LinearExecationList ä¸­çš„æ— ç”¨è·³è½¬</span></span><br><span class="line">		<span class="built_in">MergeAdjacentStates</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>å‡½æ•°ä¸Šä¸‹æ–‡ä¸­èŠ‚ç‚¹çš„æœ€åæ’åºåœ¨ <code>FinalSortLinearExecList()</code> ä¸­è¿›è¡Œï¼Œå…¶æ’åºæ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>é¦–å…ˆæ‰¾åˆ°å…¥å£èŠ‚ç‚¹ (ä¸‹å›¾ä¸­çš„èŠ‚ç‚¹ 1)ï¼Œå°†å…¶æ’åºåˆ° <code>LinearExectionList</code> ä¸­ï¼Œ</li><li>ç„¶åæŸ¥çœ‹å…¥å£èŠ‚ç‚¹çš„è¾“å‡ºæ‰§è¡ŒèŠ‚ç‚¹è¿æ¥çš„èŠ‚ç‚¹ (èŠ‚ç‚¹ 2)ï¼Œå°†å…¶å…¥é˜Ÿ <code>NodesToStartNextChain</code> ï¼Œ</li><li>å°†é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ 2 å–å‡ºå¹¶æ’åº (åˆ° <code>LinearExectionList</code> ä¸­)ï¼Œå°†èŠ‚ç‚¹ 2 è¾“å‡ºæ‰§è¡ŒèŠ‚ç‚¹è¿æ¥çš„èŠ‚ç‚¹ (3ï¼Œ4ï¼Œ5ï¼Œ6) å…¥é˜Ÿã€‚</li><li>å°†é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ 3 å–å‡ºå¹¶æ’åºï¼ŒèŠ‚ç‚¹ 3 è¾“å‡ºæ‰§è¡ŒèŠ‚ç‚¹å¹¶æ²¡æœ‰è¿æ¥ä»»ä½•èŠ‚ç‚¹ï¼Œä¸éœ€è¦å…¥é˜Ÿã€‚</li><li>å°†é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ 4 å–å‡ºå¹¶æ’åºï¼Œå°†èŠ‚ç‚¹ 4 è¾“å‡ºæ‰§è¡ŒèŠ‚ç‚¹è¿æ¥çš„èŠ‚ç‚¹ (7ï¼Œ8) å…¥é˜Ÿã€‚</li><li>å°†é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ 5ï¼Œ6ï¼Œ7ï¼Œ8 ä¾æ¬¡å–å‡ºå¹¶æ’åºã€‚</li></ul><p><img data-src="%E6%9C%80%E5%90%8E%E5%BC%95%E8%84%9A%E6%8E%92%E5%BA%8F.png" alt="æœ€åå¼•è„šæ’åº"></p><p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>FinalSortLinearExecList</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// KismetCompilerMisc.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetFunctionContext::FinalSortLinearExecList</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">TSet&lt;UEdGraphNode*&gt; <span class="title">UnsortedExecutionSet</span><span class="params">(LinearExecutionList)</span></span>;</span><br><span class="line">	LinearExecutionList.<span class="built_in">Empty</span>();</span><br><span class="line">	TArray&lt;UEdGraphNode*&gt; SortedLinearExecutionList;</span><br><span class="line">    </span><br><span class="line">    SortedLinearExecutionList.<span class="built_in">Push</span>(EntryPoint);</span><br><span class="line">	UnsortedExecutionSet.<span class="built_in">Remove</span>(EntryPoint);</span><br><span class="line"></span><br><span class="line">	TSet&lt;UEdGraphNode*&gt; NodesToStartNextChain;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (UnsortedExecutionSet.<span class="built_in">Num</span>())</span><br><span class="line">	&#123;</span><br><span class="line">        </span><br><span class="line">        UEdGraphNode* NextNode = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// get last state target</span></span><br><span class="line">		<span class="keyword">const</span> UEdGraphNode* CurrentNode = SortedLinearExecutionList.<span class="built_in">Last</span>();</span><br><span class="line">		<span class="keyword">const</span> TArray&lt;FBlueprintCompiledStatement*&gt;* CurStatementList = StatementsPerNode.<span class="built_in">Find</span>(CurrentNode);</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">bool</span> CurrentNodeIsValid = CurrentNode &amp;&amp; CurStatementList &amp;&amp; CurStatementList-&gt;<span class="built_in">Num</span>();</span><br><span class="line">		<span class="keyword">const</span> FBlueprintCompiledStatement* LastStatementInCurrentNode = CurrentNodeIsValid ? CurStatementList-&gt;<span class="built_in">Last</span>() : <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Find next element in current chain</span></span><br><span class="line">		<span class="keyword">if</span> (LastStatementInCurrentNode &amp;&amp; (LastStatementInCurrentNode-&gt;Type == KCST_UnconditionalGoto))</span><br><span class="line">		&#123;</span><br><span class="line">			UEdGraphNode* TargetNode = FGotoMapUtils::<span class="built_in">TargetNodeFromMap</span>(LastStatementInCurrentNode, GotoFixupRequestMap);</span><br><span class="line">			NextNode = UnsortedExecutionSet.<span class="built_in">Remove</span>(TargetNode) ? TargetNode : <span class="literal">nullptr</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (CurrentNode)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (UEdGraphPin* Pin : CurrentNode-&gt;Pins)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (Pin &amp;&amp; (EEdGraphPinDirection::EGPD_Output == Pin-&gt;Direction) &amp;&amp; K2Schema-&gt;<span class="built_in">IsExecPin</span>(*Pin) &amp;&amp; Pin-&gt;LinkedTo.<span class="built_in">Num</span>())</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">for</span> (UEdGraphPin* Link : Pin-&gt;LinkedTo)</span><br><span class="line">					&#123;</span><br><span class="line">						UEdGraphNode* LinkedNode = Link-&gt;<span class="built_in">GetOwningNodeUnchecked</span>();</span><br><span class="line">						<span class="keyword">if</span> (LinkedNode &amp;&amp; (LinkedNode != NextNode) &amp;&amp; UnsortedExecutionSet.<span class="built_in">Contains</span>(LinkedNode))</span><br><span class="line">						&#123;</span><br><span class="line">							NodesToStartNextChain.<span class="built_in">Add</span>(LinkedNode);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Start next chain if the current is done</span></span><br><span class="line">		<span class="keyword">while</span> (NodesToStartNextChain.<span class="built_in">Num</span>() &amp;&amp; !NextNode)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">auto</span> Iter = NodesToStartNextChain.<span class="built_in">CreateIterator</span>();</span><br><span class="line">			NextNode = UnsortedExecutionSet.<span class="built_in">Remove</span>(*Iter) ? *Iter : <span class="literal">NULL</span>;</span><br><span class="line">			Iter.<span class="built_in">RemoveCurrent</span>();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!NextNode)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">auto</span> Iter = UnsortedExecutionSet.<span class="built_in">CreateIterator</span>();</span><br><span class="line">			NextNode = *Iter;</span><br><span class="line">			Iter.<span class="built_in">RemoveCurrent</span>();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		SortedLinearExecutionList.<span class="built_in">Push</span>(NextNode);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	LinearExecutionList = SortedLinearExecutionList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="å¡«å……å‡½æ•°ä½“å’Œæ¡†æ¶è“å›¾ç±»çš„æ ¹å­˜å‡½æ•°ä½“"><a class="anchor" href="#å¡«å……å‡½æ•°ä½“å’Œæ¡†æ¶è“å›¾ç±»çš„æ ¹å­˜å‡½æ•°ä½“">#</a> å¡«å……å‡½æ•°ä½“å’Œæ¡†æ¶è“å›¾ç±»çš„æ ¹å­˜å‡½æ•°ä½“</h4><p>æ­¤æ­¥éª¤åœ¨ <code>CompileFunctions</code> ä¸­æ‰§è¡Œï¼Œä¸»è¦å®Œæˆ VM åç«¯çš„å­—èŠ‚ç ç”Ÿæˆå’Œ cpp åç«¯çš„ä»£ç ç”Ÿæˆã€‚ä»¥ä¸‹æ˜¯æ ¸å¿ƒä»£ç ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>VMBackend::GenerateCodeFromClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// KismetCompilerVMBackend.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetCompilerVMBackend::GenerateCodeFromClass</span><span class="params">(UClass* SourceClass, TIndirectArray&lt;FKismetFunctionContext&gt;&amp; Functions, <span class="keyword">bool</span> bGenerateStubsOnly)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// ç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">	<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; Functions.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		FKismetFunctionContext&amp; Function = Functions[i];</span><br><span class="line">		<span class="keyword">if</span> (Function.<span class="built_in">IsValid</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">const</span> <span class="keyword">bool</span> bIsUbergraph = (i == <span class="number">0</span>);</span><br><span class="line">			<span class="built_in">ConstructFunction</span>(Function, bIsUbergraph, bGenerateStubsOnly);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä» CalledFunctions ä¸­ç§»é™¤é‡å¤çš„å‡½æ•°</span></span><br><span class="line">	UBlueprintGeneratedClass* ClassBeingBuilt = CastChecked&lt;UBlueprintGeneratedClass&gt;(SourceClass);</span><br><span class="line">	<span class="function">TSet&lt;UFunction*&gt; <span class="title">Unique</span><span class="params">(ClassBeingBuilt-&gt;CalledFunctions)</span></span>;</span><br><span class="line">	ClassBeingBuilt-&gt;CalledFunctions = Unique.<span class="built_in">Array</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FKismetCompilerVMBackend::ConstructFunction</span><span class="params">(FKismetFunctionContext&amp; FunctionContext, <span class="keyword">bool</span> bIsUbergraph, <span class="keyword">bool</span> bGenerateStubOnly)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	UFunction* Function = FunctionContext.Function;</span><br><span class="line">	UBlueprintGeneratedClass* Class = FunctionContext.NewClass;</span><br><span class="line"></span><br><span class="line">	FString FunctionName;</span><br><span class="line">	Function-&gt;<span class="built_in">GetName</span>(FunctionName);</span><br><span class="line"></span><br><span class="line">	TArray&lt;uint8&gt;&amp; ScriptArray = Function-&gt;Script;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è¿”å›è¯­å¥ </span></span><br><span class="line">	FBlueprintCompiledStatement ReturnStatement;</span><br><span class="line">	ReturnStatement.Type = KCST_Return;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºè„šæœ¬ä¹¦å†™å™¨ï¼Œç”¨äºä¹¦å†™å­—èŠ‚ç </span></span><br><span class="line">	<span class="function">FScriptBuilderBase <span class="title">ScriptWriter</span><span class="params">(ScriptArray, Class, Schema, UbergraphStatementLabelMap, bIsUbergraph, ReturnStatement)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!bGenerateStubOnly)</span><br><span class="line">	&#123;</span><br><span class="line">		ReturnStatement.bIsJumpTarget = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (FunctionContext.bUseFlowStack)</span><br><span class="line">		&#123;</span><br><span class="line">			ScriptWriter.<span class="built_in">PushReturnAddress</span>(ReturnStatement);</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">        <span class="comment">// æŒ‰ LinearExecutionList çš„é¡ºåºäº§å‡ºä»£ç (ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ€»æ˜¯å‡½æ•°çš„å…¥å£)</span></span><br><span class="line">		<span class="keyword">for</span> (int32 NodeIndex = <span class="number">0</span>; NodeIndex &lt; FunctionContext.LinearExecutionList.<span class="built_in">Num</span>(); ++NodeIndex)</span><br><span class="line">		&#123;</span><br><span class="line">			UEdGraphNode* StatementNode = FunctionContext.LinearExecutionList[NodeIndex];</span><br><span class="line">			TArray&lt;FBlueprintCompiledStatement*&gt;* StatementList = FunctionContext.StatementsPerNode.<span class="built_in">Find</span>(StatementNode);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (StatementList != <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span> (int32 StatementIndex = <span class="number">0</span>; StatementIndex &lt; StatementList-&gt;<span class="built_in">Num</span>(); ++StatementIndex)</span><br><span class="line">				&#123;</span><br><span class="line">					FBlueprintCompiledStatement* Statement = (*StatementList)[StatementIndex];</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// ä¸º Statement ç”Ÿæˆä»£ç çš„æ ¸å¿ƒå‡½æ•°ï¼Œä¸‹æ–‡è§£æ</span></span><br><span class="line">					ScriptWriter.<span class="built_in">GenerateCodeForStatement</span>(CompilerContext, FunctionContext, *Statement, StatementNode);</span><br><span class="line">					</span><br><span class="line">					<span class="keyword">const</span> <span class="keyword">bool</span> bUberGraphFunctionCall = Statement-&gt;FunctionToCall &amp;&amp; (Statement-&gt;FunctionToCall == Class-&gt;UberGraphFunction)</span><br><span class="line">						&amp;&amp; (EKismetCompiledStatementType::KCST_CallFunction == Statement-&gt;Type);</span><br><span class="line">					<span class="keyword">const</span> <span class="keyword">bool</span> bIsReducible = FKismetCompilerUtilities::<span class="built_in">IsStatementReducible</span>(Statement-&gt;Type) || bUberGraphFunctionCall;</span><br><span class="line">					bAnyNonReducibleFunctionGenerated |= !bIsReducible;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å¤„ç†å‡½æ•°è¿”å›å€¼</span></span><br><span class="line">	ScriptWriter.<span class="built_in">GenerateCodeForStatement</span>(CompilerContext, FunctionContext, ReturnStatement, <span class="literal">NULL</span>);	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä¿®å¤è·³è½¬åœ°å€</span></span><br><span class="line">	ScriptWriter.<span class="built_in">PerformFixups</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å…³é—­è„šæœ¬ç¼–è¾‘</span></span><br><span class="line">	ScriptWriter.<span class="built_in">CloseScript</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿å­˜ubergraphä¸­çš„åç§»é‡ï¼Œä»¥ä¾¿ä»¥åä¿®è¡¥å­˜æ ¹</span></span><br><span class="line">	<span class="keyword">if</span> (bIsUbergraph)</span><br><span class="line">	&#123;</span><br><span class="line">		ScriptWriter.<span class="built_in">CopyStatementMapToUbergraphMap</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¡®ä¿æˆ‘ä»¬æ²¡æœ‰è¶…å‡ºæœ€å¤§å­—èŠ‚æ•°</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> SCRIPT_LIMIT_BYTECODE_TO_64KB</span></span><br><span class="line">	<span class="keyword">if</span> (ScriptArray.<span class="built_in">Num</span>() &gt; <span class="number">0xFFFF</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		MessageLog.<span class="built_in">Error</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;Script exceeded bytecode length limit of 64 KB&quot;</span>));</span><br><span class="line">		ScriptArray.<span class="built_in">Empty</span>();</span><br><span class="line">		ScriptArray.<span class="built_in">Add</span>(EX_EndOfScript);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">	<span class="built_in"><span class="keyword">static_assert</span></span>(<span class="built_in"><span class="keyword">sizeof</span></span>(CodeSkipSizeType) == <span class="number">4</span>, <span class="string">&quot;Update this code as size changed.&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">GenerateCodeForStatement</span><span class="params">(FKismetCompilerContext&amp; CompilerContext, FKismetFunctionContext&amp; FunctionContext, FBlueprintCompiledStatement&amp; Statement, UEdGraphNode* SourceNode)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ­¤ Statement è¢«ä½œä¸ºè·³è½¬ç›®æ ‡ï¼Œåˆ™è®°å½•æ­¤ Statement èµ·å§‹ä½ç½®çš„å­—èŠ‚ç </span></span><br><span class="line">    <span class="keyword">if</span> (Statement.bIsJumpTarget)</span><br><span class="line">    &#123;</span><br><span class="line">        StatementLabelMap.<span class="built_in">Add</span>(&amp;Statement, Writer.ScriptBuffer.<span class="built_in">Num</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ ¹æ® Statement çš„ç±»å‹ä½¿ç”¨ä¸åŒç­–ç•¥ç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">    <span class="built_in"><span class="keyword">switch</span></span> (Statement.Type)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> KCST_Nop:</span><br><span class="line">            Writer &lt;&lt; EX_Nothing;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> KCST_CallFunction:</span><br><span class="line">            <span class="built_in">EmitFunctionCall</span>(CompilerContext, FunctionContext, Statement, SourceNode);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> KCST_CallDelegate:</span><br><span class="line">            <span class="built_in">EmitCallDelegate</span>(Statement);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">EmitFunctionCall</span><span class="params">(FKismetCompilerContext&amp; CompilerContext, FKismetFunctionContext&amp; FunctionContext, FBlueprintCompiledStatement&amp; Statement, UEdGraphNode* SourceNode)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	UFunction* FunctionToCall = Statement.FunctionToCall;</span><br><span class="line">    </span><br><span class="line">    ClassBeingBuilt-&gt;CalledFunctions.<span class="built_in">Emplace</span>(FunctionToCall);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (FunctionToCall-&gt;<span class="built_in">HasAllFunctionFlags</span>(FUNC_Native))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ•°ç»„è¾“å‡ºå‚æ•°å·²è¢«æ¸…ç†ï¼Œä½†æœ¬åœ°å‡½æ•°åœ¨å¡«å……æ•°ç»„è¾“å‡ºå‚æ•°å‰æ˜¯ä¸éœ€è¦æ¸…ç†çš„</span></span><br><span class="line">        <span class="comment">// æ‰€ä»¥å…ˆè·å– Statement ä¸­çš„æ•°ç»„å¹¶å†™å…¥ Writer ä¸­ï¼Œç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">        int32 NumParams = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (TFieldIterator&lt;FProperty&gt; <span class="built_in">PropIt</span>(FunctionToCall); PropIt &amp;&amp; (PropIt-&gt;PropertyFlags &amp; CPF_Parm); ++PropIt)</span><br><span class="line">        &#123;</span><br><span class="line">            FProperty* Param = *PropIt;</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">bool</span> bShouldParameterBeCleared = Param-&gt;IsA&lt;FArrayProperty&gt;()</span><br><span class="line">                &amp;&amp; Param-&gt;<span class="built_in">HasAllPropertyFlags</span>(CPF_Parm | CPF_OutParm)</span><br><span class="line">                &amp;&amp; !Param-&gt;<span class="built_in">HasAnyPropertyFlags</span>(CPF_ReferenceParm | CPF_ConstParm | CPF_ReturnParm);</span><br><span class="line">            <span class="keyword">if</span> (bShouldParameterBeCleared)</span><br><span class="line">            &#123;</span><br><span class="line">                Writer &lt;&lt; EX_SetArray;</span><br><span class="line">                FBPTerminal* ArrayTerm = Statement.RHS[NumParams];</span><br><span class="line">                <span class="built_in">EmitTerm</span>(ArrayTerm, Param);</span><br><span class="line">                Writer &lt;&lt; EX_EndArray;</span><br><span class="line">            &#125;</span><br><span class="line">            NumParams += Param-&gt;<span class="built_in">HasAnyPropertyFlags</span>(CPF_ReturnParm) ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å– TargetLabel åœ¨ UberGraph ä¸­çš„åç§»ï¼Œå¹¶è®°å½•åˆ° RHS ä¸­</span></span><br><span class="line">    <span class="keyword">if</span> ((Statement.TargetLabel != <span class="literal">NULL</span>) &amp;&amp; !bIsUbergraph)</span><br><span class="line">    &#123;</span><br><span class="line">        CodeSkipSizeType OffsetWithinUbergraph = UbergraphStatementLabelMap.<span class="built_in">FindChecked</span>(Statement.TargetLabel);</span><br><span class="line"></span><br><span class="line">        Statement.RHS[Statement.UbergraphCallIndex]-&gt;Name = FString::<span class="built_in">FromInt</span>(OffsetWithinUbergraph);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¤„ç†è¿”å›å€¼èµ‹å€¼(å¦‚æœå­˜åœ¨) æ³¨æ„: Outè¾“å‡ºæ˜¯ä¸ç”Ÿæˆå­—èŠ‚ç çš„</span></span><br><span class="line">    <span class="keyword">bool</span> bHasOutputValue = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (TFieldIterator&lt;FProperty&gt; <span class="built_in">PropIt</span>(FunctionToCall); PropIt &amp;&amp; (PropIt-&gt;PropertyFlags &amp; CPF_Parm); ++PropIt)</span><br><span class="line">    &#123;</span><br><span class="line">        FProperty* FuncParamProperty = *PropIt;</span><br><span class="line">        <span class="keyword">if</span> (FuncParamProperty-&gt;<span class="built_in">HasAnyPropertyFlags</span>(CPF_ReturnParm))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (Statement.LHS)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// è¾“å‡ºè¿”å›å€¼çš„ç›®æ ‡è¡¨è¾¾å¼(åºåˆ—åŒ–å­—èŠ‚ç )</span></span><br><span class="line">                <span class="built_in">EmitDestinationExpression</span>(Statement.LHS);</span><br><span class="line">            &#125;</span><br><span class="line">            bHasOutputValue = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (FuncParamProperty-&gt;<span class="built_in">HasAnyPropertyFlags</span>(CPF_OutParm) &amp;&amp; !FuncParamProperty-&gt;<span class="built_in">HasAnyPropertyFlags</span>(CPF_ConstParm))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æœ‰ Out è¾“å‡º (å‡½æ•°ä¼ å…¥å¼•ç”¨å‚æ•°ä½œä¸ºè¾“å‡º)</span></span><br><span class="line">            bHasOutputValue = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ºå‡½æ•°ä¸Šä¸‹æ–‡è¾“å‡ºå­—èŠ‚ç ï¼ŒMathå‡½æ•°ä¸éœ€è¦ä¸Šä¸‹æ–‡</span></span><br><span class="line">    <span class="function">FContextEmitter <span class="title">CallContextWriter</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...... ä¸ºå‡½æ•°è°ƒç”¨ç±»å‹ç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...... ä¸ºå‡½æ•°å‚æ•°ç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...... ä¸ºå¯å˜å‡½æ•°çš„é¢å¤–æ•°æ®ç”Ÿæˆå­—èŠ‚ç </span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç”Ÿæˆ EX_EndFuntionParams å­—èŠ‚ç ï¼Œæ ‡å¿—ç€å‚æ•°åˆ—è¡¨å­—èŠ‚ç ç”Ÿæˆç»“æŸ</span></span><br><span class="line">    Writer &lt;&lt; EX_EndFunctionParms;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>åˆ°æ­¤ï¼Œè“å›¾ç¼–è¯‘è¯­å¥ Statement çš„å­—èŠ‚ç å·²ç»ç”Ÿæˆå®Œæˆã€‚å­—èŠ‚ç çš„å…·ä½“å†…å®¹å…¶å®æ˜¯ <code>FScriptBytecodeWriter</code> æ ¹æ®å„ç§ä¸åŒæ•°æ®ç±»å‹åºåˆ—åŒ–å‡ºæ¥çš„æ•°æ®ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯ cpp åç«¯ç”Ÿæˆä»£ç çš„è¿‡ç¨‹ï¼Œæ ¸å¿ƒå‡½æ•°å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>cppBackend::GenerateCodeFromClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BlueprintCompilerCppBackendBase.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function">FString <span class="title">FBlueprintCompilerCppBackendBase::GenerateCodeFromClass</span><span class="params">(UClass* SourceClass, TIndirectArray&lt;FKismetFunctionContext&gt;&amp; Functions, <span class="keyword">bool</span> bGenerateStubsOnly, <span class="keyword">const</span> FCompilerNativizationOptions&amp; NativizationOptions, FString&amp; OutCppBody)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">CleanBackend</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†æ¯ä¸ªå‡½æ•°ä¸Šä¸‹æ–‡çš„æ¯ä¸ªç‹¬ç«‹èŠ‚ç‚¹çš„ Statements æ·»åŠ åˆ° UberGraphStatementToExecutionGroup ä¸­</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; FunctionContext : Functions)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (FunctionContext.bIsUbergraph)</span><br><span class="line">		&#123;</span><br><span class="line">			UberGraphContext = &amp;FunctionContext;</span><br><span class="line">			<span class="keyword">for</span> (int32 ExecutionGroupIndex = <span class="number">0</span>; ExecutionGroupIndex &lt; FunctionContext.UnsortedSeparateExecutionGroups.<span class="built_in">Num</span>(); ++ExecutionGroupIndex)</span><br><span class="line">			&#123;</span><br><span class="line">				TSet&lt;UEdGraphNode*&gt;&amp; ExecutionGroup = FunctionContext.UnsortedSeparateExecutionGroups[ExecutionGroupIndex];</span><br><span class="line">				<span class="keyword">for</span> (UEdGraphNode* LocNode : ExecutionGroup)</span><br><span class="line">				&#123;</span><br><span class="line">					TArray&lt;FBlueprintCompiledStatement*&gt;* LocStatementsPtr = FunctionContext.StatementsPerNode.<span class="built_in">Find</span>(LocNode);</span><br><span class="line">					<span class="keyword">if</span> (<span class="built_in">ensure</span>(LocStatementsPtr))</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="keyword">for</span> (FBlueprintCompiledStatement* LocStatement : *LocStatementsPtr)</span><br><span class="line">						&#123;</span><br><span class="line">							UberGraphStatementToExecutionGroup.<span class="built_in">Add</span>(LocStatement, ExecutionGroupIndex);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> CleanCppClassName = FEmitHelper::<span class="built_in">GetBaseFilename</span>(SourceClass, NativizationOptions);</span><br><span class="line">	<span class="keyword">auto</span> CppClassName = FEmitHelper::<span class="built_in">GetCppName</span>(SourceClass);</span><br><span class="line">	</span><br><span class="line">	TSharedPtr&lt;FGatherConvertedClassDependencies&gt; Dependencies = FGatherConvertedClassDependencies::<span class="built_in">Get</span>(SourceClass, NativizationOptions);</span><br><span class="line">	FNativizationSummaryHelper::<span class="built_in">RegisterRequiredModules</span>(NativizationOptions.PlatformName, Dependencies-&gt;RequiredModuleNames);</span><br><span class="line">	<span class="function">FEmitterLocalContext <span class="title">EmitterContext</span><span class="params">(Dependencies.ToSharedRef().Get(), NativizationOptions)</span></span>;</span><br><span class="line"></span><br><span class="line">	UClass* OriginalSourceClass = Dependencies-&gt;<span class="built_in">FindOriginalClass</span>(SourceClass);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨å†Œä¾èµ–ç±»</span></span><br><span class="line">	FNativizationSummaryHelper::<span class="built_in">RegisterClass</span>(OriginalSourceClass);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å§‹å†™cppä»£ç ï¼å†™å¼€å¤´çš„ #pragma once å’Œ #include</span></span><br><span class="line">	<span class="built_in">EmitFileBeginning</span>(CleanCppClassName, EmitterContext);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> TCHAR* PlaceholderForInlinedStructInlude = <span class="built_in">TEXT</span>(<span class="string">&quot;//PlaceholderForInlinedStructInlude&quot;</span>);</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">bool</span> bIsInterface = SourceClass-&gt;IsChildOf&lt;UInterface&gt;();</span><br><span class="line">	<span class="keyword">if</span> (!bIsInterface)</span><br><span class="line">	&#123;</span><br><span class="line">		EmitterContext.Body.<span class="built_in">AddLine</span>(PlaceholderForInlinedStructInlude);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">bool</span> bHasStaticSearchableValues = FBackendHelperStaticSearchableValues::<span class="built_in">HasSearchableValues</span>(SourceClass);</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// ç±»å®šä¹‰</span></span><br><span class="line">		<span class="keyword">if</span> (bIsInterface)</span><br><span class="line">		&#123;</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UINTERFACE(Blueprintable, %s)&quot;</span>), *FEmitHelper::<span class="built_in">ReplaceConvertedMetaData</span>(OriginalSourceClass)));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;class %s : public UInterface&quot;</span>), *FEmitHelper::<span class="built_in">GetCppName</span>(SourceClass, <span class="literal">true</span>)));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;&#123;&quot;</span>));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">IncreaseIndent</span>();</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;GENERATED_BODY()&quot;</span>));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;static void __CustomDynamicClassInitialization(UDynamicClass* InDynamicClass) &#123;&#125;&quot;</span>));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">DecreaseIndent</span>();</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;&#125;;&quot;</span>));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;class %s&quot;</span>), *CppClassName));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			TArray&lt;FString&gt; AdditionalMD;</span><br><span class="line">			<span class="keyword">const</span> FString ReplaceConvertedMD = FEmitHelper::<span class="built_in">GenerateReplaceConvertedMD</span>(OriginalSourceClass);</span><br><span class="line">			<span class="keyword">if</span> (!ReplaceConvertedMD.<span class="built_in">IsEmpty</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				AdditionalMD.<span class="built_in">Add</span>(ReplaceConvertedMD);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (bHasStaticSearchableValues)</span><br><span class="line">			&#123;</span><br><span class="line">				AdditionalMD.<span class="built_in">Add</span>(FBackendHelperStaticSearchableValues::<span class="built_in">GenerateClassMetaData</span>(SourceClass));</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">const</span> FString DefinedConfigName = (OriginalSourceClass-&gt;ClassConfigName == NAME_None) ? <span class="built_in">FString</span>() : FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;config=%s, &quot;</span>), *OriginalSourceClass-&gt;ClassConfigName.<span class="built_in">ToString</span>());</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UCLASS(%s%s%s)&quot;</span>)</span><br><span class="line">				, *DefinedConfigName</span><br><span class="line">				, (!SourceClass-&gt;IsChildOf&lt;UBlueprintFunctionLibrary&gt;()) ? <span class="built_in">TEXT</span>(<span class="string">&quot;Blueprintable, BlueprintType, &quot;</span>) : <span class="built_in">TEXT</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">				, *FEmitHelper::<span class="built_in">HandleMetaData</span>(<span class="built_in">FFieldVariant</span>(), <span class="literal">false</span>, &amp;AdditionalMD)));</span><br><span class="line"></span><br><span class="line">			UClass* SuperClass = SourceClass-&gt;<span class="built_in">GetSuperClass</span>();</span><br><span class="line">			FString ClassDefinition = FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;class %s : public %s&quot;</span>), *CppClassName, *FEmitHelper::<span class="built_in">GetCppName</span>(SuperClass));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; ImplementedInterface : SourceClass-&gt;Interfaces)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (ImplementedInterface.Class)</span><br><span class="line">				&#123;</span><br><span class="line">					ClassDefinition += FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;, public %s&quot;</span>), *FEmitHelper::<span class="built_in">GetCppName</span>(ImplementedInterface.Class));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(ClassDefinition);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// å¼€å§‹å†™ç±»å†…éƒ¨ä»£ç </span></span><br><span class="line">		EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;&#123;&quot;</span>));</span><br><span class="line">		EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;public:&quot;</span>));</span><br><span class="line">		EmitterContext.Header.<span class="built_in">IncreaseIndent</span>();</span><br><span class="line">		EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;GENERATED_BODY()&quot;</span>));</span><br><span class="line"></span><br><span class="line">		<span class="built_in">DeclareDelegates</span>(EmitterContext, Functions);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">EmitStructProperties</span>(EmitterContext, SourceClass);</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line">			IBlueprintCompilerCppBackendModule&amp; BackEndModule = (IBlueprintCompilerCppBackendModule&amp;)IBlueprintCompilerCppBackendModule::<span class="built_in">Get</span>();</span><br><span class="line">			TSharedPtr&lt;FNativizationSummary&gt; NativizationSummary = BackEndModule.<span class="built_in">NativizationSummary</span>();</span><br><span class="line">			<span class="keyword">if</span> (NativizationSummary.<span class="built_in">IsValid</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span> (TFieldIterator&lt;FProperty&gt; <span class="built_in">It</span>(SourceClass, EFieldIteratorFlags::ExcludeSuper); It; ++It)</span><br><span class="line">				&#123;</span><br><span class="line">					FProperty* Property = *It;</span><br><span class="line">					<span class="keyword">if</span> (Property &amp;&amp; Property-&gt;<span class="built_in">HasAllPropertyFlags</span>(CPF_Transient | CPF_DuplicateTransient))</span><br><span class="line">					&#123;</span><br><span class="line">						NativizationSummary-&gt;MemberVariablesFromGraph++;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		TSharedPtr&lt;FGatherConvertedClassDependencies&gt; ParentDependencies;</span><br><span class="line">		<span class="comment">// å†™å‡½æ•°å£°æ˜å’Œå®šä¹‰ (åŒæ—¶å†™å…¥å‡½æ•°å¤´å’Œå‡½æ•°ä½“)</span></span><br><span class="line">		<span class="keyword">if</span> (!bIsInterface)</span><br><span class="line">		&#123;</span><br><span class="line">			UBlueprintGeneratedClass* BPGC = CastChecked&lt;UBlueprintGeneratedClass&gt;(EmitterContext.<span class="built_in">GetCurrentlyGeneratedClass</span>());</span><br><span class="line">			UBlueprintGeneratedClass* ParentBPGC = Cast&lt;UBlueprintGeneratedClass&gt;(BPGC-&gt;<span class="built_in">GetSuperClass</span>());</span><br><span class="line">			ParentDependencies = FGatherConvertedClassDependencies::<span class="built_in">Get</span>(ParentBPGC, NativizationOptions);</span><br><span class="line"></span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;%s(const FObjectInitializer&amp; ObjectInitializer = FObjectInitializer::Get());&quot;</span>), *CppClassName));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;virtual void PostLoadSubobjects(FObjectInstancingGraph* OuterInstanceGraph) override;&quot;</span>));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;static void __CustomDynamicClassInitialization(UDynamicClass* InDynamicClass);&quot;</span>));</span><br><span class="line"></span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;static void __StaticDependenciesAssets(TArray&lt;FBlueprintDependencyData&gt;&amp; AssetsToLoad);&quot;</span>));</span><br><span class="line">			EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;static void __StaticDependencies_DirectlyUsedAssets(TArray&lt;FBlueprintDependencyData&gt;&amp; AssetsToLoad);&quot;</span>));</span><br><span class="line">			<span class="keyword">if</span> (bHasStaticSearchableValues)</span><br><span class="line">			&#123;</span><br><span class="line">				FBackendHelperStaticSearchableValues::<span class="built_in">EmitFunctionDeclaration</span>(EmitterContext);</span><br><span class="line">				FBackendHelperStaticSearchableValues::<span class="built_in">EmitFunctionDefinition</span>(EmitterContext);</span><br><span class="line">			&#125;</span><br><span class="line">			FEmitDefaultValueHelper::<span class="built_in">GenerateConstructor</span>(EmitterContext);</span><br><span class="line">			FEmitDefaultValueHelper::<span class="built_in">GenerateCustomDynamicClassInitialization</span>(EmitterContext, ParentDependencies);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºçŠ¶æ€æ˜ å°„</span></span><br><span class="line">		<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; Functions.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			StateMapPerFunction.<span class="built_in">Add</span>(<span class="built_in">FFunctionLabelInfo</span>());</span><br><span class="line">			FunctionIndexMap.<span class="built_in">Add</span>(&amp;Functions[i], i);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; Functions.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (Functions[i].<span class="built_in">IsValid</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">ConstructFunction</span>(Functions[i], EmitterContext, bGenerateStubsOnly);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		EmitterContext.Header.<span class="built_in">DecreaseIndent</span>();</span><br><span class="line">		EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;public:&quot;</span>));</span><br><span class="line">		EmitterContext.Header.<span class="built_in">IncreaseIndent</span>();</span><br><span class="line"></span><br><span class="line">		FBackendHelperUMG::<span class="built_in">WidgetFunctionsInHeader</span>(EmitterContext);</span><br><span class="line"></span><br><span class="line">		EmitterContext.Header.<span class="built_in">DecreaseIndent</span>();</span><br><span class="line">		EmitterContext.Header.<span class="built_in">AddLine</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;&#125;;&quot;</span>));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!bIsInterface)</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// å¿…é¡»åœ¨ GenerateConstructor å’Œ GenerateCustomDynamicClassInitialization å’Œå…¶ä»–å‡½æ•°è°ƒç”¨åæ‰§è¡Œ</span></span><br><span class="line">            <span class="comment">// ç°åœ¨æˆ‘ä»¬çŸ¥é“æºä»£ç ä¸­å“ªäº›èµ„æºæ˜¯ç›´æ¥ä½¿ç”¨çš„</span></span><br><span class="line">			FEmitDefaultValueHelper::<span class="built_in">AddStaticFunctionsForDependencies</span>(EmitterContext, ParentDependencies, NativizationOptions);</span><br><span class="line">			FEmitDefaultValueHelper::<span class="built_in">AddRegisterHelper</span>(EmitterContext);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		FEmitHelper::<span class="built_in">EmitLifetimeReplicatedPropsImpl</span>(EmitterContext);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!bIsInterface)</span><br><span class="line">	&#123;</span><br><span class="line">		FCodeText AdditionalIncludes;</span><br><span class="line">		TSet&lt;FString&gt; DummyStrSet;</span><br><span class="line">		FIncludeHeaderHelper::<span class="built_in">EmitInner</span>(AdditionalIncludes, EmitterContext.StructsUsedAsInlineValues, TSet&lt;UField*&gt;&#123;&#125;, EmitterContext.NativizationOptions, DummyStrSet);</span><br><span class="line">		EmitterContext.Body.Result.<span class="built_in">ReplaceInline</span>(PlaceholderForInlinedStructInlude, *AdditionalIncludes.Result);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">CleanBackend</span>();</span><br><span class="line"></span><br><span class="line">	OutCppBody = EmitterContext.Body.Result;</span><br><span class="line">	<span class="keyword">return</span> EmitterContext.Header.Result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>å°±æ˜¯ç”Ÿæˆæ­¤è“å›¾çš„ CPP ä»£ç ï¼Œä¸å±•å¼€åˆ†æã€‚</p><h2 id="è“å›¾ç¼–è¾‘å™¨çš„å®ç°"><a class="anchor" href="#è“å›¾ç¼–è¾‘å™¨çš„å®ç°">#</a> è“å›¾ç¼–è¾‘å™¨çš„å®ç°</h2><p>æ¦‚è¦ï¼šè“å›¾ç¼–è¾‘å™¨ç›¸ä¿¡å¤§å®¶éƒ½ä¸é™Œç”Ÿäº†ã€‚ä¸çŸ¥é“ä½ æ˜¯å¦ä¹Ÿä¸å†™è€…ä¸€èˆ¬ï¼Œåˆšæ¥è§¦è“å›¾å¯è§†åŒ–ç¼–ç¨‹æ—¶ä¸‡åˆ†æ„Ÿæ…¨å…¶å¼€å‘ä¾¿åˆ©æ€§ï¼Œæ˜¯å¦ä¹Ÿæ›¾å……æ–¥ç€ç ”ç©¶ç¼–è¾‘å™¨å®ç°æœºåˆ¶çš„æ— é™çƒ­æƒ…å´åŠ›ä¸ä»å¿ƒã€‚é—²è¯ä¸å¤šè¯´ï¼Œè®©å’±å…ˆçœ‹çœ‹è“å›¾ç¼–è¾‘å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„å§ ğŸ˜ƒ</p><p>å‰é¢ç¼–è¯‘è“å›¾æ—¶ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†äº‹ä»¶è¡¨ï¼ŒèŠ‚ç‚¹ï¼Œå¼•è„šç­‰å¯¹è±¡ã€‚è¿™äº›å¯¹è±¡å…¶å®æ˜¯å¼€å‘è€…åœ¨è“å›¾ç¼–è¾‘å™¨ä¸­å¼€å‘æ—¶æ·»åŠ åˆ°è“å›¾ä¸­çš„ï¼Œç„¶åå†é€šè¿‡ç¼–è¯‘è“å›¾çš„æ–¹å¼äº§å‡ºæ–°çš„ <code>BPGC</code> , <code>CDO</code> , å­—èŠ‚ç ç­‰ï¼Œä¾›æ¸¸æˆè¿è¡Œæ—¶ä½¿ç”¨ã€‚</p><p>å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨è“å›¾å¼€å‘æ—¶ï¼Œé¦–å…ˆè¦æ‰“å¼€æŸä¸ªè“å›¾ï¼Œç„¶åå¯èƒ½è¿˜ä¼šæ·»åŠ ä¸€äº›èŠ‚ç‚¹ï¼Œä½†æœ‰äº›èŠ‚ç‚¹åˆä¸æ˜¯æ‰€æœ‰è“å›¾éƒ½èƒ½ä½¿ç”¨çš„ã€‚å°±æ˜¯è¿™ä¹ˆç®€å•çš„å‡ ä¸ªæ­¥éª¤ï¼Œå·²ç»åŒ…å«äº†æˆ‘ä»¬éœ€è¦ç ”ç©¶çš„æ‰€æœ‰å†…å®¹ã€‚</p><ol><li>æ‰“å¼€è“å›¾ï¼Œæˆ‘ä»¬éœ€è¦å°†è“å›¾ç¼–è¾‘å™¨å’Œå›¾ç¼–è¾‘å™¨çš„ Slate æ˜¾ç¤ºå‡ºæ¥ -&gt; <code>SGraphEditor</code></li><li>æ·»åŠ è“å›¾èŠ‚ç‚¹ï¼Œå³ <code>UK2Node</code> ç»§æ‰¿äº <code>UGraphNode</code></li><li>æŸäº›å›¾ä¸èƒ½æ·»åŠ ç‰¹å®šèŠ‚ç‚¹ï¼Œç”± <code>UEdGraphSchema_K2</code> æ§åˆ¶ï¼Œç»§æ‰¿äº <code>UEdGraphSchema</code></li></ol><p>æŒ‰ MVC ä¸‰å±‚æ¡†æ¶å³ Model -&gt; <code>UGraphNode</code> , View -&gt; <code>SGraphEditor</code> , Control -&gt; <code>UEdGraphSchema_K2</code> ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ†åˆ«åˆ†ææ¯ä¸ªç±»çš„å†…éƒ¨ç»“æ„ åŠå…¶åœ¨ç¼–è¾‘å™¨ä¸­çš„å·¥ä½œæœºåˆ¶ã€‚</p><h3 id="node-uedgraphnode"><a class="anchor" href="#node-uedgraphnode">#</a> Node | UEdGraphNode</h3><p><code>UEdGraphNode</code> è¯‘ä¸ºç¼–è¾‘å™¨å›¾èŠ‚ç‚¹ï¼Œå®šä¹‰äº†è“å›¾èŠ‚ç‚¹åœ¨ç¼–è¾‘å™¨ä¸­çš„ä½ç½®ï¼Œè¯¥èŠ‚ç‚¹æ‰€åŒ…å«çš„å¼•è„šï¼Œè¯¥èŠ‚ç‚¹åœ¨å½“å‰è“å›¾ä¸­æ˜¯å¦å¯ç”¨ï¼Œè¯¥èŠ‚ç‚¹çš„å¤åˆ¶ç²˜è´´æ–¹æ³•ç­‰ã€‚ä»¥ä¸‹æ˜¯ <code>UEdGraphNode</code> çš„ä¸€äº›å¸¸ç”¨å±æ€§ä¸æ–¹æ³•ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>UEdGraphNode</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ENGINE_API</span> <span class="title">UEdGraphNode</span> :</span> <span class="keyword">public</span> UObject</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_UCLASS_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** æ­¤èŠ‚ç‚¹çš„æ‰€æœ‰å¼•è„šï¼ŒåŒ…å«è¾“å…¥ä¸è¾“å‡ºå¼•è„š */</span></span><br><span class="line">    TArray&lt;UEdGraphPin*&gt; Pins;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** æ­¤èŠ‚ç‚¹åœ¨ç¼–è¾‘å™¨ä¸­ X æ–¹å‘çš„ä½ç½® */</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	int32 NodePosX;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** æ­¤èŠ‚ç‚¹åœ¨ç¼–è¾‘å™¨ä¸­ Y æ–¹å‘çš„ä½ç½® */</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	int32 NodePosY;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** æ­¤èŠ‚ç‚¹åœ¨ç¼–è¾‘å™¨ä¸­çš„å®½åº¦; åªåœ¨èŠ‚ç‚¹å…è®¸æ”¹å˜å¤§å°æ—¶ä½¿ç”¨ */</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	int32 NodeWidth;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** æ­¤èŠ‚ç‚¹åœ¨ç¼–è¾‘å™¨ä¸­çš„å®½é«˜åº¦; åªåœ¨èŠ‚ç‚¹å…è®¸æ”¹å˜å¤§å°æ—¶ä½¿ç”¨ */</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	int32 NodeHeight;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** æ­¤èŠ‚ç‚¹æ‰€åŒ…å«çš„é«˜çº§å¼•è„šçš„æ˜¾ç¤ºæ–¹å¼ã€‚æ˜¯å¦æ˜¾ç¤º */</span></span><br><span class="line">    <span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TEnumAsByte&lt;ENodeAdvancedPins::Type&gt; AdvancedPinDisplay;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** ä½¿ç”¨æä¾›çš„ä¿¡æ¯ä¸ºæ­¤èŠ‚ç‚¹åˆ›å»ºæ–°å¼•è„šï¼Œå¹¶è¿”å›æ­¤å¼•è„š */</span></span><br><span class="line">	<span class="function">UEdGraphPin* <span class="title">CreatePin</span><span class="params">(EEdGraphPinDirection Dir, <span class="keyword">const</span> FName PinCategory, <span class="keyword">const</span> FName PinName, <span class="keyword">const</span> FCreatePinParams&amp; PinParams = FCreatePinParams())</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">CreatePin</span>(Dir, PinCategory, NAME_None, <span class="literal">nullptr</span>, PinName, PinParams);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** é”€æ¯ç‰¹å®šå¼•è„šï¼Œä¸ä¿®æ”¹å…¶æ‰€å±çš„å¼•è„šçš„å¼•è„šåˆ—è¡¨ */</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DestroyPin</span><span class="params">(UEdGraphPin* Pin)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å¯»æ‰¾æ­¤èŠ‚ç‚¹ä¸­ç‰¹å®šåç§°å’Œç±»å‹(è¾“å…¥æˆ–è¾“å‡º)çš„å¼•è„š */</span></span><br><span class="line">	<span class="function">UEdGraphPin* <span class="title">FindPin</span><span class="params">(<span class="keyword">const</span> FName PinName, <span class="keyword">const</span> EEdGraphPinDirection Direction = EGPD_MAX)</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åŸºäºèŠ‚ç‚¹ç±»å‹ä¸ºç»™å®šèŠ‚ç‚¹åˆ†é…é»˜è®¤å¼•è„š.</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @return	å¼•è„šåˆ›å»ºæˆåŠŸè¿”å›å¸§ï¼Œå¦åˆ™è¿”å›å‡(å¦‚å‡½æ•°è°ƒç”¨å¼•è„šå¯»æ‰¾å‡½æ•°å¤±è´¥)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">AllocateDefaultPins</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** è·å–èŠ‚ç‚¹åç§°ï¼Œåœ¨æ ‡é¢˜æ ä¸­æ˜¾ç¤º */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> FText <span class="title">GetNodeTitle</span><span class="params">(ENodeTitleType::Type TitleType)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å½“æ­¤èŠ‚ç‚¹çš„ä»»ä½•ä¸€ä¸ªå¼•è„šçš„é»˜è®¤å€¼åœ¨ç¼–è¾‘å™¨ä¸­è¢«æ”¹å˜æ—¶è°ƒç”¨ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PinDefaultValueChanged</span><span class="params">(UEdGraphPin* Pin)</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** ç”¨äºå¯»æ‰¾æ­¤èŠ‚ç‚¹çš„å…³é”®è¯ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> FText <span class="title">GetKeywords</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">   	<span class="comment">/** å®šä¹‰æ­¤ç±»å‹èŠ‚ç‚¹å¯ä»¥åœ¨å“ªäº›ç‰¹å®šçš„å›¾ä¸­è¢«åˆ›å»º */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">IsCompatibleWithGraph</span><span class="params">(UEdGraph <span class="keyword">const</span>* Graph)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å½“ä»»æ„å¼•è„šçš„è¿æ¥åˆ—è¡¨åœ¨ç¼–è¾‘å™¨ä¸­å‘ç”Ÿæ”¹å˜æ—¶è°ƒç”¨ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PinConnectionListChanged</span><span class="params">(UEdGraphPin* Pin)</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** ç¼–è¾‘å›¾æ—¶ï¼Œè·å–ç»™å®šå¼•è„šçš„æ‚¬åœæç¤ºæ–‡æœ¬ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">GetPinHoverText</span><span class="params">(<span class="keyword">const</span> UEdGraphPin&amp; Pin, FString&amp; HoverTextOut)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç”¨äºæ”¹å˜åˆå§‹åŒ–çš„æ–°èŠ‚ç‚¹; åªåœ¨æ–°èŠ‚ç‚¹åˆ›å»ºæ—¶è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨ AutowireNewNode æˆ– AllocateDefaultPins è°ƒç”¨ä¹‹å‰è°ƒç”¨</span></span><br><span class="line">	<span class="comment">// æ­¤æ–¹æ³•åœ¨æ–°èŠ‚ç‚¹è¢«é‡æ„æ—¶ä¸ä¼šè°ƒç”¨</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">PostPlacedNewNode</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * æ·»åŠ èŠ‚ç‚¹æ•°æ®åˆ°æœç´¢å…ƒæ•°æ®ï¼Œé‡å†™ä»¥æ”¶é›†æ›´å¤šéœ€è¦ç”¨äºæœç´¢çš„æ•°æ®</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @param OutTaggedMetaData		è¿”å›æ­¤èŠ‚ç‚¹çš„æ ‡è®°å…ƒæ•°æ®æ•°ç»„</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">AddSearchMetaDataInfo</span><span class="params">(TArray&lt;struct FSearchTagDataPair&gt;&amp; OutTaggedMetaData)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** ä¸ºæ¯ä¸ªç›´æ¥è¿æ¥æ­¤èŠ‚ç‚¹çš„ç›¸é‚»èŠ‚ç‚¹æ‰§è¡Œä¸€æ¬¡ç»™å®šå‡½æ•° */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">ForEachNodeDirectlyConnected</span><span class="params">(TFunctionRef&lt;<span class="keyword">void</span>(UEdGraphNode*)&gt; Func)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>ç›¸ä¿¡ä»¥ä¸Šå±æ€§å’Œå‡½æ•°å¯¹äºç”¨è¿‡è“å›¾çš„ä½ æ¥è¯´å¹¶ä¸éš¾ç†è§£ã€‚è¿™äº›è™šæ–¹æ³•åœ¨æˆ‘ä»¬è‡ªå®šä¹‰è“å›¾èŠ‚ç‚¹æ—¶ç»å¸¸éœ€è¦ç”¨åˆ°ï¼Œå»ºè®®äº†è§£ä¸€ä¸‹ ğŸ˜ƒ</p><h3 id="node-uk2node"><a class="anchor" href="#node-uk2node">#</a> Node | UK2Node</h3><p><code>UK2Node</code> å³æ˜¯æ‰€æœ‰è“å›¾èŠ‚ç‚¹çš„æŠ½è±¡åŸºç±»ã€‚æ— è®ºæ˜¯å¼•æ“å†…ç½®çš„å‡½æ•° (å¦‚: <code>Sequence</code> ç­‰) äº¦æˆ–æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„ BlueprintCallable å‡½æ•°ï¼Œéƒ½ä¼šè¢«åˆ›å»ºæˆä¸€ä¸ª <code>UK2Node</code> èŠ‚ç‚¹ï¼Œä»¥ä¾¿è“å›¾ä½¿ç”¨ã€‚ä»¥ä¸‹æ˜¯ <code>UK2Node</code> çš„ä¸€äº›å¸¸ç”¨å‡½æ•°ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>UK2Node</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UCLASS</span>(abstract, MinimalAPI)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UK2Node</span> :</span> <span class="keyword">public</span> UEdGraphNode</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">GENERATED_UCLASS_BODY</span>()</span><br><span class="line">      </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">	 * è¿”å›æ­¤èŠ‚ç‚¹æ˜¯å¦ä¾èµ–å¤–éƒ¨ç»“æ„ã€‚</span></span><br><span class="line"><span class="comment">	 * å¦‚æœ OptionalOutput ä¸ä¸ºç©ºï¼Œåˆ™åº”å¡«å……å·²çŸ¥ä¾èµ–ç‰©å“(ç±»ï¼Œç»“æ„ï¼Œå‡½æ•°ç­‰)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">HasExternalDependencies</span><span class="params">(TArray&lt;class UStruct*&gt;* OptionalOutput = <span class="literal">nullptr</span>)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œæ­¤èŠ‚ç‚¹çš„æŸä¸ªå¼•è„šçš„è¿æ¥åˆ—è¡¨å‘ç”Ÿæ”¹å˜æ—¶è°ƒç”¨ï¼Œåœ¨å¼•è„šæ¸…é™¤è¿çº¿ä¹‹å*/</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">NotifyPinConnectionListChanged</span><span class="params">(UEdGraphPin* Pin)</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** åœ¨è“å›¾çš„ç»“æ„æ”¹å˜åæ¸…ç©ºæ‰€æœ‰éœ€è¦è¢«é‡æ–°ç”Ÿæˆçš„ç¼“å­˜æ•°æ® */</span></span><br><span class="line">	<span class="function">BLUEPRINTGRAPH_API <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ClearCachedBlueprintData</span><span class="params">(UBlueprint* Blueprint)</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** æ‰§è¡ŒèŠ‚ç‚¹ç‰¹å®šçš„å¼ƒç”¨ä¿®å¤ï¼Œè¿™å¯èƒ½åˆ é™¤æ­¤èŠ‚ç‚¹å¹¶ç”¨å¦ä¸€ä¸ªèŠ‚ç‚¹ä»£æ›¿å®ƒ */</span></span><br><span class="line">	<span class="function">BLUEPRINTGRAPH_API <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ConvertDeprecatedNode</span><span class="params">(UEdGraph* Graph, <span class="keyword">bool</span> bOnlySafeChanges)</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** åˆ›å»ºèŠ‚ç‚¹å¥æŸ„å‡½å­ï¼Œåœ¨ç¼–è¯‘ UK2Node æ—¶è°ƒç”¨ */</span></span><br><span class="line">    <span class="function">BLUEPRINTGRAPH_API <span class="keyword">virtual</span> class FNodeHandlingFunctor* <span class="title">CreateNodeHandler</span><span class="params">(class FKismetCompilerContext&amp; CompilerContext)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="literal">nullptr</span>; &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨äºå‡½æ•°å…¥å£æˆ–å‡ºå£èŠ‚ç‚¹çš„å¼•è„š</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @param	Function	å…¥å£æˆ–å‡ºå£èŠ‚ç‚¹æ‰€ç”¨äºçš„ï¼Œè¢«æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class="line"><span class="comment">	 * @param	bForFunctionEntry	çœŸåˆ™è¡¨ç¤ºå‡½æ•°å…¥å£èŠ‚ç‚¹ï¼Œå‡åˆ™è¡¨ç¤ºå‡ºå£èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @return	æˆåŠŸåˆ™è¿”å›çœŸ</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">CreatePinsForFunctionEntryExit</span><span class="params">(<span class="keyword">const</span> UFunction* Function, <span class="keyword">bool</span> bForFunctionEntry)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * æŸ¥è¯¢å¿½ç•¥æ­¤èŠ‚ç‚¹æ˜¯å¦å®‰å…¨(å¦‚.æ³¨é‡ŠèŠ‚ç‚¹æˆ–å…¶ä»–å¯ä»¥åœ¨ä¸è­¦å‘Šçš„æƒ…å†µä¸‹åˆ é™¤çš„éç»“æ„å‹æ³¨é‡Š)</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @return	å¯å®‰å…¨å¿½ç•¥æ­¤èŠ‚ç‚¹åˆ™è¿”å›çœŸ</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">IsNodeSafeToIgnore</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åœ¨é‡æ–°æ„é€ æ—¶é‡æ–°åˆ†é…å¼•è„šï¼Œé»˜è®¤æƒ…å†µä¸‹å¿½ç•¥æ—§çš„å¼•è„šå¹¶è°ƒç”¨ AllocateDefaultPins()ã€‚</span></span><br><span class="line"><span class="comment">	 * å¦‚æœä½ é‡å†™æ­¤å‡½æ•°ä»¥åˆ›å»ºæ›´å¤šçš„å¼•è„šï¼Œä½ å¯èƒ½éœ€è¦è°ƒç”¨ RestoreSplitPins ä»¥æ¢å¤æ‰€æœ‰è¢«åˆ†è£‚çš„å¼•è„š(å¦‚.å‘é‡å¼•è„šåˆ†ç¦»ä¸ºå¤šä¸ªå¸¸é‡)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">BLUEPRINTGRAPH_API <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ReallocatePinsDuringReconstruction</span><span class="params">(TArray&lt;UEdGraphPin*&gt;&amp; OldPins)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** æ­¤å‡½æ•°è¿”å›ä»»æ„æ•°é‡çš„å±æ€§ï¼Œç”¨äºæè¿°æ­¤èŠ‚ç‚¹çš„åˆ†æäº‹ä»¶ */</span></span><br><span class="line">	<span class="function">BLUEPRINTGRAPH_API <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">GetNodeAttributes</span><span class="params">( TArray&lt;TKeyValuePair&lt;FString, FString&gt;&gt;&amp; OutNodeAttributes )</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">	 * ç”¨äºä»£æ›¿ GetMenuEntries(). é‡å†™ä»¥æ·»åŠ ç‰¹å®šçš„å…³äºå­ç±»ç±»å‹çš„UBlueprintNodeSpawners</span></span><br><span class="line"><span class="comment">	 * æä¾›å°†æ–°èŠ‚ç‚¹å’Œæ¸¸æˆæ¨¡å—èŠ‚ç‚¹æ·»åŠ åˆ°ä¸Šä¸‹æ–‡èœå•ä¸­çš„æ‰©å±•æ–¹å¼</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @param  ActionListOut	ç”¨äºå¡«å……æ–°ç”Ÿæˆå™¨çš„åˆ—è¡¨</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">GetMenuActions</span><span class="params">(FBlueprintActionDatabaseRegistrar&amp; ActionRegistrar)</span> <span class="keyword">const</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * é‡å†™ä»¥æä¾›é»˜è®¤åˆ†ç±»ï¼Œè¿æ¥çš„ç‰¹å®šèŠ‚ç‚¹ç±»å‹åœ¨æ­¤åˆ†ç±»ä¸‹è¢«åˆ—å‡º</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @return æœ¬åœ°åˆ†ç±»å­—ç¬¦ä¸²(å¦‚æœæ­¤èŠ‚ç‚¹åœ¨èœå•çš„æ ¹ä¸­è¢«åˆ—å‡ºï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> FText <span class="title">GetMenuCategory</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> FText::<span class="built_in">GetEmpty</span>(); &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ........ </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><code>UK2Node</code> åªæ˜¯ <code>UEdGraphNode</code> ç‰¹å®šäºè“å›¾èŠ‚ç‚¹çš„å‡½æ•°æ‹“å±•ï¼ŒåŒ…æ‹¬å¯¹è“å›¾æ•°æ®çš„ç¼–è¾‘ï¼Œé‡æ„å¼•è„šç­‰ã€‚&lt;a id=&quot;SpawnActor&quot;&gt;&lt;/a&gt;</p><p>è¿™é‡Œå¯ä»¥å¡«ä¸€ä¸‹ä¹‹å‰æŒ–çš„å‘ï¼š<strong>ä¸ºä»€ä¹ˆ <code>SpawnActorFromClass</code> è“å›¾èŠ‚ç‚¹åœ¨ä¸€äº› <code>UObject</code> è“å›¾ä¸­ä¸èƒ½ä½¿ç”¨ï¼Ÿ</strong></p><p>å› ä¸º <code>SpawnActorFromClass</code> èŠ‚ç‚¹è¦æ±‚ä½¿ç”¨æ­¤èŠ‚ç‚¹çš„è“å›¾å¯¹è±¡çš„ <code>GetWorld()</code> å‡½æ•°çš„è¿”å›å€¼ä¸ä¸ºç©ºæŒ‡é’ˆï¼ŒåŸå§‹çš„ <code>UObject</code> é»˜è®¤æ˜¯ä¸æ”¾ç½®åœ¨å…³å¡ä¸­çš„ï¼Œæ‰€ä»¥ <code>GetWorld()</code> çš„è¿”å›å€¼ç†åº”ä¸ºç©ºã€‚æˆ‘ä»¬åªéœ€è¦å°†å…¶ <code>GetWorld()</code> å‡½æ•°è®¾ç½®å¥½å³å¯ã€‚åŠæ³•ä¸å”¯ä¸€ï¼Œå¯ä»¥è°ƒç”¨ <code>Owner</code> (å¦‚æœæ˜¯ Actor) çš„ <code>GetWorld()</code> ä¹Ÿå¯ä»¥ç›´æ¥ä» <code>GEngine</code> ä¸­è·å–ç­‰ç­‰ã€‚</p><p>é™åˆ¶å‡½æ•°å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>SpawnActorFromClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// K2Node_SpawnActorFromClass.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">UK2Node_SpawnActorFromClass::IsCompatibleWithGraph</span><span class="params">(<span class="keyword">const</span> UEdGraph* TargetGraph)</span> <span class="keyword">const</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	UBlueprint* Blueprint = FBlueprintEditorUtils::<span class="built_in">FindBlueprintForGraph</span>(TargetGraph);</span><br><span class="line">	<span class="keyword">return</span> Super::<span class="built_in">IsCompatibleWithGraph</span>(TargetGraph) &amp;&amp; (!Blueprint || (FBlueprintEditorUtils::<span class="built_in">FindUserConstructionScript</span>(Blueprint) != TargetGraph &amp;&amp; Blueprint-&gt;GeneratedClass-&gt;<span class="built_in">GetDefaultObject</span>()-&gt;<span class="built_in">ImplementsGetWorld</span>()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">UObject::ImplementsGetWorld</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> DO_CHECK</span></span><br><span class="line">	<span class="built_in">check</span>(<span class="built_in">IsInGameThread</span>());</span><br><span class="line">	bGetWorldOverridden = <span class="literal">true</span>;</span><br><span class="line">	<span class="built_in">GetWorld</span>();</span><br><span class="line">	<span class="keyword">return</span> bGetWorldOverridden;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span>	</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><code>IsCompatibleWithGraph</code> å‡½æ•°ç”¨äºåˆ¤æ–­æ­¤èŠ‚ç‚¹ä¸ä¼ å…¥å›¾æ˜¯å¦å…¼å®¹ï¼Œå¦‚æœå…¼å®¹åˆ™æ˜¾ç¤ºåœ¨è“å›¾çš„å¯é€‰å‡½æ•°åˆ—è¡¨ä¸­ã€‚</p><h3 id="schema-uedgraphschema"><a class="anchor" href="#schema-uedgraphschema">#</a> Schema | UEdGraphSchema</h3><p></p><figure class="highlight c++"><figcaption><span>UEdGraphSchema</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// EdGraphSchema.h</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(abstract)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ENGINE_API</span> <span class="title">UEdGraphSchema</span> :</span> <span class="keyword">public</span> UObject</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_UCLASS_BODY</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * è·å–åœ¨å›¾ä¸Šå•å‡»é¼ æ ‡å³é”®æˆ–åœ¨å›¾ä¸­ä»å¼•è„šå¤„æ‹–åŠ¨æ—¶å¯ä»¥æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œ</span></span><br><span class="line"><span class="comment">	 * @param [in,out]	ContextMenuBuilder	ä¸Šä¸‹æ–‡(å›¾ï¼Œæ‹–åŠ¨å¼•è„šç­‰)å’Œè¾“å‡ºèœå•æ„é€ å™¨</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	 <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">GetGraphContextActions</span><span class="params">(FGraphContextMenuBuilder&amp; ContextMenuBuilder)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å®šä¹‰ä¸¤ä¸ªå¼•è„šæ˜¯å¦å¯ä»¥åˆ›å»ºè¿æ¥ã€‚è¿æ¥åˆæ³•è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œå¦åˆ™è¿”å›ä¸å¯è¿æ¥çš„åŸå› ä¿¡æ¯ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> FPinConnectionResponse <span class="title">CanCreateConnection</span><span class="params">(<span class="keyword">const</span> UEdGraphPin* A, <span class="keyword">const</span> UEdGraphPin* B)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">FPinConnectionResponse</span>(CONNECT_RESPONSE_DISALLOW, <span class="built_in">TEXT</span>(<span class="string">&quot;Not implemented by this schema&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å®šä¹‰ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦å¯ä»¥åˆå¹¶ã€‚åˆå¹¶åˆæ³•è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œå¦åˆ™è¿”å›ä¸å¯åˆå¹¶çš„åŸå› ä¿¡æ¯ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">const</span> FPinConnectionResponse <span class="title">CanMergeNodes</span><span class="params">(<span class="keyword">const</span> UEdGraphNode* A, <span class="keyword">const</span> UEdGraphNode* B)</span> <span class="keyword">const</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">FPinConnectionResponse</span>(CONNECT_RESPONSE_DISALLOW, <span class="built_in">TEXT</span>(<span class="string">&quot;Not implemented by this schema&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°è¯•åœ¨ä¸¤ä¸ªå¼•è„šé—´åˆ›å»ºè¿æ¥</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">TryCreateConnection</span><span class="params">(UEdGraphPin* A, UEdGraphPin* B)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°è¯•åœ¨ä¸¤ä¸ªå¼•è„šé—´åˆ›å»ºè‡ªåŠ¨ç±»å‹è½¬æ¢èŠ‚ç‚¹ï¼ŒæˆåŠŸåˆ™è¿”å›çœŸï¼Œå¦åˆ™è¿”å›å‡ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">CreateAutomaticConversionNodeAndConnections</span><span class="params">(UEdGraphPin* A, UEdGraphPin* B)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å°†èŠ‚ç‚¹åˆ†ç¦»åˆ°ä¸ºå­å…ƒç´  (vector -&gt; x,y,z) */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SplitPin</span><span class="params">(UEdGraphPin* Pin, <span class="keyword">bool</span> bNotify = <span class="literal">true</span>)</span> <span class="keyword">const</span> </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** å°†åˆ†ç¦»çš„å­èŠ‚ç‚¹åˆå¹¶ä¸ºä¸€ä¸ªèŠ‚ç‚¹(x,y,z -&gt; vector) */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">RecombinePin</span><span class="params">(UEdGraphPin* Pin)</span> <span class="keyword">const</span> </span>&#123; &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨é»˜è®¤èŠ‚ç‚¹å¡«å……æ–°å›¾</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CreateDefaultNodesForGraph</span><span class="params">(UEdGraph&amp; Graph)</span> <span class="keyword">const</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é‡æ„ä¼ å…¥èŠ‚ç‚¹</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ReconstructNode</span><span class="params">(UEdGraphNode&amp; TargetNode, <span class="keyword">bool</span> bIsBatchRequest=<span class="literal">false</span>)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å…è®¸æ¨¡å¼åœ¨ç‰¹å®šèµ„æºæ‹–åŠ¨åˆ°ç‰¹å®šèŠ‚ç‚¹æ—¶ï¼Œç”Ÿæˆå·¥å…·æç¤ºä¿¡æ¯(å›¾æ¡ˆ&amp;ä¿¡æ¯) */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">GetAssetsPinHoverMessage</span><span class="params">(<span class="keyword">const</span> TArray&lt;struct FAssetData&gt;&amp; Assets, <span class="keyword">const</span> UEdGraphPin* HoverPin, FString&amp; OutTooltipText, <span class="keyword">bool</span>&amp; OutOkIcon)</span> <span class="keyword">const</span> </span></span><br><span class="line"><span class="function">	</span>&#123; </span><br><span class="line">		OutTooltipText = <span class="built_in">FString</span>();</span><br><span class="line">		OutOkIcon = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">/* æ­¤å›¾æ˜¯å¦å¯ä»¥è¢«æ‹·è´ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">CanDuplicateGraph</span><span class="params">(UEdGraph* InSourceGraph)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å¼•è„šæ‹–åŠ¨åˆ°èŠ‚ç‚¹ä¸­æ—¶è§¦å‘ï¼ŒæŸäº›èŠ‚ç‚¹å¯ä»¥ç”Ÿæˆæ–°å¼•è„šï¼Œå¦‚: å‡½æ•°å…¥å£èŠ‚ç‚¹</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> UEdGraphPin* <span class="title">DropPinOnNode</span><span class="params">(UEdGraphNode* InTargetNode, <span class="keyword">const</span> FName&amp; InSourcePinName, <span class="keyword">const</span> FEdGraphPinType&amp; InSourcePinType, EEdGraphPinDirection InSourcePinDirection)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="literal">nullptr</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å¦‚æœæ¨¡å¼å¸Œæœ›é‡å†™æ·»åŠ æ–°èŠ‚ç‚¹æ—¶è“å›¾æ ‡è„çš„è¡Œä¸ºï¼Œåˆ™è¿”å›çœŸ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">MarkBlueprintDirtyFromNewNode</span><span class="params">(UBlueprint* InBlueprint, UEdGraphNode* InEdGraphNode)</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// .......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><code>UEdGraphSchema</code> (ç¼–è¾‘å™¨å›¾æ¨¡å¼) å®šä¹‰äº†å¼€å‘è€…åœ¨ç¼–è¾‘å™¨ä¸­è¿›è¡Œçš„ç›¸å…³æ“ä½œæ˜¯å¦å¯è¡Œï¼Œå¯è¡Œåå°†å¦‚ä½•å¤„ç†ã€‚åœ¨æ­¤ç±»çš„å¸®åŠ©ä¸‹ï¼Œå¼€å‘è€…å¯ä»¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„èŠ‚ç‚¹å¯ç”¨æ€§åˆ†æï¼Œæ˜¯è¾…åŠ©è“å›¾å¼€å‘çš„åˆ©å™¨ã€‚</p><h3 id="schema-uedgraphschema_k2"><a class="anchor" href="#schema-uedgraphschema_k2">#</a> Schema | UEdGraphSchema_K2</h3><p></p><figure class="highlight c++"><figcaption><span>UEdGraphSchema_K2</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// EdGraphSchema_K2.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(config=Editor)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BLUEPRINTGRAPH_API</span> <span class="title">UEdGraphSchema_K2</span> :</span> <span class="keyword">public</span> UEdGraphSchema</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_UCLASS_BODY</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** åˆ›å»ºæ–°çš„å˜é‡è·å–èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°çˆ¶å›¾ä¸­ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> class UK2Node_VariableGet* <span class="title">SpawnVariableGetNode</span><span class="params">(<span class="keyword">const</span> FVector2D GraphPosition, class UEdGraph* ParentGraph, FName VariableName, UStruct* Source)</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦é»˜è®¤ä½¿ç”¨å¼•ç”¨ç±»å‹ */</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">IsAutoCreateRefTerm</span><span class="params">(<span class="keyword">const</span> UEdGraphPin* Pin)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** å¯»æ‰¾ç»™å®šèŠ‚ç‚¹åŠæ–¹å‘çš„ç¬¬ä¸€ä¸ªæ‰§è¡Œå¼•è„š(SequenceèŠ‚ç‚¹çš„è¾“å‡ºæ–¹å‘æœ‰å¤šä¸ªæ‰§è¡Œå¼•è„šï¼Œè¿”å›ç¬¬ä¸€ä¸ª) */</span></span><br><span class="line">	<span class="function">UEdGraphPin* <span class="title">FindExecutionPin</span><span class="params">(<span class="keyword">const</span> UEdGraphNode&amp; Node, EEdGraphPinDirection PinDirection)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** æ›¿æ¢å½“å‰å›¾èŠ‚ç‚¹å¼•ç”¨å¯¹è±¡åˆ°æ–°å¯¹è±¡ä¸­ */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">ReplaceSelectedNode</span><span class="params">(UEdGraphNode* SourceNode, AActor* TargetActor)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** è¿”å›æ­¤å‡½æ•°çš„å‚æ•°åˆ—è¡¨ï¼Œå‡½æ•°åœ¨ç¼–è¯‘å™¨ä¸­è‡ªåŠ¨ä¸ºæœªè¿æ¥çš„å¼•ç”¨å‚æ•°å¡«å……ç»ˆç«¯ */</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">GetAutoEmitTermParameters</span><span class="params">(<span class="keyword">const</span> UFunction* Function, TArray&lt;FString&gt;&amp; AutoEmitParameterNames)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** ä¸ºæ–°å‡½æ•°å›¾å¡«å……å…¥å£èŠ‚ç‚¹å’Œè¿”å›èŠ‚ç‚¹(å¦‚æœæœ‰) */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">CreateFunctionGraphTerminators</span><span class="params">(UEdGraph&amp; Graph, UClass* Class)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">/** è¿”å›ä¼ å…¥å±æ€§çš„ç±»å‹ä¿¡æ¯ */</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> FText <span class="title">TypeToText</span><span class="params">(FProperty* <span class="keyword">const</span> Property)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** è®¾ç½®å¼•è„šé»˜è®¤å€¼ï¼Œä½†åœ¨å¼•è„šæ„é€ æ—¶ä¸è‡ªåŠ¨ç”Ÿæˆé»˜è®¤å€¼ï¼Œä¸ TrySetDefaultValue ç±»ä¼¼ï¼Œä½†ä¸è¿›è¡ŒéªŒè¯å’Œå›è°ƒ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetPinDefaultValueAtConstruction</span><span class="params">(UEdGraphPin* Pin, <span class="keyword">const</span> FString&amp; DefaultValueString)</span> <span class="keyword">const</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** è¿”å›ç»™å®šå‡½æ•°ä¸­ä¼ å…¥å±æ€§çš„é»˜è®¤å€¼ */</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">FindFunctionParameterDefaultValue</span><span class="params">(<span class="keyword">const</span> UFunction* Function, <span class="keyword">const</span> FProperty* Param, FString&amp; OutString)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>ä¸ <code>UEdGraphSchema</code> ç±»ä¼¼ï¼Œè¿›ä¸€æ­¥ç¡®å®šè“å›¾çš„ç¼–è¾‘è§„èŒƒï¼Œå¦‚ï¼šå¼•è„šå’Œé»˜è®¤å€¼çš„ä½¿ç”¨è§„èŒƒã€‚</p><h3 id="sgrapheditor"><a class="anchor" href="#sgrapheditor">#</a> SGraphEditor</h3><p>å›¾ç¼–è¾‘å™¨ Slate æ˜¯å›¾ç¼–è¾‘å™¨ä¼—å¤š Widgets çš„åŒ…è£…å™¨ï¼Œå®ç°äº†ç¼–è¾‘å™¨è§†å›¾çš„ç›¸å…³æ“ä½œ (å¦‚ï¼šè§†å›¾è·³è½¬ï¼Œè°ƒæ•´èšç„¦ç­‰)ï¼Œä¸”å¯ä»¥ä¼˜é›…åœ°å¤„ç†å›¾ç¼–è¾‘æ¨¡ç»„ (GraphEditorModule) çš„å¸è½½</p><p></p><figure class="highlight c++"><figcaption><span>SGraphEditor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SGraphEditor</span> :</span> <span class="keyword">public</span> SCompoundWidget</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/* å°†ä¸¤ä¸ªå›¾ç¼–è¾‘å™¨é”å®šåˆ°ä¸€èµ· */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">LockToGraphEditor</span><span class="params">(TWeakPtr&lt;SGraphEditor&gt; Other)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* è§£é”ä¸¤ä¸ªç¼–è¾‘å™¨ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">UnlockFromGraphEditor</span><span class="params">(TWeakPtr&lt;SGraphEditor&gt; Other)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** å°†è§†å›¾(å±å¹•æ˜¾ç¤º)ç§»åŠ¨åˆ°ç‰¹å®šèŠ‚ç‚¹ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">JumpToNode</span><span class="params">( <span class="keyword">const</span> class UEdGraphNode* JumpToMe, <span class="keyword">bool</span> bRequestRename = <span class="literal">false</span>, <span class="keyword">bool</span> bSelectNode = <span class="literal">true</span> )</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** å°†è§†å›¾(å±å¹•æ˜¾ç¤º)ç§»åŠ¨åˆ°ç‰¹å®šå¼•è„š */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">JumpToPin</span><span class="params">( <span class="keyword">const</span> class UEdGraphPin* JumpToMe )</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** è®¾ç½®å¼•è„šå¯è§æ¨¡å¼ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetPinVisibility</span><span class="params">(EPinVisibility InVisibility)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** æ¸…ç©ºé€‰æ‹©é¡¹ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ClearSelectionSet</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// èšç„¦åˆ°åˆé€‚çš„å¯ä»¥åŒ…å«æ‰€æœ‰èŠ‚ç‚¹æˆ–åŒ…å«æ‰€æœ‰é€‰å®šèŠ‚ç‚¹çš„å¤§å°</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ZoomToFit</span><span class="params">(<span class="keyword">bool</span> bOnlySelection)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** è·å–æ‰€æœ‰é€‰å®šèŠ‚ç‚¹çš„è¾¹æ¡†ï¼Œæœªé€‰å®šåˆ™è¿”å›å‡ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">GetBoundsForSelectedNodes</span><span class="params">(class FSlateRect&amp; Rect, <span class="keyword">float</span> Padding)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">StraightenConnections</span><span class="params">(UEdGraphPin* SourcePin, UEdGraphPin* PinToAlign = <span class="literal">nullptr</span>)</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">RefreshNode</span><span class="params">(UEdGraphNode&amp; Node)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ‰§è¡Œä»¥ä½¿æ­¤ widget çŸ¥é“ GraphEditor æ¨¡ç»„è¢«é‡è½½</span></span><br><span class="line">	<span class="function">UNREALED_API <span class="keyword">void</span> <span class="title">OnModuleReloaded</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ‰§è¡Œä»¥ä½¿æ­¤ widget çŸ¥é“ GraphEditor æ¨¡ç»„è¢«å¸è½½</span></span><br><span class="line">	<span class="function">UNREALED_API <span class="keyword">void</span> <span class="title">OnModuleUnloading</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** åœ¨å›¾è¢«æ”¹å˜æ—¶è°ƒç”¨ */</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">NotifyGraphChanged</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// .......</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">/** æ­£åœ¨ç¼–è¾‘çš„å›¾ */</span></span><br><span class="line">	UEdGraph* EdGraphObj;</span><br><span class="line"></span><br><span class="line">	TWeakPtr&lt;FAssetEditorToolkit&gt; AssetEditorToolkit;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">/** GraphEditorçš„å®é™…æ‰§è¡Œä½“ */</span></span><br><span class="line">	TSharedPtr&lt;SGraphEditor&gt; Implementation;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** æ´»è·ƒçš„ GraphEditor çš„åŒ…è£…å™¨ï¼Œåœ¨æ¨¡ç»„å¸è½½æ—¶é€šçŸ¥ä»–ä»¬è¿›è¡Œä¼˜é›…çš„å¤„ç† */</span></span><br><span class="line">	UNREALED_API <span class="keyword">static</span> TArray&lt; TWeakPtr&lt;SGraphEditor&gt; &gt; AllInstances;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å½“å›¾æ¨¡ç»„é‡åŠ è½½æ—¶è§¦å‘æ­¤å›è°ƒ</span></span><br><span class="line">	FEdGraphEvent OnGraphModuleReloadedCallback;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å›¾ç¼–è¾‘æ¨¡ç»„éœ€è¦è®¿é—®æ‰€æœ‰å®ä¾‹</span></span><br><span class="line">	<span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">FGraphEditorModule</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p></p><h3 id="è“å›¾ç¼–è¾‘å™¨å·¥ä½œæœºåˆ¶"><a class="anchor" href="#è“å›¾ç¼–è¾‘å™¨å·¥ä½œæœºåˆ¶">#</a> è“å›¾ç¼–è¾‘å™¨å·¥ä½œæœºåˆ¶</h3><ol><li>æ‰“å¼€è“å›¾ï¼Œèµ„æºç¼–è¾‘å­ç³»ç»Ÿ ( <code>UAssetEditorSubsystem</code> ) å°†è°ƒç”¨ <code>OpenEditorForAsset</code> ï¼Œæ ¹æ®ä¸åŒçš„èµ„æºç±»å‹ (è“å›¾ç±»å‹)ï¼Œåˆ›å»ºå¯¹åº”çš„ç¼–è¾‘å™¨å¹¶åŠ è½½æ­£åœ¨æ‰“å¼€çš„èµ„æº (è“å›¾)ï¼Œ</li><li>åˆå§‹åŒ–ç¼–è¾‘å™¨æ—¶å°†åˆ›å»ºå¯¹åº”çš„ <code>Slate</code> ï¼Œèœå•æ ç­‰ï¼Œæ¥ç€å°†è“å›¾ä¿¡æ¯ (èŠ‚ç‚¹ï¼Œå¼•è„šï¼Œè¿çº¿ï¼Œå±æ€§é»˜è®¤å€¼ç­‰) åŠ è½½åˆ° <code>Slate</code> ä¸­ï¼Œ</li><li>å¼€å‘è€…åœ¨ç¼–è¾‘å™¨ä¸­çš„æ“ä½œå°†è¢«å¼•æ“è§£é‡Šä¸ºå¯¹ <code>UBlueprint</code> æ•°æ®çš„æ“ä½œï¼Œä½†æ“ä½œå—åˆ° <code>UEdGraphSchema_K2</code> çš„é™åˆ¶ï¼Œ</li><li>ç¼–è¯‘è“å›¾ï¼Œç”Ÿæˆå¯¹åº” <code>BPGC</code> ï¼Œ <code>CDO</code> ï¼Œå­—èŠ‚ç ç­‰ï¼Œ</li><li>ä¿å­˜è“å›¾ï¼Œå°†è“å›¾åºåˆ—åŒ–åˆ°ç£ç›˜ä¸­ã€‚</li></ol><hr><p>ç»“è¯­ï¼šæœ¬ç¯‡ä¸»è¦å›´ç»•è“å›¾åˆ›å»ºå’Œç¼–è¯‘çš„å®ç°æœºåˆ¶å±•å¼€ï¼Œè“å›¾ä¿å­˜ä¸»è¦æ˜¯åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œæƒ³æ·±å…¥ç ”ç©¶çš„åŒå­¦å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢ã€‚æœ€åæ˜¯è“å›¾ç¼–è¾‘å™¨çš„ç›¸å…³ç±»ï¼ŒåŠå…¶å·¥ä½œåŸç†çš„ä»‹ç»ã€‚æŒæ¡ <code>UGraph</code> ï¼Œ <code>UGraphNode</code> ï¼Œ <code>UK2_Node</code> , <code>UEdGraphSchema_K2</code> è¿™äº›ç±»æ˜¯å®ç°è‡ªå®šä¹‰è“å›¾èŠ‚ç‚¹çš„å‰æã€‚å¦å¤–ï¼Œç¼–è¾‘å™¨ç•Œé¢éƒ½æ˜¯ç”± Slate æ­å»ºèµ·æ¥çš„ï¼Œæœ¬ç¯‡å¹¶æ²¡æœ‰å¯¹è“å›¾ç¼–è¾‘å™¨çš„æ­å»ºè¿›è¡Œå±•å¼€ï¼Œå› ä¸ºåœ¨å…¶ä»–åšå®¢é‡Œé¢å·²ç»ä»‹ç»è¿‡ç±»ä¼¼çš„ç¼–è¾‘å™¨äº†ï¼Œæƒ³ç ”ç©¶çš„åŒå­¦è¯·è‡ªè¡Œç¿»çœ‹ã€‚</p></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-02-11 18:21:03" itemprop="dateModified" datetime="2022-02-11T18:21:03+08:00">2022-02-11</time> </span><span id="2022/01/08/UE4/UE4CPP/Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶/" class="item leancloud_visitors" data-flag-title="Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶" title="é˜…è¯»æ¬¡æ•°"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">é˜…è¯»æ¬¡æ•°</span> <span class="leancloud-visitors-count"></span> <span class="text">æ¬¡</span></span></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>-YIFEI- <i class="ic i-at"><em>@</em></i>ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://kotori_suki.github.io/2022/01/08/UE4/UE4CPP/Unreal%20%E8%93%9D%E5%9B%BE%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/" title="Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶">https://kotori_suki.github.io/2022/01/08/UE4/UE4CPP/Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/01/03/UE4/UE4CPP/Unreal%20MovementComponent%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicitht3xtj20zk0m8k5v.jpg" title="Unreal MovementComponent æºç è§£æ"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> UE4_C++</span><h3>Unreal MovementComponent æºç è§£æ</h3></a></div><div class="item right"><a href="/2022/03/15/UE4/UE4CPP/Unreal%20%E5%B8%B8%E7%94%A8%E6%8E%A5%E5%8F%A3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclhnx9glj20zk0m8npd.jpg" title="Unreal å¸¸ç”¨æ¥å£æºç åˆ†æâ€”â€”åˆ›å»ºå¯¹è±¡"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> UE4_C++</span><h3>Unreal å¸¸ç”¨æ¥å£æºç åˆ†æâ€”â€”åˆ›å»ºå¯¹è±¡</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#unreal-%E8%93%9D%E5%9B%BE%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%93%9D%E5%9B%BE%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6%E6%A6%82%E8%A6%81"><span class="toc-number">1.1.</span> <span class="toc-text">è“å›¾åº•å±‚å®ç°æœºåˆ¶æ¦‚è¦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%93%9D%E5%9B%BE"><span class="toc-number">1.2.</span> <span class="toc-text">åˆ›å»ºè“å›¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E8%93%9D%E5%9B%BE"><span class="toc-number">1.3.</span> <span class="toc-text">ç¼–è¯‘è“å›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E7%BC%96%E8%AF%91%E8%93%9D%E5%9B%BE"><span class="toc-number">1.3.1.</span> <span class="toc-text">é‡ç¼–è¯‘è“å›¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">ç¼–è¯‘å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%8D%95%E4%B8%AA%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">ç¼–è¯‘å•ä¸ªå‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%BC%96%E8%AF%91%E5%90%8E%E5%A4%84%E7%90%86"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">å‡½æ•°ç¼–è¯‘åå¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A1%AB%E5%85%85%E5%87%BD%E6%95%B0%E4%BD%93%E5%92%8C%E6%A1%86%E6%9E%B6%E8%93%9D%E5%9B%BE%E7%B1%BB%E7%9A%84%E6%A0%B9%E5%AD%98%E5%87%BD%E6%95%B0%E4%BD%93"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">å¡«å……å‡½æ•°ä½“å’Œæ¡†æ¶è“å›¾ç±»çš„æ ¹å­˜å‡½æ•°ä½“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%93%9D%E5%9B%BE%E7%BC%96%E8%BE%91%E5%99%A8%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.4.</span> <span class="toc-text">è“å›¾ç¼–è¾‘å™¨çš„å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#node-uedgraphnode"><span class="toc-number">1.4.1.</span> <span class="toc-text">Node | UEdGraphNode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#node-uk2node"><span class="toc-number">1.4.2.</span> <span class="toc-text">Node | UK2Node</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#schema-uedgraphschema"><span class="toc-number">1.4.3.</span> <span class="toc-text">Schema | UEdGraphSchema</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#schema-uedgraphschema_k2"><span class="toc-number">1.4.4.</span> <span class="toc-text">Schema | UEdGraphSchema_K2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sgrapheditor"><span class="toc-number">1.4.5.</span> <span class="toc-text">SGraphEditor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%93%9D%E5%9B%BE%E7%BC%96%E8%BE%91%E5%99%A8%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.6.</span> <span class="toc-text">è“å›¾ç¼–è¾‘å™¨å·¥ä½œæœºåˆ¶</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/2021/10/25/UE4/UE4CPP/API%E4%B8%8D%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C-%E4%B9%8B-GetGameMode/" rel="bookmark" title="APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetGameMode">APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetGameMode</a></li><li><a href="/2021/10/25/UE4/UE4CPP/API%E4%B8%8D%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C-%E4%B9%8B-GetPlayerController/" rel="bookmark" title="APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetPlayerController">APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetPlayerController</a></li><li><a href="/2021/10/25/UE4/UE4CPP/unreal%20%E5%BC%95%E6%93%8E%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" rel="bookmark" title="unrealå¼•æ“å¯åŠ¨æµç¨‹">unrealå¼•æ“å¯åŠ¨æµç¨‹</a></li><li><a href="/2021/10/26/UE4/UE4CPP/%E4%BB%8ESVG%E6%96%87%E4%BB%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E6%97%85%E7%A8%8B/" rel="bookmark" title="ä»SVGæ–‡ä»¶å¼€å§‹çš„æ—…ç¨‹~~~">ä»SVGæ–‡ä»¶å¼€å§‹çš„æ—…ç¨‹~~~</a></li><li><a href="/2021/10/29/UE4/UE4CPP/%E5%8F%8D%E5%B0%84%E7%B3%BB%E7%BB%9F%20API/" rel="bookmark" title="åå°„ç³»ç»ŸAPI  è§£æå’Œä½¿ç”¨">åå°„ç³»ç»ŸAPI è§£æå’Œä½¿ç”¨</a></li><li><a href="/2021/10/31/UE4/UE4CPP/Session%E7%9A%84%E4%BD%BF%E7%94%A8%20C++%E7%AF%87/" rel="bookmark" title="Sessionçš„ä½¿ç”¨ C++ç¯‡">Sessionçš„ä½¿ç”¨ C++ç¯‡</a></li><li><a href="/2021/11/02/UE4/UE4CPP/Unreal%20%E5%BA%8F%E5%88%97%E5%8C%96/" rel="bookmark" title="Unreal åºåˆ—åŒ–~~~">Unreal åºåˆ—åŒ–~~~</a></li><li><a href="/2021/11/06/UE4/UE4CPP/Unreal%20GC%E8%BF%87%E7%A8%8B/" rel="bookmark" title="Unreal GCè¿‡ç¨‹">Unreal GCè¿‡ç¨‹</a></li><li><a href="/2021/11/08/UE4/UE4CPP/UClass%E7%9A%84%E8%AF%9E%E7%94%9F%E4%B8%8E%E6%88%90%E9%95%BF/" rel="bookmark" title="UClassçš„è¯ç”Ÿä¸æˆé•¿">UClassçš„è¯ç”Ÿä¸æˆé•¿</a></li><li><a href="/2021/11/11/UE4/UE4CPP/UE4%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%B8%8E%E7%94%A8%E6%B3%95/" rel="bookmark" title="UE4ä»£ç†çš„å®ç°ä¸ç”¨æ³•">UE4ä»£ç†çš„å®ç°ä¸ç”¨æ³•</a></li><li><a href="/2021/11/15/UE4/UE4CPP/FProperty%E7%9A%84%E5%88%86%E6%9E%90%E4%B8%8E%E6%80%BB%E7%BB%93/" rel="bookmark" title="FPropertyçš„åˆ†æä¸æ€»ç»“">FPropertyçš„åˆ†æä¸æ€»ç»“</a></li><li><a href="/2021/11/22/UE4/UE4CPP/Unreal%20%E5%A4%9A%E7%A7%8D%E6%8C%87%E9%92%88%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/" rel="bookmark" title="Unreal å¤šç§æŒ‡é’ˆå®ç°åŸç†">Unreal å¤šç§æŒ‡é’ˆå®ç°åŸç†</a></li><li><a href="/2021/11/26/UE4/UE4CPP/Unreal%20Slate/" rel="bookmark" title="Unreal Slate">Unreal Slate</a></li><li><a href="/2021/12/01/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20%E6%80%BB%E8%A7%88%20&%20UEngine%20&%20UGameInstance/" rel="bookmark" title="Gameplay â€”â€” æ€»è§ˆ & UEngine & UGameInstance">Gameplay â€”â€” æ€»è§ˆ & UEngine & UGameInstance</a></li><li><a href="/2021/12/03/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20FWorldContext%20&%20UWorld%20&%20ULevel/" rel="bookmark" title="Gameplay â€”â€” FWorldContext & UWorld & ULevel">Gameplay â€”â€” FWorldContext & UWorld & ULevel</a></li><li><a href="/2021/12/06/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20AActor%20&%20UActorComponent/" rel="bookmark" title="Gameplay â€”â€” AActor & UActorComponent">Gameplay â€”â€” AActor & UActorComponent</a></li><li><a href="/2021/12/09/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20APawn%20&%20AController%20&%20APlayerController/" rel="bookmark" title="Gameplay â€”â€” APawn & AController & APlayerController">Gameplay â€”â€” APawn & AController & APlayerController</a></li><li><a href="/2021/12/12/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20AGameMode%20&%20AGameState%20&%20APlayerState/" rel="bookmark" title="Gameplay â€”â€” AGameMode & AGameState & APlayerState">Gameplay â€”â€” AGameMode & AGameState & APlayerState</a></li><li><a href="/2021/12/15/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20USavegame%20&%20UPlayer/" rel="bookmark" title="Gameplay â€”â€” USavegame & UPlayer">Gameplay â€”â€” USavegame & UPlayer</a></li><li><a href="/2021/12/17/UE4/UE4CPP/Unreal%20GAS%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" rel="bookmark" title="Unreal GAS æºç è§£æ">Unreal GAS æºç è§£æ</a></li><li><a href="/2021/12/28/UE4/UE4CPP/CustomItemModule/" rel="bookmark" title="Custom Item Module">Custom Item Module</a></li><li><a href="/2021/12/30/UE4/UE4CPP/Unreal%20%E5%BC%82%E6%AD%A5%E4%B8%8E%E5%B9%B6%E8%A1%8C%E7%BC%96%E7%A8%8B/" rel="bookmark" title="Unreal å¼‚æ­¥ä¸å¹¶è¡Œç¼–ç¨‹">Unreal å¼‚æ­¥ä¸å¹¶è¡Œç¼–ç¨‹</a></li><li><a href="/2022/01/03/UE4/UE4CPP/Unreal%20MovementComponent%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" rel="bookmark" title="Unreal MovementComponent æºç è§£æ">Unreal MovementComponent æºç è§£æ</a></li><li class="active"><a href="/2022/01/08/UE4/UE4CPP/Unreal%20%E8%93%9D%E5%9B%BE%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/" rel="bookmark" title="Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶">Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶</a></li><li><a href="/2022/03/15/UE4/UE4CPP/Unreal%20%E5%B8%B8%E7%94%A8%E6%8E%A5%E5%8F%A3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1/" rel="bookmark" title="Unreal å¸¸ç”¨æ¥å£æºç åˆ†æâ€”â€”åˆ›å»ºå¯¹è±¡">Unreal å¸¸ç”¨æ¥å£æºç åˆ†æâ€”â€”åˆ›å»ºå¯¹è±¡</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="-YIFEI-" data-src="/images/avatar.jpg"><p class="name" itemprop="name">-YIFEI-</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">56</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">15</span> <span class="name">åˆ†ç±»</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0tvdG9yaS1TdWtp" title="https:&#x2F;&#x2F;github.com&#x2F;Kotori-Suki"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS90dnQtNjA=" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;tvt-60"><i class="ic i-zhihu"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li></ul></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/01/03/UE4/UE4CPP/Unreal%20MovementComponent%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/03/15/UE4/UE4CPP/Unreal%20%E5%B8%B8%E7%94%A8%E6%8E%A5%E5%8F%A3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/ModuleDesign/" title="åˆ†ç±»äº ModuleDesign">ModuleDesign</a></div><span><a href="/2021/12/28/UE4/UE4CPP/CustomItemModule/" title="Custom Item Module">Custom Item Module</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a></div><span><a href="/2021/10/25/UE4/UE4CPP/unreal%20%E5%BC%95%E6%93%8E%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="unrealå¼•æ“å¯åŠ¨æµç¨‹">unrealå¼•æ“å¯åŠ¨æµç¨‹</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a></div><span><a href="/2021/10/26/UE4/UE4CPP/%E4%BB%8ESVG%E6%96%87%E4%BB%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E6%97%85%E7%A8%8B/" title="ä»SVGæ–‡ä»¶å¼€å§‹çš„æ—…ç¨‹~~~">ä»SVGæ–‡ä»¶å¼€å§‹çš„æ—…ç¨‹~~~</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a></div><span><a href="/2021/12/17/UE4/UE4CPP/Unreal%20GAS%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="Unreal GAS æºç è§£æ">Unreal GAS æºç è§£æ</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ComputerBase/" title="åˆ†ç±»äº è®¡ç®—æœºåŸºç¡€">è®¡ç®—æœºåŸºç¡€</a> <i class="ic i-angle-right"></i> <a href="/categories/ComputerBase/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="åˆ†ç±»äº æ“ä½œç³»ç»Ÿ">æ“ä½œç³»ç»Ÿ</a></div><span><a href="/2021/08/17/ComputerBase/OperatingSystem/32%E4%BD%8D64%E4%BD%8D%E7%B3%BB%E7%BB%9F%E3%80%81%E5%AD%97%E8%8A%82%E5%AF%B9%E9%BD%90/" title="32ä½64ä½ç³»ç»Ÿã€å­—èŠ‚å¯¹é½">32ä½64ä½ç³»ç»Ÿã€å­—èŠ‚å¯¹é½</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a></div><span><a href="/2021/08/16/CPPBase/CPP%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" title="C++å†…å­˜ç®¡ç†">C++å†…å­˜ç®¡ç†</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A6%82%E8%BF%B0/" title="åˆ†ç±»äº æ¦‚è¿°">æ¦‚è¿°</a></div><span><a href="/2021/08/16/CPPBase/DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%85%AD%E5%A4%A7%E5%8E%9F%E5%88%99%20&%20%E6%A6%82%E8%BF%B0/" title="è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™ &amp; æ¦‚è¿°">è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™ & æ¦‚è¿°</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/Gameplay/" title="åˆ†ç±»äº Gameplay">Gameplay</a></div><span><a href="/2021/12/15/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20USavegame%20&%20UPlayer/" title="Gameplay â€”â€” USavegame &amp; UPlayer">Gameplay â€”â€” USavegame & UPlayer</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/%E6%8F%92%E4%BB%B6%E5%88%B6%E4%BD%9C/" title="åˆ†ç±»äº æ’ä»¶åˆ¶ä½œ">æ’ä»¶åˆ¶ä½œ</a></div><span><a href="/2021/08/05/UE4/UE4Plugin/UE4_Plugin/" title="UE4 Plugin">UE4 Plugin</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a></div><span><a href="/2021/10/25/UE4/UE4CPP/API%E4%B8%8D%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C-%E4%B9%8B-GetGameMode/" title="APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetGameMode">APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetGameMode</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2021 â€“ <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">-YIFEI- @ Afei's Blog</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/01/08/UE4/UE4CPP/Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>