<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹" href="https://kotori_suki.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹" href="https://kotori_suki.github.io/atom.xml"><link rel="alternate" type="application/json" title="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹" href="https://kotori_suki.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://kotori_suki.github.io/2021/11/08/UE4/UE4CPP/UClass%E7%9A%84%E8%AF%9E%E7%94%9F%E4%B8%8E%E6%88%90%E9%95%BF/"><title>UClassçš„è¯ç”Ÿä¸æˆé•¿ - UE4_C++ - UE4 | Afei's Blog = ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹ = Welcome to my blog !</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">UClassçš„è¯ç”Ÿä¸æˆé•¿</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2021-11-08 11:02:38"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2021-11-08T11:02:38+08:00">2021-11-08</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Afei's Blog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclh5u05ej20zk0m87df.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giciszlczyj20zk0m816d.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipeubcbajj20zk0m8h1h.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclhpw3lwj20zk0m8gvw.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipetv6p75j20zk0m8x6p.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/UE4/" itemprop="item" rel="index" title="åˆ†ç±»äº UE4"><span itemprop="name">UE4</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/UE4/UE4CPP/" itemprop="item" rel="index" title="åˆ†ç±»äº UE4_C++"><span itemprop="name">UE4_C++</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://kotori_suki.github.io/2021/11/08/UE4/UE4CPP/UClass%E7%9A%84%E8%AF%9E%E7%94%9F%E4%B8%8E%E6%88%90%E9%95%BF/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="-YIFEI-"><meta itemprop="description" content="Welcome to my blog !, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹"></span><div class="body md" itemprop="articleBody"><h1 id="uclassçš„è¯ç”Ÿä¸æˆé•¿"><a class="anchor" href="#uclassçš„è¯ç”Ÿä¸æˆé•¿">#</a> UClass çš„è¯ç”Ÿä¸æˆé•¿</h1><p>ç®€ä»‹ï¼šæœ¬ç¯‡å°†å¯¹ &quot;UClass&quot; çš„æ„é€ å’Œåˆå§‹åŒ–è¿›è¡Œè§£æï¼ŒåŒæ—¶ä¹Ÿä¼šæ¶‰åŠåˆ° &quot;UClass&quot; ä¸­çš„æ‰€æœ‰å±æ€§å’Œå‡½æ•°çš„è§£æã€‚ä¸ºä»€ä¹ˆä¼šæƒ³åˆ°å»ç ”ç©¶ &quot;UClass&quot; å‘¢ï¼Ÿä¸»è¦æ˜¯å› ä¸ºæºç ä¸­å¾ˆå¤šå‡½æ•°çš„å®ç°ï¼Œéƒ½ç”¨åˆ°äº† &quot;UClass&quot; ä¸­çš„åå°„ä¿¡æ¯ã€‚å¦‚æœæƒ³æ·±å…¥åœ°äº†è§£è¿™ä¸ªå‡½æ•°ï¼Œé‚£å°±å¾—å…ˆäº†è§£è¿™ä¸ª &quot;UClass&quot; é‡Œé¢éƒ½æœ‰äº›ä»€ä¹ˆå±æ€§ï¼Œåˆæ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ ğŸ˜ƒ</p><p>å‰ç½®çŸ¥è¯†ï¼š</p><ol start="2"><li>äº†è§£ &quot;UHT&quot; çš„ç¼–è¯‘è¿‡ç¨‹</li><li>äº†è§£ &quot;SparseClassData&quot; ç»“æ„ä½“ ï¼ˆå®ä¸­å¯¹å…¶è¿›è¡Œå¤„ç†ï¼‰</li><li>äº†è§£ &quot;RPC&quot; å‡½æ•° ï¼ˆå®ä¸­å¯¹å…¶è¿›è¡Œå¤„ç†ï¼‰</li><li>äº†è§£ &quot;StaticAutoRegister&quot; è®¾è®¡æ¨¡å¼</li><li>äº†è§£ &quot;åå°„æœºåˆ¶&quot; çš„æ¦‚å¿µä¸ä½œç”¨</li><li>äº†è§£ &quot;GC&quot; çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ç”¨åˆ°çš„ä¸€äº›ç»“æ„ä½“å’Œå‡½æ•°</li></ol><h2 id="uclass-ç®€ä»‹"><a class="anchor" href="#uclass-ç®€ä»‹">#</a> UClass ç®€ä»‹</h2><p>é¦–å…ˆï¼Œ&quot;UClass&quot; æ˜¯æè¿°ä¸€ä¸ªç±»çš„ç±»ï¼Œæ˜¯å­˜å‚¨ UObject ç±»åŠå…¶å­ç±»çš„åå°„ä¿¡æ¯çš„ç±»ï¼Œå¯ä»¥è¯´æ˜¯ UE æ•´ä¸ªæ”¾å°„ç³»ç»Ÿçš„æ ¸å¿ƒã€‚ä»¥ä¸‹æ˜¯ &quot;UClass&quot; çš„ç»§æ‰¿å…³ç³»å›¾ï¼ˆå¼•è‡ª<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yNDc5MDM4Ng=="> InsideUE4</span>ï¼‰ï¼Œæˆ‘ä»¬åªå¯¹ &quot;UClass&quot; è¿›è¡Œå±•å¼€ï¼Œå½“ç„¶ä¹Ÿä¼šæ¶‰åŠåˆ° &quot;UObject&quot; çš„è§£æã€‚å…¶ä»–åˆ†æ”¯å…¶å®ä¹Ÿç±»ä¼¼ï¼Œç•™ç»™è¯»è€…è‡ªå·±æ¢ç©¶ã€‚</p><p><img data-src="UClass%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB.jpg" alt="UClassç»§æ‰¿å…³ç³»"></p><h2 id="ä»-generated_body-å¼€å§‹"><a class="anchor" href="#ä»-generated_body-å¼€å§‹">#</a> ä» &quot;GENERATED_BODY ()&quot; å¼€å§‹</h2><p>&quot;UClass&quot; æ˜¯ç”¨æ¥å­˜å‚¨å¼•æ“ç”Ÿæˆçš„åå°„ä¿¡æ¯çš„ï¼Œè€Œåå°„ä»£ç çš„ç”Ÿæˆåˆæ˜¯ä» &quot;GENERATED_BODY ()&quot; å¼€å§‹çš„ï¼Œè‡ªç„¶æˆ‘ä»¬éœ€è¦å›é¡¾ä¸€ä¸‹è¿™ä¸ªå®ï¼ˆåªæ€»ç»“å®å®šä¹‰ï¼Œè¯¦ç»†çš„æº¯æºè¿‡ç¨‹å»ºè®®çœ‹ <span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yNTA5ODY4NQ==">ç±»å‹ç³»ç»Ÿä»£ç ç”Ÿæˆ</span>ï¼‰</p><p><code>GENERATED_BODY()</code> å®å±•å¼€åæ˜¯ <code>&quot;ProjectName_Source_ProjectName_ClassName_h_11_GENERATED_BODY&quot;</code> (&quot;ProjectName&quot;æ˜¯æˆ‘ä»¬çš„é¡¹ç›®åï¼Œ&quot;ClassPath&quot;æ˜¯æˆ‘ä»¬ç±»çš„ç›¸å¯¹è·¯å¾„ï¼Œ11 æ˜¯&quot;GENERATED_BODY ()&quot; æ‰€åœ¨çš„è¡Œå· )ï¼Œå…¶å®å®šä¹‰å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>GENERATED_BODY</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ProjectName_Source_ProjectName_ClassPath_h_11_GENERATED_BODY \</span></span><br><span class="line"><span class="meta">PRAGMA_DISABLE_DEPRECATION_WARNINGS \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">	ProjectName_Source_ProjectName_ClassPath_h_11_PRIVATE_PROPERTY_OFFSET \</span></span><br><span class="line"><span class="meta">	ProjectName_Source_ProjectName_ClassPath_h_11_SPARSE_DATA \</span></span><br><span class="line"><span class="meta">	ProjectName_Source_ProjectName_ClassPath_h_11_RPC_WRAPPERS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">	ProjectName_Source_ProjectName_ClassPath_h_11_INCLASS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">	ProjectName_Source_ProjectName_ClassPath_h_11_ENHANCED_CONSTRUCTORS \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">PRAGMA_ENABLE_DEPRECATION_WARNINGS</span></span><br></pre></td></tr></table></figure><p></p><p>ä»¥ä¸‹å¯¹å„ä¸ªå®è¿›è¡Œç®€å•ä»‹ç»ï¼š</p><ul><li><p>&quot;PRIVATE_PROPERTY_OFFSET&quot;ï¼Œè¯¥å®<strong>å®šä¹‰ è·å–è¯¥ç±»çš„ç§æœ‰å±æ€§çš„åç§»é‡çš„å‡½æ•°</strong>ï¼ˆæ¯ä¸ªç§æœ‰å±æ€§å„ç”Ÿæˆä¸€æ¡ï¼‰ï¼Œå¦‚ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>PRIVATE_PROPERTY_OFFSET</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ProjectName_Source_ClassPath_ClassName_h_11_PRIVATE_PROPERTY_OFFSET \</span></span><br><span class="line"><span class="meta">	FORCEINLINE static uint32 __PPO__PropertyName() &#123; return STRUCT_OFFSET(UClassName, PropertyName); &#125; \</span></span><br></pre></td></tr></table></figure><p></p><p>å…¶ä¸­ &quot;PropertyName&quot; ä¸º ç§æœ‰å±æ€§åï¼ˆ &quot;private&quot; æˆ– &quot;protect&quot; ï¼‰ï¼Œ&quot;UClassName&quot; ä¸º å¸¦å‰ç¼€çš„ç±»å</p></li><li><p>&quot;SPARSE_DATA&quot;ï¼Œè¯¥å®<strong>å®šä¹‰ è·å– &quot;SparseClassData&quot; ç»“æ„ä½“ï¼ŒåŠè¯¥ç»“æ„ä½“å†…æ•°æ®çš„å‡½æ•°</strong>ï¼Œå¦‚ï¼š</p></li></ul><p></p><figure class="highlight c++"><figcaption><span>SPARSE_DATA</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ProjectName_Source_ClassPath_ClassName_h_11_SPARSE_DATA \</span></span><br><span class="line"><span class="meta">FMySparseClassData* GetMySparseClassData() \</span></span><br><span class="line"><span class="meta">&#123; \</span></span><br><span class="line"><span class="meta">	return (FMySparseClassData*)(GetClass()-&gt;GetOrCreateSparseClassData()); \</span></span><br><span class="line"><span class="meta">&#125; \</span></span><br><span class="line"><span class="meta">FMySparseClassData* GetMySparseClassData() const \</span></span><br><span class="line"><span class="meta">&#123; \</span></span><br><span class="line"><span class="meta">	return (FMySparseClassData*)(GetClass()-&gt;GetOrCreateSparseClassData()); \</span></span><br><span class="line"><span class="meta">&#125; \</span></span><br><span class="line"><span class="meta">int32 GetMyIntProperty() \</span></span><br><span class="line"><span class="meta">&#123; \</span></span><br><span class="line"><span class="meta">	return GetMySparseClassData()-&gt;MyIntProperty; \</span></span><br><span class="line"><span class="meta">&#125; \</span></span><br><span class="line"><span class="meta">int32 GetMyIntProperty() const \</span></span><br><span class="line"><span class="meta">&#123; \</span></span><br><span class="line"><span class="meta">	return GetMySparseClassData()-&gt;MyIntProperty; \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br></pre></td></tr></table></figure><p></p><p>å…¶ä¸­ &quot;FMySparseClassData&quot; æ˜¯ä¸€ä¸ª &quot;SparseClassData&quot; ç»“æ„ä½“ã€‚è¿™ä¸ªå®ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€äº›è·å– &quot;SparseClassData&quot; æ•°æ®çš„å‡½æ•°ï¼Œä»¥ä¿è¯äº†æˆ‘ä»¬çš„ &quot;UClass&quot; ä¸­çš„ &quot;SparseClassData&quot; å±æ€§èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ã€‚</p><ul><li>&quot;RPC_WRAPPERS_NO_PURE_DECLS&quot;ï¼Œè¯¥å®<strong>å®šä¹‰ æ‰€æœ‰ &quot;RPC&quot; å‡½æ•°çš„ &quot;Implementation&quot; ç‰ˆæœ¬å’Œ æ‰€æœ‰ &quot;UFUNCTION&quot; å‡½æ•°çš„ &quot;exec&quot; ç‰ˆæœ¬</strong>ï¼Œå¦‚ï¼š</li></ul><p></p><figure class="highlight c++"><figcaption><span>RPC_WRAPPERS_NO_PURE_DECLS</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ProjectName_Source_ClassPath_ClassName_h_11_RPC_WRAPPERS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">	virtual void MyRPCFunction_Implementation(int Param1, bool param2); \</span></span><br><span class="line"><span class="meta">\</span></span><br><span class="line"><span class="meta">	DECLARE_FUNCTION(execMyUFunction); \</span></span><br></pre></td></tr></table></figure><p></p><p>å…¶ä¸­ &quot;MyRPCFunction&quot; æ˜¯ä¸€æ¡ &quot;RPC&quot; å‡½æ•°ï¼Œ&quot;MyUFunction&quot; æ˜¯ä¸€æ¡ &quot;UFunction&quot; ï¼Œ&quot;DECLARE_FUNCTION&quot; å®ä¹Ÿå¾ˆé‡è¦ï¼Œä¸‹æ–‡ä¼šè¯¦ç»†åˆ†æ</p><ul><li><p>&quot;ENHANCED_CONSTRUCTORS&quot;ï¼Œè¯¥å®<strong>å®šä¹‰ ä¸€ä¸ªç”¨äºåå°„ç³»ç»Ÿåˆ›å»ºå¯¹è±¡çš„æ„é€ å‡½æ•°åŒ…è£…å™¨</strong>ï¼Œå› ä¸ºç±»çš„æ„é€ å‡½æ•°ä¸èƒ½ç”¨å‡½æ•°æŒ‡é’ˆæŒ‡å‘ã€‚å…¶å·¥ä½œåŸç†ä¸‹æ–‡ä¼šåˆ†æï¼Œå’±å…ˆçœ‹çœ‹è¿™ä¸ªå®çš„å®ç°ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>ENHANCED_CONSTRUCTORS</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ProjectName_Source_ClassPath_ClassName_h_11_ENHANCED_CONSTRUCTORS \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** ç§»åŠ¨æ‹·è´ç§æœ‰åŒ–ï¼Œä¸åº”è¢«è°ƒç”¨ */</span> \</span></span><br><span class="line"><span class="meta">	NO_API UClassName(UClassName&amp;&amp;); \</span></span><br><span class="line"><span class="meta">	NO_API UClassName(const UClassName&amp;); \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">    <span class="comment">/** çƒ­é‡è½½çš„æ„é€ å‡½æ•°åŠè°ƒç”¨å™¨ */</span> \</span></span><br><span class="line"><span class="meta">	DECLARE_VTABLE_PTR_HELPER_CTOR(NO_API, UClassName); \</span></span><br><span class="line"><span class="meta">DEFINE_VTABLE_PTR_HELPER_CTOR_CALLER(UClassName); \</span></span><br><span class="line"><span class="meta">    <span class="comment">/** å®šä¹‰ä¸€ä¸ªç”¨äºåå°„ç³»ç»Ÿåˆ›å»ºå¯¹è±¡çš„æ„é€ å‡½æ•°åŒ…è£…å™¨ï¼Œæœ€ç»ˆä¼šå­˜åˆ°UClassé‡Œé¢ */</span> \</span></span><br><span class="line"><span class="meta">	DEFINE_DEFAULT_CONSTRUCTOR_CALL(UClassName) </span></span><br></pre></td></tr></table></figure><p></p><p>æ¯æ¡å‡½æ•°éƒ½å†™äº†æ³¨é‡Šï¼Œä¸åšèµ˜è¿°ã€‚</p></li><li><p>&quot;INCLASS_NO_PURE_DECLS&quot;ï¼Œè¯¥å®æ¯”è¾ƒå¤æ‚ï¼Œè€Œä¸”è·Ÿ UClass æ¯æ¯ç›¸å…³ï¼Œå’±å¯¹ç€æºç æ¥è®²</p><p></p><figure class="highlight c++"><figcaption><span>INCLASS_NO_PURE_DECLS</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ProjectName_Source_ClassPath_ClassName_h_11_INCLASS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">	<span class="comment">/* å®šä¹‰åœ¨ &quot;ClassName.gen.cpp&quot; ä¸­ï¼Œç”¨äºå°†å‡½æ•°æ³¨å†Œåˆ° &quot;UClass&quot; çš„å‡½æ•°è¡¨ &quot;NativeFunctionLookupTable&quot; é‡Œé¢ï¼Œåªæ³¨å†Œ &quot;exec&quot; ç‰ˆæœ¬çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯éUFunctionå‡½æ•°å°†ä¸ä¼šè¿›è¡Œæ³¨å†Œï¼Œä¹Ÿä¸æ”¯æŒåå°„åŠŸèƒ½*/</span> \</span></span><br><span class="line"><span class="meta">	static void StaticRegisterNativesUClassName(); \</span></span><br><span class="line"><span class="meta">\</span></span><br><span class="line"><span class="meta">    <span class="comment">/* å®šä¹‰åœ¨ &quot;ClassName.gen.cpp&quot; ä¸­çš„å‹å…ƒç»“æ„ä½“ï¼Œé‡Œé¢æœ‰æ„é€ è¯¥ç±»çš„ &quot;UClass&quot;å’Œ &quot;UPackage&quot; çš„å‡½æ•°æŒ‡é’ˆï¼Œè¿˜æœ‰ä¸€ä¸ªç»“æ„ä½“æ•°ç»„ï¼Œä»¥åŠä¸€äº›ç”Ÿæˆåå°„ä»£ç è¦ç”¨çš„å‚æ•° */</span> \</span></span><br><span class="line"><span class="meta">	friend struct Z_Construct_UClass_UClassName_Statics; \</span></span><br><span class="line"><span class="meta">\</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">    <span class="comment">/* è¯¥å®å®šä¹‰åœ¨ &quot;ObjectMacros.h&quot; ä¸­ï¼Œå†…å®¹å¾ˆå¤šï¼Œå¾ˆé‡è¦ï¼Œä¸‹æ–‡ä»‹ç» */</span> \</span></span><br><span class="line"><span class="meta">	DECLARE_CLASS(UClassName, UObject, COMPILED_IN_FLAGS(0 | CLASS_Config), CASTCLASS_None, TEXT(<span class="meta-string">&quot;/Script/ProjectName&quot;</span>), NO_API) \</span></span><br><span class="line"><span class="meta">\</span></span><br><span class="line"><span class="meta">    <span class="comment">/* è¯¥å®å®šä¹‰åœ¨ &quot;ObjectMacros.h&quot; ä¸­ï¼Œå®šä¹‰ä¸¤ä¸ªå‡½æ•°ä»¥æ”¯æŒåºåˆ—åŒ– */</span> \</span></span><br><span class="line"><span class="meta">	DECLARE_SERIALIZER(UClassName)</span></span><br></pre></td></tr></table></figure><p></p><p>&quot;DECLARE_CLASS&quot; è·Ÿ UClass å…³ç³»å¯†åˆ‡ï¼Œåœ¨å±•å¼€åˆ†æ &quot;DECLARE_CLASS&quot; å®ä¹‹å‰ï¼Œæˆ‘æƒ³æé†’ä¸€ä¸‹è¯»è€…ï¼š</p><blockquote><p>ä»¥ä¸Šçš„å†…å®¹å…¨éƒ¨éƒ½æ˜¯ç”± &quot;UHT&quot; å¸®æˆ‘ä»¬è‡ªåŠ¨å†™åˆ° &quot;ClassName.generated.h&quot; æ–‡ä»¶ä¸­ï¼Œå†é€šè¿‡ &quot;GENERATED_BODY ()&quot; å®æŠŠå®šä¹‰å¥½çš„å†…å®¹å¯¼å…¥åˆ° &quot;ClassName.h&quot; ä¸­çš„ã€‚</p></blockquote><h3 id="declare_class"><a class="anchor" href="#declare_class">#</a> DECLARE_CLASS</h3><p>å…¶å®å®šä¹‰å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>DECLARE_CLASS</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DECLARE_CLASS( TClass, TSuperClass, TStaticFlags, TStaticCastFlags, TPackage, TRequiredAPI  ) \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">	<span class="comment">/* ç§»åŠ¨å¤åˆ¶ç§æœ‰åŒ– */</span> \</span></span><br><span class="line"><span class="meta">    TClass&amp; operator=(TClass&amp;&amp;);   \</span></span><br><span class="line"><span class="meta">    TClass&amp; operator=(const TClass&amp;);   \</span></span><br><span class="line"><span class="meta">    <span class="comment">/* é‡è¦ï¼&quot;StaticClass&quot; å‡½æ•°çš„å†…éƒ¨å®ç°ï¼Œä¸‹æ–‡è¯¦ç»†å±•å¼€ */</span> \</span></span><br><span class="line"><span class="meta">	TRequiredAPI static UClass* GetPrivateStaticClass(); \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">    <span class="comment">/** å±äºæ­¤ç±»çš„ #EClassFlags ä½å¹¶é›†ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ &quot;EClassFlags&quot; */</span> \</span></span><br><span class="line"><span class="meta">	enum &#123;StaticClassFlags=TStaticFlags&#125;; \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** åŸºç±»çš„ &quot;typedef&quot; */</span> \</span></span><br><span class="line"><span class="meta">	typedef TSuperClass Super;\</span></span><br><span class="line"><span class="meta">	<span class="comment">/** è¯¥ç±»çš„ &quot;typedef&quot; */</span> \</span></span><br><span class="line"><span class="meta">	typedef TClass ThisClass;\</span></span><br><span class="line"><span class="meta">    <span class="comment">/** &quot;runtime&quot; ä¸‹è¿”å›å¼•ç”¨è¯¥ç±»çš„ &quot;UClass&quot; å¯¹è±¡ */</span> \</span></span><br><span class="line"><span class="meta">	inline static UClass* StaticClass() \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		return GetPrivateStaticClass(); \</span></span><br><span class="line"><span class="meta">	&#125; \</span></span><br><span class="line"><span class="meta">    <span class="comment">/** è¿”å›è¯¥ç±»æ‰€å±çš„åŒ… */</span> \</span></span><br><span class="line"><span class="meta">	inline static const TCHAR* StaticPackage() \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		return TPackage; \</span></span><br><span class="line"><span class="meta">	&#125; \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** Returns the static cast flags for this class */</span> \</span></span><br><span class="line"><span class="meta">    <span class="comment">/** è¿”å›è¯¥ç±»çš„ &quot;StaticCastFlags&quot;ï¼Œç”¨äºæ£€éªŒæ˜¯å¦ &quot;Cast&quot; æˆåŠŸ */</span> \</span></span><br><span class="line"><span class="meta">	inline static EClassCastFlags StaticClassCastFlags() \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		return TStaticCastFlags; \</span></span><br><span class="line"><span class="meta">	&#125; \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** ä»…é™å†…éƒ¨ä½¿ç”¨ï¼Œå¤–éƒ¨å¯ä»¥ä½¿ç”¨ &quot;StaticConstructObject&quot; å‡½æ•°æ¥newå¯¹è±¡ */</span> \</span></span><br><span class="line"><span class="meta">	inline void* operator new(const size_t InSize, EInternal InInternalOnly, UObject* InOuter = (UObject*)GetTransientPackage(), FName InName = NAME_None, EObjectFlags InSetFlags = RF_NoFlags) \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		return StaticAllocateObject(StaticClass(), InOuter, InName, InSetFlags); \</span></span><br><span class="line"><span class="meta">	&#125; \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** ä»…é™å†…éƒ¨ä½¿ç”¨ï¼Œå¤–éƒ¨å¯ä»¥ä½¿ç”¨ &quot;StaticConstructObject&quot; å‡½æ•°æ¥newå¯¹è±¡ */</span> \</span></span><br><span class="line"><span class="meta">	inline void* operator new( const size_t InSize, EInternal* InMem ) \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		return (void*)InMem; \</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br></pre></td></tr></table></figure><p></p><p>åˆ°æ­¤ï¼Œ&quot;GENERATED_BODY ()&quot; å®å®šä¹‰ç”Ÿæˆçš„ä»£ç å·²ç»å…¨éƒ¨ç®€å•ä»‹ç»äº†ä¸€éã€‚ä¸Šé¢å®šä¹‰çš„å¾ˆå¤šå‡½æ•°ï¼Œåœ¨æˆ‘ä»¬åé¢ &quot;UClass&quot; çš„ æ”¶é›†å’Œæ³¨å†Œ ä¸­éƒ½ä¼šç”¨åˆ°ã€‚</p></li></ul><hr><h2 id="å›åˆ°uclassçš„æ„é€ "><a class="anchor" href="#å›åˆ°uclassçš„æ„é€ ">#</a> å›åˆ° UClass çš„æ„é€ </h2><p>ue å°† &quot;UClass&quot; çš„æ„é€ åˆ†æˆäº†å‡ ä¸ªéƒ¨åˆ†ï¼Œå¤§è‡´å¯ä»¥æ€»ç»“ä¸ºï¼š<strong>æ”¶é›†</strong>ï¼Œ<strong>æ³¨å†Œ</strong>ï¼Œ<strong>å»¶è¿Ÿæ³¨å†Œ</strong>ï¼Œ<strong>åå¤„ç†</strong>ã€‚</p><ul><li>æ”¶é›†ï¼šæ”¶é›†è¿™ä¸ªç±»çš„ä¿¡æ¯ï¼Œå¦‚ï¼šç±»åï¼ŒSizeï¼ŒCrc ç­‰</li><li>æ³¨å†Œï¼šä¸º &quot;UClass&quot; åˆ†é…å†…å­˜ï¼Œå¯¹å…¶è¿›è¡Œæ„é€ ï¼Œå¹¶åˆå§‹åŒ–å…¶å¤§éƒ¨åˆ†å±æ€§ï¼Œæœ€åæ·»åŠ åˆ°å»¶è¿Ÿå¤„ç†çš„ TMap é‡Œ</li><li>å»¶è¿Ÿæ³¨å†Œï¼šä¸º &quot;UClass&quot; è®¾ç½®æ‰€å±åŒ…åå’ŒåŒ…æ ‡è®°ï¼Œå°†å…¶æ³¨å†Œåˆ°å…¨å±€çš„ &quot;FUObjectHashTables&quot; ä¸­</li><li>åå¤„ç†ï¼šä¸º &quot;UClass&quot; ç”Ÿæˆ &quot;CDO&quot;ï¼Œ&quot;TokenStream&quot; ç­‰ï¼ˆ<strong>ç§°å…¶ä¸ºåå¤„ç†ï¼Œåªæ˜¯å› ä¸ºè¿™éƒ¨åˆ†æ˜¯åœ¨ PreInit çš„ååŠéƒ¨åˆ†è¿›è¡Œçš„ï¼Œä¸”ä¾¿äºç†è§£ï¼Œä½†å¼•æ“é‡Œé¢è¿™éƒ¨åˆ†ä¹Ÿæ˜¯ç»Ÿä¸€ç§°ä¸ºæ³¨å†Œçš„ã€‚</strong></li></ul><p>å¯èƒ½è¿™ä¹ˆè¯´è¿˜æ˜¯æœ‰ç‚¹æŠ½è±¡ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹å¼•æ“çš„å¯åŠ¨æµç¨‹å›¾ï¼ˆå¼•è‡ª<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81NzYxMTEzNw=="> InsideUE4</span>ï¼‰ï¼Œå†æ¥åˆ†æéƒ½æ˜¯ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆå§ ğŸ˜ƒ</p><p><img data-src="%E5%BC%95%E6%93%8E%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%9B%BE.jpg" alt="å¼•æ“å¯åŠ¨æµç¨‹å›¾"></p><h3 id="uclassçš„ä¿¡æ¯æ”¶é›†"><a class="anchor" href="#uclassçš„ä¿¡æ¯æ”¶é›†">#</a> UClass çš„ä¿¡æ¯æ”¶é›†</h3><p>æ”¶é›†é˜¶æ®µæ˜¯åœ¨ <strong>&quot;Static åˆå§‹åŒ–&quot;</strong>ä¸­å®Œæˆçš„ï¼Œå¼•æ“åªä¼šå»æ”¶é›†æˆ‘ä»¬å†&quot;Build.cs&quot; æ–‡ä»¶ä¸­æ‰€ä¾èµ–çš„æ¨¡å—çš„ç±»ã€‚æ‰€ä»¥ä¸ç”¨æ‹…å¿ƒæ²¡å¯ç”¨çš„æ¨¡å—ä¹Ÿä¼šè¢«æ”¶é›†ï¼Œä»è€Œå¢åŠ æ— ç”¨çš„æ€§èƒ½æ¶ˆè€—çš„é—®é¢˜</p><p></p><figure class="highlight c++"><figcaption><span>æ”¶é›†</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyClassName.gen.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®å®šä¹‰åœ¨ &quot;ObjectMacros&quot; ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç”¨äºæ”¶é›† &quot;UClass&quot; ä¿¡æ¯çš„å…¨å±€é™æ€å¯¹è±¡ &quot;AutoInitialize##TClass&quot; å’Œä¸€ä¸ªç”¨äºæ³¨å†Œçš„å‡½æ•° &quot;TClass::GetPrivateStaticClass&quot;ï¼Œæ”¶é›†é˜¶æ®µæˆ‘ä»¬åªéœ€è¦å…³æ³¨å…¨å±€é™æ€å¯¹è±¡ï¼Œå› ä¸ºå…¨å±€é™æ€å˜é‡ä¼šåœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œç›´æ¥è°ƒç”¨å…¶æ„é€ å‡½æ•°ï¼Œå®Œæˆè¯¥ç±»çš„ &quot;UClass&quot; ä¿¡æ¯æ”¶é›†ã€‚è¿™ä¸€æ­¥ä¸»è¦æ”¶é›†: ç±»åï¼ŒSizeï¼ŒCrcç­‰</span></span><br><span class="line"><span class="built_in">IMPLEMENT_CLASS</span>(UClassName, <span class="number">2305906519</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¶é›†è¯¥ç±»çš„ &quot;UClass&quot; çš„æ„é€ å‡½æ•°ï¼Œå¹¶å­˜åˆ°å…¨å±€é™æ€TArray &quot;DeferredCompiledInRegistration&quot; ä¸­</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> FCompiledInDefer <span class="title">Z_CompiledInDefer_UClass_UMyClassName</span><span class="params">(Z_Construct_UClass_UMyClassName, &amp;UMyClassName::StaticClass, TEXT(<span class="string">&quot;/Script/ProjectName&quot;</span>), TEXT(<span class="string">&quot;UMyClassName&quot;</span>), <span class="literal">false</span>, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>)</span></span>;</span><br></pre></td></tr></table></figure><p></p><p>ä»¥ä¸‹å¯¹ä¸Šé¢ä¸¤ä¸ªå®å…·ä½“å±•å¼€</p><h4 id="implement_class"><a class="anchor" href="#implement_class">#</a> IMPLEMENT_CLASS</h4><p></p><figure class="highlight c++"><figcaption><span>IMPLEMENT_CLASS</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ObjectMacros.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMPLEMENT_CLASS(TClass, TClassCrc) \</span></span><br><span class="line"><span class="meta">	<span class="comment">/* æ”¶é›† &quot;UClass&quot; çš„ &quot;Size&quot; ç­‰å±æ€§çš„é™æ€å¯¹è±¡ */</span> \</span></span><br><span class="line"><span class="meta">	static TClassCompiledInDefer<span class="meta-string">&lt;TClass&gt;</span> AutoInitialize##TClass(TEXT(#TClass), sizeof(TClass), TClassCrc); \</span></span><br><span class="line"><span class="meta">	</span></span><br><span class="line">	<span class="comment">/* çœç•¥&quot;GetPrivateStaticClass&quot; å‡½æ•°ï¼Œç•™åˆ°æ³¨å†Œé˜¶æ®µåˆ†æ */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> TClass&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TClassCompiledInDefer</span> :</span> <span class="keyword">public</span> FFieldCompiledInInfo</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">TClassCompiledInDefer</span>(<span class="keyword">const</span> TCHAR* InName, SIZE_T InClassSize, uint32 InCrc)</span><br><span class="line">	: <span class="built_in">FFieldCompiledInInfo</span>(InClassSize, InCrc)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">UClassCompiledInDefer</span>(<span class="keyword">this</span>, InName, InClassSize, InCrc);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/* &quot;Register&quot; å’Œ &quot;ClassPackage&quot; å‡½æ•°ç•™åˆ°æ³¨å†Œé˜¶æ®µåˆ†æ */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UClassCompiledInDefer</span><span class="params">(FFieldCompiledInInfo* ClassInfo, <span class="keyword">const</span> TCHAR* Name, SIZE_T ClassSize, uint32 Crc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">const</span> FName CPPClassName = Name;</span><br><span class="line">    <span class="comment">// è¿™é‡Œçœç•¥ä¸€æ®µ &quot;HotLoad&quot; å¤„ç†ä»£ç </span></span><br><span class="line">	<span class="built_in">GetDeferredClassRegistration</span>().<span class="built_in">Add</span>(ClassInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> TArray&lt;FFieldCompiledInInfo*&gt;&amp; <span class="title">GetDeferredClassRegistration</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> TArray&lt;FFieldCompiledInInfo*&gt; DeferredClassRegistration;</span><br><span class="line">	<span class="keyword">return</span> DeferredClassRegistration;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FFieldCompiledInInfo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="built_in">FFieldCompiledInInfo</span>(SIZE_T InClassSize, uint32 InCrc)</span><br><span class="line">		: <span class="built_in">Size</span>(InClassSize)</span><br><span class="line">		, <span class="built_in">Crc</span>(InCrc)</span><br><span class="line">		, <span class="built_in">OldClass</span>(<span class="literal">nullptr</span>)</span><br><span class="line">		, <span class="built_in">bHasChanged</span>(<span class="literal">false</span>)</span><br><span class="line">	&#123;	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p></p><p>æ˜¾è€Œæ˜“è§ï¼Œ&quot;IMPLEMENT_CLASS&quot; å® å®é™…ä¸Šå°±æ˜¯å†å¾€ &quot;DeferredClassRegistration&quot; é™æ€æ•°ç»„é‡Œé¢ Add ä¸€ä¸ªè®°å½•äº†è¯¥ç±»ä¿¡æ¯çš„ &quot;FFieldCompiledInInfo&quot; ç»“æ„ä½“ï¼Œè¿™ä¸ªç»“æ„ä½“è®°å½•çš„æ•°æ®æ¯”è¾ƒå°‘ï¼Œåªç”¨äº &quot;æ³¨å†Œ&quot; é˜¶æ®µã€‚</p><h4 id="z_compiledindefer_uclass_umyclassname"><a class="anchor" href="#z_compiledindefer_uclass_umyclassname">#</a> Z_CompiledInDefer_UClass_UMyClassName</h4><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UMyClassName.gen.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;FCompiledInDefer&quot; æ˜¯ç”¨æ¥æ”¶é›† &quot;UClass&quot; ä¿¡æ¯çš„ç±»ï¼Œåˆ©ç”¨å…¨å±€é™æ€å¯¹è±¡åœ¨ç¨‹åºå¯åŠ¨æ—¶å°±ä¼šè‡ªåŠ¨è¿›è¡Œæ„é€ çš„ç‰¹æ€§ï¼Œè°ƒç”¨å…¶æ„é€ å‡½æ•°æ¥æ”¶é›†ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> FCompiledInDefer <span class="title">Z_CompiledInDefer_UClass_UMyClassName</span><span class="params">(Z_Construct_UClass_UMyClassName, &amp;UMyClassName::StaticClass, TEXT(<span class="string">&quot;/Script/ProjectName&quot;</span>), TEXT(<span class="string">&quot;UMyClassName&quot;</span>), <span class="literal">false</span>, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FCompiledInDefer</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="built_in">FCompiledInDefer</span>(class UClass *(*InRegister)(), class UClass *(*InStaticClass)(), <span class="keyword">const</span> TCHAR* PackageName, <span class="keyword">const</span> TCHAR* Name, <span class="keyword">bool</span> bDynamic, <span class="keyword">const</span> TCHAR* DynamicPackageName = <span class="literal">nullptr</span>, <span class="keyword">const</span> TCHAR* DynamicPathName = <span class="literal">nullptr</span>, <span class="built_in"><span class="keyword">void</span></span> (*InInitSearchableValues)(TMap&lt;FName, FName&gt;&amp;) = <span class="literal">nullptr</span>)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">// æ˜¯å¦æ­£åœ¨ç¼–è¯‘åŠ¨æ€ç±»</span></span><br><span class="line">		<span class="keyword">if</span> (bDynamic)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">GetConvertedDynamicPackageNameToTypeName</span>().<span class="built_in">Add</span>(<span class="built_in">FName</span>(DynamicPackageName), <span class="built_in">FName</span>(Name));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">UObjectCompiledInDefer</span>(InRegister, InStaticClass, Name, PackageName, bDynamic, DynamicPathName, InInitSearchableValues);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UObjectCompiledInDefer</span><span class="params">(UClass *(*InRegister)(), UClass *(*InStaticClass)(), <span class="keyword">const</span> TCHAR* Name, <span class="keyword">const</span> TCHAR* PackageName, <span class="keyword">bool</span> bDynamic, <span class="keyword">const</span> TCHAR* DynamicPathName, <span class="keyword">void</span> (*InInitSearchableValues)(TMap&lt;FName, FName&gt;&amp;))</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!bDynamic)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">/* çœç•¥çƒ­é‡è½½ä»£ç  */</span></span><br><span class="line">        <span class="comment">// ç”¨è¯¥ &quot;UClass&quot; çš„ &quot;Z_Construct&quot; å‡½æ•°ç”Ÿæˆä¸€ä¸ª &quot;FEDLBootObjectState&quot; è®¾ç½®å…¶å±æ€§åï¼Œå­˜åˆ° &quot;PathToState&quot; ä¸­ï¼Œç”¨äºå¼‚æ­¥åŒ…è¯»å–</span></span><br><span class="line">        <span class="function">FString <span class="title">NoPrefix</span><span class="params">(UObjectBase::RemoveClassPrefix(Name))</span></span>;</span><br><span class="line">        <span class="built_in">NotifyRegistrationEvent</span>(PackageName, *NoPrefix, ENotifyRegistrationType::NRT_Class, ENotifyRegistrationPhase::NRP_Added, (UObject *(*)())(InRegister), <span class="literal">false</span>);</span><br><span class="line">        <span class="built_in">NotifyRegistrationEvent</span>(PackageName, *(<span class="built_in">FString</span>(DEFAULT_OBJECT_PREFIX) + NoPrefix), ENotifyRegistrationType::NRT_ClassCDO, ENotifyRegistrationPhase::NRP_Added, (UObject *(*)())(InRegister), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¾€ &quot;DeferredCompiledInRegistration&quot; é™æ€æ•°ç»„(å•ä¾‹)ä¸­æ·»åŠ å’±çš„ &quot;UClass&quot; çš„ &quot;Z_Construct&quot; å‡½æ•°</span></span><br><span class="line">        TArray&lt;UClass *(*)()&gt;&amp; DeferredCompiledInRegistration = <span class="built_in">GetDeferredCompiledInRegistration</span>();</span><br><span class="line">        <span class="built_in">checkSlow</span>(!DeferredCompiledInRegistration.<span class="built_in">Contains</span>(InRegister));</span><br><span class="line">        DeferredCompiledInRegistration.<span class="built_in">Add</span>(InRegister);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/* çœç•¥ç¼–è¯‘åŠ¨æ€ç±»ä»£ç  */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªé™æ€å…¨å±€å˜é‡ å°† &quot;UClass&quot; çš„ &quot;Z_Construct&quot; å‡½æ•° (ç”¨äºåˆå§‹åŒ–ä¸€äº› &quot;UClass&quot; çš„å±æ€§ï¼Œä½†åˆä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æ„é€ å‡½æ•°) å’Œ &quot;PackageName&quot; æ·»åŠ åˆ°å¼‚æ­¥åŒ…åŠ è½½çš„ &quot;FEDLBootObjectManager&quot; ä¸­ï¼Œå†å°† &quot;UClass&quot; çš„ &quot;Z_Construct&quot; å‡½æ•°æ·»åŠ åˆ° &quot;DeferredCompiledInRegistration&quot; é™æ€æ•°ç»„ä¸­ï¼Œç”¨äºåé¢ &quot;UClass&quot; æ„é€ ã€‚</p><p>ä¸çŸ¥é“è¯»è€…æ˜¯å¦å¯¹ &quot;UClass&quot; çš„ &quot;Z_Construct&quot; å‡½æ•°æ˜¯æ€ä¹ˆå®šä¹‰çš„æ„Ÿå…´è¶£ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå® &quot;Z_Construct_UClass_UMyClassName&quot; çš„å®šä¹‰ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨æœ€åçš„ &quot;åå¤„ç†é˜¶æ®µ&quot; è¢«è°ƒç”¨ï¼Œå…ˆåˆ†æä¸€ä¸‹å…¶å®ç°ï¼š</p><h4 id="z_construct_uclass_umyclassname"><a class="anchor" href="#z_construct_uclass_umyclassname">#</a> Z_Construct_UClass_UMyClassName</h4><p></p><figure class="highlight c++"><figcaption><span>Z_Construct_UClass_UMyClassName</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyClassName.gen.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function">UClass* <span class="title">Z_Construct_UClass_UMyClassName</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> UClass* OuterClass = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">if</span> (!OuterClass)</span><br><span class="line">    &#123;</span><br><span class="line">        UE4CodeGen_Private::<span class="built_in">ConstructUClass</span>(OuterClass, Z_Construct_UClass_UMyClassName_Statics::ClassParams);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> OuterClass;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>çœ‹ä¼¼ç®€å•ï¼Œåªæ˜¯å¯¹ä¸€ä¸ªå•ä¾‹ &quot;UClass&quot; å¯¹è±¡è¿›è¡Œæ„é€ åå¤„ç†è€Œå·²ï¼Œä½†å…¶å®é‡Œé¢åˆ«æœ‰æ´å¤©ã€‚å…¶ä¸­ &quot;ConstructUClass&quot; å°†å¤„ç†æˆ‘ä»¬ &quot;UClass&quot; çš„å¾ˆå¤šå±æ€§çš„åˆå§‹åŒ–ï¼Œè€Œ &quot;ClassParams&quot; åˆæ˜¯ä¸€ä¸ªå­˜ç€æˆ‘ä»¬è¿™ä¸ªç±»æ‰€æœ‰å±æ€§çš„ä¸€ä¸ªç»“æ„ä½“ã€‚</p><h4 id="constructuclass"><a class="anchor" href="#constructuclass">#</a> ConstructUClass</h4><p></p><figure class="highlight c++"><figcaption><span>ConstructUClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectGlobals.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConstructUClass</span><span class="params">(UClass*&amp; OutClass, <span class="keyword">const</span> FClassParams&amp; Params)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è¯¥ç±»å¯¹è±¡å­˜åœ¨ï¼Œä¸”å·²æ„é€ åˆ™ç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> (OutClass &amp;&amp; (OutClass-&gt;ClassFlags &amp; CLASS_Constructed))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œæ‰€æœ‰ä¾èµ–å‡½æ•°(ä¸»è¦æ˜¯åŸºç±»çš„ &quot;UClass&quot; çš„æ„é€ å‡½æ•°å’Œ &quot;UPackage&quot; çš„æ„é€ å‡½æ•°)ï¼Œè¿­ä»£å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">for</span> (UObject* (*<span class="keyword">const</span> *SingletonFunc)() = Params.DependencySingletonFuncArray, *(*<span class="keyword">const</span> *SingletonFuncEnd)() = SingletonFunc + Params.NumDependencySingletons; SingletonFunc != SingletonFuncEnd; ++SingletonFunc)</span><br><span class="line">    &#123;</span><br><span class="line">        (*SingletonFunc)();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®é™…ä¸Šè°ƒç”¨çš„æ˜¯è¯¥ç±»çš„ &quot;StaticClass&quot; å‡½æ•°ï¼Œ&quot;StaticClass&quot; å¹¶ä¸ä¼šåˆå§‹åŒ–å±æ€§é“¾</span></span><br><span class="line">    UClass* NewClass = Params.<span class="built_in">ClassNoRegisterFunc</span>();</span><br><span class="line">    OutClass = NewClass;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (NewClass-&gt;ClassFlags &amp; CLASS_Constructed)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &quot;UClass&quot; çš„æ³¨å†Œå‡½æ•°ï¼Œåæ–‡è¯¦ç»†ä»‹ç»</span></span><br><span class="line">    <span class="built_in">UObjectForceRegistration</span>(NewClass);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½® &quot;ClassFlags&quot;ï¼Œç”¨äºåŠ¨æ€ç±»å‹è½¬æ¢</span></span><br><span class="line">    UClass* SuperClass = NewClass-&gt;<span class="built_in">GetSuperClass</span>();</span><br><span class="line">    <span class="keyword">if</span> (SuperClass)</span><br><span class="line">    &#123;</span><br><span class="line">        NewClass-&gt;ClassFlags |= (SuperClass-&gt;ClassFlags &amp; CLASS_Inherit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ‡è®°ä¸Šä¹‹å‰å­˜åœ¨ &quot;Params&quot; é‡Œçš„æ ‡è®°å’Œ &quot;CLASS_Constructed&quot; æ ‡è®°</span></span><br><span class="line">    NewClass-&gt;ClassFlags |= (EClassFlags)(Params.ClassFlags | CLASS_Constructed);</span><br><span class="line">    <span class="comment">// æ¸…ç©ºå¼•ç”¨æ ‡è®°æµï¼Œå› ä¸ºè¦åœ¨åé¢é‡æ„ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> ((NewClass-&gt;ClassFlags &amp; CLASS_Intrinsic) != CLASS_Intrinsic)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">check</span>((NewClass-&gt;ClassFlags &amp; CLASS_TokenStreamAssembled) != CLASS_TokenStreamAssembled);</span><br><span class="line">        NewClass-&gt;ReferenceTokenStream.<span class="built_in">Empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å°†ä¹‹å‰ç”¨ &quot;ConstructUFunction&quot; æ„é€ å‡ºæ¥çš„å‡½æ•°é“¾æ¥èµ·æ¥ï¼Œæ”¾åˆ° &quot;Children&quot;(UPropertyå±æ€§é“¾)é‡Œé¢</span></span><br><span class="line">    NewClass-&gt;<span class="built_in">CreateLinkAndAddChildFunctionsToMap</span>(Params.FunctionLinkArray, Params.NumFunctions);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ è¯¥ç±»çš„æ‰€æœ‰ &quot;FProperty&quot;ï¼Œç”¨äºåé¢çš„ &quot;StaticLink&quot;</span></span><br><span class="line">    <span class="built_in">ConstructFProperties</span>(NewClass, Params.PropertyArray, Params.NumProperties);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– &quot;UClass&quot; çš„ &quot;ClassConfigName&quot; å±æ€§ (è¯¥ç±»å¯¹è±¡è¯»å–æ•°æ®çš„é…ç½®æ–‡ä»¶å)</span></span><br><span class="line">    <span class="keyword">if</span> (Params.ClassConfigNameUTF8)</span><br><span class="line">    &#123;</span><br><span class="line">        NewClass-&gt;ClassConfigName = <span class="built_in">FName</span>(<span class="built_in">UTF8_TO_TCHAR</span>(Params.ClassConfigNameUTF8));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– &quot;CppClassInfo&quot; å±æ€§ (æ˜¯å¦æŠ½è±¡ç±»)</span></span><br><span class="line">    NewClass-&gt;<span class="built_in">SetCppTypeInfoStatic</span>(Params.CppClassInfo);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– &quot;UClass&quot; çš„ &quot;Interfaces&quot; æ•°ç»„ï¼ŒåŒ…æ‹¬è¯¥ &quot;Interface&quot; çš„ &quot;UClass&quot;ï¼Œå†…å­˜åç§»ï¼Œæ˜¯å¦è¢«è“å›¾é‡å†™</span></span><br><span class="line">    <span class="keyword">if</span> (int32 NumImplementedInterfaces = Params.NumImplementedInterfaces)</span><br><span class="line">    &#123;</span><br><span class="line">        NewClass-&gt;Interfaces.<span class="built_in">Reserve</span>(NumImplementedInterfaces);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> FImplementedInterfaceParams* ImplementedInterface = Params.ImplementedInterfaceArray, *ImplementedInterfaceEnd = ImplementedInterface + NumImplementedInterfaces; ImplementedInterface != ImplementedInterfaceEnd; ++ImplementedInterface)</span><br><span class="line">        &#123;</span><br><span class="line">            UClass* (*ClassFunc)() = ImplementedInterface-&gt;ClassFunc;</span><br><span class="line">            UClass* InterfaceClass = ClassFunc ? <span class="built_in">ClassFunc</span>() : <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">            NewClass-&gt;Interfaces.<span class="built_in">Emplace</span>(InterfaceClass, ImplementedInterface-&gt;Offset, ImplementedInterface-&gt;bImplementedByK2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ å…ƒæ•°æ®</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">if</span> WITH_METADATA</span></span><br><span class="line">    <span class="built_in">AddMetaData</span>(NewClass, Params.MetaDataArray, Params.NumMetaData);</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™æ€é“¾æ¥ï¼Œä¸å±•å¼€ã€‚åœ¨è§£æ &quot;FProperty&quot; çš„åšå®¢ä¸­å†åšè¯¦ç»†è§£æ</span></span><br><span class="line">    NewClass-&gt;<span class="built_in">StaticLink</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è¯¥ç±»çš„å¯¹è±¡å…±æœ‰æ•°æ® &quot;SparseClassData&quot;ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸å¯ä¿®æ”¹</span></span><br><span class="line">    NewClass-&gt;<span class="built_in">SetSparseClassDataStruct</span>(NewClass-&gt;<span class="built_in">GetSparseClassDataArchetypeStruct</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>è¿™ä¸€æ­¥æ˜¯åœ¨ &quot;UClass&quot; æ³¨å†Œçš„åå¤„ç†é˜¶æ®µè¿›è¡Œçš„ï¼ˆåˆ›å»º &quot;CDO&quot; ä¹‹å‰ï¼‰ï¼Œä¸ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ä¸€å¼€å§‹å°±è°ƒç”¨è¿™ä¸ªåˆå§‹åŒ–å’±çš„ &quot;UClass&quot; ï¼Ÿå…¶å®æ˜¯å› ä¸º &quot;FClassParams&quot; é‡Œé¢å¾ˆå¤šå‚æ•°éƒ½æ²¡æœ‰æ„é€ ï¼Œæ¯”å¦‚ &quot;UFunction&quot; å’Œ &quot;FProperty&quot; çš„æ„é€ ï¼Œå°±æ˜¯åœ¨å»¶è¿Ÿæ³¨å†Œä¸­è¿›è¡Œçš„ã€‚æ‰€ä»¥å’±åªèƒ½ç­‰åˆ°åå¤„ç†é˜¶æ®µï¼Œå‚æ•°éƒ½æ„é€ å¥½äº†æ‰èƒ½è°ƒç”¨ã€‚ä»¥ä¸‹æ˜¯ &quot;FClassParams&quot; çš„å®šä¹‰ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>FClassParams</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectGlobals.h</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FClassParams</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// &quot;UClass&quot; çš„æ„é€ å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">    UClass*                                   (*ClassNoRegisterFunc)();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é…ç½®æ–‡ä»¶åç§°</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>*                                 ClassConfigNameUTF8;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Cppç±»çš„ç±»å‹ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">const</span> FCppClassTypeInfoStatic*              CppClassInfo;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¾èµ– &quot;UObject&quot; çš„æ„é€ å‡½æ•°ï¼Œé€šå¸¸æ˜¯åŸºç±»å’ŒåŒ…</span></span><br><span class="line">    UObject*                           (*<span class="keyword">const</span> *DependencySingletonFuncArray)();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å­˜ç€è¯¥ç±»æ‰€æœ‰ &quot;UFunction&quot; åœ°å€å’Œå‡½æ•°åçš„æ˜ å°„çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">const</span> FClassFunctionLinkInfo*               FunctionLinkArray;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å­˜ç€è¯¥ç±»æ‰€æœ‰ &quot;FProperty&quot; çš„ &quot;FPropertyParamBase&quot; ä¿¡æ¯çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">const</span> FPropertyParamsBase* <span class="keyword">const</span>*           PropertyArray;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å­˜ç€è¯¥ç±»æ‰€æœ‰ &quot;UInterface&quot; çš„ &quot;FImplementedInterfaceParams&quot; ä¿¡æ¯çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">const</span> FImplementedInterfaceParams*          ImplementedInterfaceArray;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¾èµ– â€œUObject&quot; ä¸ªæ•°</span></span><br><span class="line">    int32                                       NumDependencySingletons;</span><br><span class="line">    <span class="comment">// &quot;UFunction&quot; ä¸ªæ•°</span></span><br><span class="line">    int32                                       NumFunctions;</span><br><span class="line">    <span class="comment">// â€œUProperty&quot; ä¸ªæ•°</span></span><br><span class="line">    int32                                       NumProperties;</span><br><span class="line">    <span class="comment">// ç»§æ‰¿ &quot;UInterface&quot; ä¸ªæ•°</span></span><br><span class="line">    int32                                       NumImplementedInterfaces;</span><br><span class="line">    <span class="comment">// EClassFlags</span></span><br><span class="line">    uint32                                      ClassFlags;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> WITH_METADATA</span></span><br><span class="line">    <span class="comment">// å­˜ç€è¯¥ç±»æ‰€æœ‰çš„ &quot;MetaData&quot; æ•°æ®çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">const</span> FMetaDataPairParam*                   MetaDataArray;</span><br><span class="line">    <span class="comment">// &quot;MetaData&quot; ä¸ªæ•°</span></span><br><span class="line">    int32                                       NumMetaData;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p></p><p>å¯¹ä¸Šé¢çš„å†…å®¹å¦‚æœæœ‰ä¸æ¸…æ™°å…¶å®ä¹Ÿæ²¡å…³ç³»ï¼Œä¸å½±å“åæ–‡ç†è§£ã€‚æˆ‘ä»¬åªè¦åœ¨è¯»åˆ°åå¤„ç†é˜¶æ®µçš„æ—¶å€™å†å›æ¥çœ‹çœ‹å°±å¥½äº† ğŸ˜ƒ</p><p>æ€»ç»“ï¼šé€šè¿‡ç±»æ”¶é›†é˜¶æ®µï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸¤ä¸ªæ•°ç»„ã€‚</p><ul><li>&quot;DeferredClassRegistration&quot; -&gt; è®°å½•äº†æ‰€æœ‰éœ€è¦æ³¨å†Œçš„ç±»çš„ &quot;ç±»å&quot;ï¼Œ&quot;Size&quot;ï¼Œ&quot;Crc&quot;</li><li>&quot;DeferredCompiledInRegistration&quot; -&gt; è®°å½•äº†æ‰€æœ‰ç±»çš„ &quot;UClass&quot; çš„æ„é€ å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºç”¨äºæ³¨å†Œå‡½æ•°</li></ul><h3 id="uclassçš„æ³¨å†Œ"><a class="anchor" href="#uclassçš„æ³¨å†Œ">#</a> UClass çš„æ³¨å†Œ</h3><p>&quot;UClass&quot; çš„æ³¨å†Œæ˜¯é›†ä¸­åœ¨ &quot;<strong>UClassRegisterAllCompiledInClasses</strong>&quot; ä¸­è¿›è¡Œçš„ï¼Œä»¥ä¸‹æ˜¯å…¶è°ƒç”¨é“¾ï¼š</p><p></p><figure class="highlight c++"><figcaption><span>FEngineLoop::PreInit</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">WinMain</span>() -&gt; <span class="built_in">GuardedMain</span>() -&gt; <span class="built_in">EnginePreInit</span>() -&gt; FEngineLoop::<span class="built_in">PreInit</span>() -&gt; <span class="built_in">PreInitPreStartupScreen</span>() -&gt; <span class="built_in">LoadCoreModules</span>() -&gt; FModuleManager::<span class="built_in">Get</span>().<span class="built_in">LoadModule</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;CoreUObject&quot;</span>)) -&gt; FModuleManager::<span class="built_in">LoadModuleWithFailureReason</span>() -&gt; StartupModule -&gt; <span class="built_in">UClassRegisterAllCompiledInClasses</span>()</span><br></pre></td></tr></table></figure><p></p><p>æ˜¯ä¸æ˜¯å¾ˆé•¿ï¼Ÿæ²¡é”™ï¼Œå°±æ˜¯å¾ˆé•¿ã€‚ä½†ä¸Šé¢çš„æ¥å£å…¶å®å¤„ç†çš„äº‹æƒ…è¿œè¿œä¸æ­¢ &quot;æ„é€  UClass&quot;ï¼Œè¿˜åˆå§‹åŒ–äº†å¾ˆå¤š Managerï¼Œè®¾ç½®æ¸¸æˆçº¿ç¨‹ï¼ŒåŠ è½½ CoreModules ç­‰ç­‰ã€‚æˆ‘ä»¬ &quot;UClass&quot; çš„æ³¨å†Œå…¶å®åªæ˜¯å†°å±±ä¸€è§’ã€‚åƒé‡Œä¹‹è¡Œå§‹äºè¶³ä¸‹ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹ &quot;UClassRegisterAllCompiledInClasses&quot; é‡Œé¢éƒ½åšäº†ä»€ä¹ˆå§ ï¼‰</p><h4 id="uclassregisterallcompiledinclasses"><a class="anchor" href="#uclassregisterallcompiledinclasses">#</a> UClassRegisterAllCompiledInClasses</h4><p></p><figure class="highlight c++"><figcaption><span>UClassRegisterAllCompiledInClasses</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectBase.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UClassRegisterAllCompiledInClasses</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰æ”¶é›†é˜¶æ®µæ”¶é›†åˆ°çš„éœ€è¦æ³¨å†Œçš„ &quot;UClass&quot; çš„ä¿¡æ¯ï¼Œå¹¶è°ƒç”¨å…¶ &quot;Register&quot; å‡½æ•°è¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">	TArray&lt;FFieldCompiledInInfo*&gt;&amp; DeferredClassRegistration = <span class="built_in">GetDeferredClassRegistration</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> FFieldCompiledInInfo* Class : DeferredClassRegistration)</span><br><span class="line">	&#123;</span><br><span class="line">		UClass* RegisteredClass = Class-&gt;<span class="built_in">Register</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ¸…ç©ºæ•°ç»„ï¼Œä»¥å…é‡å¤æ³¨å†Œ</span></span><br><span class="line">	DeferredClassRegistration.<span class="built_in">Empty</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> TClass&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TClassCompiledInDefer</span> :</span> <span class="keyword">public</span> FFieldCompiledInInfo</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> UClass* <span class="title">Register</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨ &quot;StaticClass&quot;ï¼Œè¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">		<span class="keyword">return</span> TClass::<span class="built_in">StaticClass</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ObjectMacros.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMPLEMENT_CLASS(TClass, TClassCrc) \</span></span><br><span class="line"><span class="meta">	UClass* TClass::GetPrivateStaticClass() \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		static UClass* PrivateStaticClass = NULL; \</span></span><br><span class="line"><span class="meta">		<span class="meta-keyword">if</span> (!PrivateStaticClass) \</span></span><br><span class="line"><span class="meta">		&#123; \</span></span><br><span class="line"><span class="meta">			<span class="comment">/* è¿™é‡Œå¯ä»¥ç”¨æ¨¡æ¿ï¼Œä½†ä¸ºäº†é¿å…ä»£ç å†—ä½™ï¼Œå°±å°†å…¶å®šä¹‰åœ¨äº† &quot;ObjectMacros&quot; é‡Œé¢ */</span> \</span></span><br><span class="line"><span class="meta">			GetPrivateStaticClassBody( \</span></span><br><span class="line"><span class="meta">				StaticPackage(), \</span></span><br><span class="line"><span class="meta">				(TCHAR*)TEXT(#TClass) + 1 + ((StaticClassFlags &amp; CLASS_Deprecated) ? 11 : 0), \</span></span><br><span class="line"><span class="meta">				PrivateStaticClass, \</span></span><br><span class="line"><span class="meta">				StaticRegisterNatives##TClass, \</span></span><br><span class="line"><span class="meta">				sizeof(TClass), \</span></span><br><span class="line"><span class="meta">				alignof(TClass), \</span></span><br><span class="line"><span class="meta">				(EClassFlags)TClass::StaticClassFlags, \</span></span><br><span class="line"><span class="meta">				TClass::StaticClassCastFlags(), \</span></span><br><span class="line"><span class="meta">				TClass::StaticConfigName(), \</span></span><br><span class="line"><span class="meta">				(UClass::ClassConstructorType)InternalConstructor<span class="meta-string">&lt;TClass&gt;</span>, \</span></span><br><span class="line"><span class="meta">				(UClass::ClassVTableHelperCtorCallerType)InternalVTableHelperCtorCaller<span class="meta-string">&lt;TClass&gt;</span>, \</span></span><br><span class="line"><span class="meta">				&amp;TClass::AddReferencedObjects, \</span></span><br><span class="line"><span class="meta">				&amp;TClass::Super::StaticClass, \</span></span><br><span class="line"><span class="meta">				&amp;TClass::WithinClass::StaticClass \</span></span><br><span class="line"><span class="meta">			); \</span></span><br><span class="line"><span class="meta">		&#125; \</span></span><br><span class="line"><span class="meta">		return PrivateStaticClass; \</span></span><br><span class="line"><span class="meta">	&#125; \</span></span><br></pre></td></tr></table></figure><p></p><p>ä¸éš¾å‘ç°ï¼Œå…¶å® &quot;UClassRegisterAllCompiledInClasses&quot; å°±æ˜¯å†éå†æˆ‘ä»¬ä¹‹å‰æ”¶é›†çš„æ‰€æœ‰ &quot;UClass&quot; ä¿¡æ¯ï¼Œå¹¶é€ä¸ªè°ƒç”¨å…¶ &quot;GetPrivateStaticClassBody&quot; å‡½æ•°ã€‚ä»¥ä¸‹å¯¹ &quot;GetPrivateStaticClassBody&quot; å‡½æ•°è¿›è¡Œè§£æ (å¥½æˆæ­£å¼å¼€å§‹å•¦ï½ï½ï½)</p><h4 id="getprivatestaticclassbody"><a class="anchor" href="#getprivatestaticclassbody">#</a> GetPrivateStaticClassBody</h4><p></p><figure class="highlight c++"><figcaption><span>GetPrivateStaticClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Class.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetPrivateStaticClassBody</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">const</span> TCHAR* PackageName,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">const</span> TCHAR* Name,</span></span></span><br><span class="line"><span class="params"><span class="function">	UClass*&amp; ReturnClass,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">void</span>(*RegisterNativeFunc)(),</span></span></span><br><span class="line"><span class="params"><span class="function">	uint32 InSize,</span></span></span><br><span class="line"><span class="params"><span class="function">	uint32 InAlignment,</span></span></span><br><span class="line"><span class="params"><span class="function">	EClassFlags InClassFlags,</span></span></span><br><span class="line"><span class="params"><span class="function">	EClassCastFlags InClassCastFlags,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">const</span> TCHAR* InConfigName,</span></span></span><br><span class="line"><span class="params"><span class="function">	UClass::ClassConstructorType InClassConstructor,</span></span></span><br><span class="line"><span class="params"><span class="function">	UClass::ClassVTableHelperCtorCallerType InClassVTableHelperCtorCaller,</span></span></span><br><span class="line"><span class="params"><span class="function">	UClass::ClassAddReferencedObjectsType InClassAddReferencedObjects,</span></span></span><br><span class="line"><span class="params"><span class="function">	UClass::StaticClassFunctionType InSuperClassFn,</span></span></span><br><span class="line"><span class="params"><span class="function">	UClass::StaticClassFunctionType InWithinClassFn,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">bool</span> bIsDynamic <span class="comment">/*= false*/</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	UDynamicClass::DynamicClassInitializerType InDynamicClassInitializerFn <span class="comment">/*= nullptr*/</span></span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/* å¿½ç•¥çƒ­é‡è½½å’ŒåŠ¨æ€ç±»çš„å¤„ç†(ç±»ä¼¼) */</span></span><br><span class="line">    <span class="comment">// è·å–å…¨å±€UObjectå†…å­˜åˆ†é…å™¨ï¼Œåˆ†é…ä¸€å—å†…å­˜ç»™å’±çš„ &quot;UClass&quot;</span></span><br><span class="line">	ReturnClass = (UClass*)GUObjectAllocator.<span class="built_in">AllocateUObject</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(UClass), <span class="built_in"><span class="keyword">alignof</span></span>(UClass), <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">// åœ¨åˆšåˆšåˆ†é…çš„å†…å­˜ä¸­æ„é€ å’±çš„ &quot;UClass&quot; (UClassçš„æ„é€ å‡½æ•°ä¸‹æ–‡åˆ†æ)</span></span><br><span class="line">    ReturnClass = ::<span class="built_in"><span class="keyword">new</span></span> (ReturnClass)</span><br><span class="line">        <span class="built_in">UClass</span></span><br><span class="line">        (</span><br><span class="line">        EC_StaticConstructor,</span><br><span class="line">        Name,</span><br><span class="line">        InSize,</span><br><span class="line">        InAlignment,</span><br><span class="line">        InClassFlags,</span><br><span class="line">        InClassCastFlags,</span><br><span class="line">        InConfigName,</span><br><span class="line">        <span class="built_in">EObjectFlags</span>(RF_Public | RF_Standalone | RF_Transient | RF_MarkAsNative | RF_MarkAsRootSet),</span><br><span class="line">        InClassConstructor,</span><br><span class="line">        InClassVTableHelperCtorCaller,</span><br><span class="line">        InClassAddReferencedObjects</span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">check</span>(ReturnClass);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç±»çš„ä¸€äº›ç§æœ‰å±æ€§ï¼Œåšä¸€äº›å»¶è¿Ÿæ³¨å†Œçš„å‰ç½®å·¥ä½œ</span></span><br><span class="line">    <span class="built_in">InitializePrivateStaticClass</span>(</span><br><span class="line">        <span class="built_in">InSuperClassFn</span>(),</span><br><span class="line">        ReturnClass,</span><br><span class="line">        <span class="built_in">InWithinClassFn</span>(),</span><br><span class="line">        PackageName,</span><br><span class="line">        Name</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨å†Œç±»çš„æœ¬åœ°å‡½æ•° (æºæ–‡ä»¶ä¸­çš„UFunction)ï¼Œä¸‹æ–‡åˆ†æ</span></span><br><span class="line">    <span class="built_in">RegisterNativeFunc</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>&quot;GetPrivateStaticClassBody&quot; å…¶å®å°±æ˜¯ç”³è¯·äº†ä¸€å—å†…å­˜ï¼Œç„¶ååœ¨è¿™å—å†…å­˜ä¸­æ„é€ å’±çš„ &quot;UClass&quot;ï¼Œæœ€åå†æ³¨å†Œå’±çš„æœ¬åœ°å‡½æ•°ã€‚ä¸çŸ¥é“è¯»è€…æœ‰æ²¡æœ‰æƒ³è¿‡ï¼š<strong>ä¸ºä»€ä¹ˆ UE è¦åœ¨ &quot;CoreUObject&quot; æ¨¡å— &quot;Startup&quot; åæ‰ä¸º &quot;UClass&quot; ç”³è¯·å†…å­˜å¹¶è¿›è¡Œæ„é€ å‘¢ï¼Ÿ<strong>å…¶å®æ˜¯</strong>å› ä¸ºæˆ‘ä»¬è¦ä¸º &quot;UClass&quot; ç”³è¯·å†…å­˜ç©ºé—´ï¼Œé‚£å°±å¿…é¡»è¦ç”¨åˆ° &quot;GUObjectAllocator&quot;ï¼Œè€Œè¿™ä¸ª &quot;UObject å†…å­˜åˆ†é…å™¨&quot; åˆæ˜¯å®šä¹‰åœ¨ &quot;CoreUObject&quot; æ¨¡ç»„ä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆåŠ è½½ &quot;CoreUObject&quot; æ¨¡ç»„ï¼Œå½“ç„¶ &quot;CoreUObject&quot; çš„ä½œç”¨è¿œè¿œä¸æ­¢è¿™ç‚¹ï¼Œå‰©ä¸‹çš„ç•™åˆ°ä»¥åå†æ¢ç©¶å§ ï¼‰</p><p>å’±å…ˆå»çœ‹çœ‹ &quot;UClass çš„æ„é€ å‡½æ•°&quot;ï¼Œ&quot;InitializePrivateStaticClass&quot; å’Œ &quot;RegisterNativeFunc&quot; é‡Œéƒ½å¹²äº†ä»€ä¹ˆ ğŸ˜ƒ</p><h4 id="uclassuclass"><a class="anchor" href="#uclassuclass">#</a> UClass::UClass</h4><p></p><figure class="highlight c++"><figcaption><span>UClass::UClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">UClass::<span class="built_in">UClass</span></span><br><span class="line">(</span><br><span class="line">	EStaticConstructor,</span><br><span class="line">	FName			InName,</span><br><span class="line">	uint32			InSize,</span><br><span class="line">	uint32			InAlignment,</span><br><span class="line">	EClassFlags		InClassFlags,</span><br><span class="line">	EClassCastFlags	InClassCastFlags,</span><br><span class="line">	<span class="keyword">const</span> TCHAR*    InConfigName,</span><br><span class="line">	EObjectFlags	InFlags,</span><br><span class="line">	ClassConstructorType InClassConstructor,</span><br><span class="line">	ClassVTableHelperCtorCallerType InClassVTableHelperCtorCaller,</span><br><span class="line">	ClassAddReferencedObjectsType InClassAddReferencedObjects</span><br><span class="line">)</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–åŸºç±»Struct</span></span><br><span class="line">:	<span class="built_in">UStruct</span>					( EC_StaticConstructor, InSize, InAlignment, InFlags )</span><br><span class="line">    <span class="comment">// åå°„ç”¨çš„ åŒ…è£…äº†è¯¥ç±»çš„æ„é€ å‡½æ•°çš„ å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">,	<span class="built_in">ClassConstructor</span>		( InClassConstructor )</span><br><span class="line">    <span class="comment">// åŒ…è£…äº†è¯¥ç±»çš„çƒ­é‡è½½æ—¶è°ƒç”¨çš„æ„é€ å‡½æ•°çš„ å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">,	<span class="built_in">ClassVTableHelperCtorCaller</span>(InClassVTableHelperCtorCaller)</span><br><span class="line">    <span class="comment">// æŒ‡å‘å®šä¹‰åœ¨ &quot;UObject&quot; ä¸­çš„è™šå‡½æ•° &quot;AddReferencedObjects&quot; </span></span><br><span class="line">,	<span class="built_in">ClassAddReferencedObjects</span>( InClassAddReferencedObjects )</span><br><span class="line">    <span class="comment">// ç±»ä¼ªå”¯ä¸€è®¡æ•°å™¨ï¼›ç”¨äºåŠ é€Ÿå”¯ä¸€å®ä¾‹åç§°çš„ç”Ÿæˆ (uint32)</span></span><br><span class="line">,	<span class="built_in">ClassUnique</span>				( <span class="number">0</span> )</span><br><span class="line">    <span class="comment">// è¯¥ç±»æ˜¯å¦å·²è¢«çƒ˜ç„™ (bool)</span></span><br><span class="line">,	<span class="built_in">bCooked</span>					( <span class="literal">false</span> )</span><br><span class="line">    <span class="comment">// æè¿°ä¸€ä¸ªç±»çš„Flagsï¼Œè¯¦è§EClassFlags (EClassFlags)</span></span><br><span class="line">,	<span class="built_in">ClassFlags</span>				( InClassFlags | CLASS_Native )</span><br><span class="line">    <span class="comment">// ç”¨äºUObjectçš„åŠ¨æ€ç±»å‹è½¬æ¢ (EClassCastFlags)</span></span><br><span class="line">,	<span class="built_in">ClassCastFlags</span>			( InClassCastFlags )</span><br><span class="line">    <span class="comment">// ç±»çš„å¤–éƒ¨å®ä¾‹çš„ç±»å‹ (UClass*)</span></span><br><span class="line">,	<span class="built_in">ClassWithin</span>				( <span class="literal">nullptr</span> )</span><br><span class="line">    <span class="comment">// ç”Ÿæˆè¯¥ç±»çš„è“å›¾ï¼Œå¦‚æœç”Ÿæˆè¯¥ç±»çš„æ˜¯C++ç±»åˆ™ä¸ºç©º (UObject*)</span></span><br><span class="line">,	<span class="built_in">ClassGeneratedBy</span>		( <span class="literal">nullptr</span> )</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> WITH_EDITORONLY_DATA</span></span><br><span class="line">    <span class="comment">// åœ¨PurgeClassä¸­æ— æ³•é”€æ¯çš„ æ­¤ç±»é”€æ¯æ—¶è¦é”€æ¯çš„å±æ€§çš„é“¾æ¥åˆ—è¡¨ (FField*)</span></span><br><span class="line">,	<span class="built_in">PropertiesPendingDestruction</span>( <span class="literal">nullptr</span> )</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="comment">// è®°å½•è¯¥ç±»çš„é…ç½®ä¿¡æ¯çš„ Name.ini æ–‡ä»¶å (FName)</span></span><br><span class="line">,	<span class="built_in">ClassConfigName</span>			()</span><br><span class="line">    <span class="comment">// ç½‘ç»œç›¸å…³çš„å­—æ®µ(å‡½æ•°)åˆ—è¡¨ (TArray&lt;UField*&gt;)</span></span><br><span class="line">,	<span class="built_in">NetFields</span>				()</span><br><span class="line">    <span class="comment">// CDO</span></span><br><span class="line">,	<span class="built_in">ClassDefaultObject</span>		( <span class="literal">nullptr</span> )</span><br><span class="line">    <span class="comment">// æŒ‡å‘æˆ‘ä»¬è‡ªå®šä¹‰çš„ &quot;SparseClassData&quot; ç»“æ„ä½“çš„å®ä¾‹çš„æŒ‡é’ˆ (void*)</span></span><br><span class="line">,	<span class="built_in">SparseClassData</span>			( <span class="literal">nullptr</span> )</span><br><span class="line">    <span class="comment">// æŒ‡å‘æˆ‘ä»¬è‡ªå®šä¹‰çš„ &quot;SparseClassData&quot; ç»“æ„ä½“çš„ç±»å‹ä¿¡æ¯çš„æŒ‡é’ˆ (void*)</span></span><br><span class="line">,	<span class="built_in">SparseClassDataStruct</span>	( <span class="literal">nullptr</span> )</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// å¦‚æœä½ æ”¹æºç ï¼Œåœ¨è¿™é‡Œæ·»åŠ äº†å…¶ä»–çš„propertyï¼Œè¯·åŒæ­¥æ›´æ–°å…¶ä»–çš„æ„é€ å‡½æ•°å’ŒPurgeClass()</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// å®šä¹‰ç‰¹å®šC++ç±»çš„ç‰¹æ€§ (è¯¥C++ç±»æ˜¯å¦ä¸ºæŠ½è±¡ç±»ï¼Œé»˜è®¤ä¸ºfalse)</span></span><br><span class="line">	<span class="built_in">SetCppTypeInfoStatic</span>(&amp;DefaultCppClassTypeInfoStatic);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è¿™æ˜¯ä¸€ä¸ªä¸åŒ¹é…çš„ç±»å‹çš„å¼ºåˆ¶è½¬æ¢ï¼Œç”¨äº &quot;UClass::DeferredRegister&quot;å‡½æ•°ä¸­ï¼Œ&quot;ClassConfigName&quot; æŒ‡æ˜è¦ä»å“ªä¸ª &quot;Name.ini&quot; æ–‡ä»¶ä¸­è¯»å–é…ç½®å˜é‡</span></span><br><span class="line">	*(<span class="keyword">const</span> TCHAR**)&amp;ClassConfigName = InConfigName; <span class="comment">//-V580</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>ä»¥ä¸Šæ˜¯ &quot;UClass&quot; çš„æ„é€ å‡½æ•°å’Œä¸€äº›é‡è¦å±æ€§ï¼Œæ—¢ç„¶æ˜¯å¯¹ &quot;UClass&quot; è¿›è¡Œè§£æçš„åšå®¢ï¼Œè‡ªç„¶æ˜¯ä¸èƒ½è·³è¿‡çš„ã€‚&quot;UClass&quot; ç®—æ˜¯æ„é€ å¥½äº†ï¼Œä½†ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œå…¶å® &quot;UClass&quot; ä¸­çš„å¾ˆå¤šå±æ€§éƒ½æ˜¯æ²¡æœ‰èµ‹å€¼çš„ã€‚æ¯”å¦‚ï¼š&quot;Name&quot;ï¼Œ&quot;ClassWithin&quot;ï¼Œ&quot;CDO&quot; ç­‰ã€‚ä¸ç€æ€¥ï¼Œå’±ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œæ…¢å·¥å‡ºç»†æ´» )</p><p>ä¸‹é¢å¼€å§‹ä¸ºå’±åˆšåˆšæ„é€ çš„ &quot;UClass&quot; å¡«å……æ›´å¤šçš„å†…å®¹ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï½ï½ï½</p><h4 id="initializeprivatestaticclass"><a class="anchor" href="#initializeprivatestaticclass">#</a> InitializePrivateStaticClass</h4><p></p><figure class="highlight c++"><figcaption><span>InitializePrivateStaticClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Class.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function">COREUOBJECT_API <span class="keyword">void</span> <span class="title">InitializePrivateStaticClass</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	class UClass* TClass_Super_StaticClass,</span></span></span><br><span class="line"><span class="params"><span class="function">	class UClass* TClass_PrivateStaticClass,</span></span></span><br><span class="line"><span class="params"><span class="function">	class UClass* TClass_WithinClass_StaticClass,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">const</span> TCHAR* PackageName,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">const</span> TCHAR* Name</span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨é€šçŸ¥æ³¨å†Œäº‹ä»¶ï¼Œæ”¹å˜è¯¥ç±»åœ¨ &quot;PathToState&quot; ä¸­çš„çŠ¶æ€ï¼Œç”¨äºå¼‚æ­¥åŒ…è¯»å–</span></span><br><span class="line">	<span class="built_in">NotifyRegistrationEvent</span>(PackageName, Name, ENotifyRegistrationType::NRT_Class, ENotifyRegistrationPhase::NRP_Started);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* &quot;SetSuperStruct&quot; é‡Œé¢å›è°ƒç”¨ &quot;Super::SetSuperStruct&quot; æ¥ç»´æŠ¤è¿™ä¸ªç±»çš„ç»§æ‰¿é“¾ï¼Œä¹Ÿæ˜¯ä¸ºäº†é¿å…è¿›å…¥é€’å½’æ­»å¾ªç¯ï¼Œå‡½æ•°è§£æåœ¨ä¸‹é¢ */</span></span><br><span class="line">	<span class="keyword">if</span> (TClass_Super_StaticClass != TClass_PrivateStaticClass)</span><br><span class="line">	&#123;</span><br><span class="line">		TClass_PrivateStaticClass-&gt;<span class="built_in">SetSuperStruct</span>(TClass_Super_StaticClass);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		TClass_PrivateStaticClass-&gt;<span class="built_in">SetSuperStruct</span>(<span class="literal">NULL</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// å’±ç°åœ¨çš„ &quot;UClass&quot; å®é™…ä¸Šæ˜¯ä¸€ä¸ªæè¿° &quot;UObject&quot; çš„ç±»ï¼Œæ‰€ä»¥è¿™é‡Œçš„ &quot;ClassWithin&quot; å°±æ˜¯ &quot;UObject&quot;ï¼Œ&quot;UObject&quot; åº”è¯¥æ”¾åœ¨ &quot;UObject&quot; é‡Œé¢</span></span><br><span class="line">	TClass_PrivateStaticClass-&gt;ClassWithin = TClass_WithinClass_StaticClass;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ³¨å†Œç±»çš„ä¾èµ–ï¼Œç„¶åæ³¨å†Œè¯¥ç±»</span></span><br><span class="line">	TClass_PrivateStaticClass-&gt;<span class="built_in">RegisterDependencies</span>();</span><br><span class="line">	<span class="keyword">if</span> (!TClass_PrivateStaticClass-&gt;<span class="built_in">HasAnyFlags</span>(RF_Dynamic))</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">// å°†æ­¤ç±»åˆ—å…¥ &quot;PendingRegistrants&quot; TMapä¸­ï¼ŒæŒ‚èµ·æ³¨å†Œ (å»¶è¿Ÿæ³¨å†Œ)ï¼Œå‡½æ•°è§£æåœ¨ä¸‹é¢</span></span><br><span class="line">		TClass_PrivateStaticClass-&gt;<span class="built_in">Register</span>(PackageName, Name);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		TClass_PrivateStaticClass-&gt;<span class="built_in">DeferredRegister</span>(UDynamicClass::<span class="built_in">StaticClass</span>(), PackageName, Name);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// è°ƒç”¨é€šçŸ¥æ³¨å†Œäº‹ä»¶ï¼Œæ”¹å˜è¯¥ç±»åœ¨ &quot;PathToState&quot; ä¸­çš„çŠ¶æ€ï¼Œç”¨äºå¼‚æ­¥åŒ…è¯»å–</span></span><br><span class="line">	<span class="built_in">NotifyRegistrationEvent</span>(PackageName, Name, ENotifyRegistrationType::NRT_Class, ENotifyRegistrationPhase::NRP_Finished);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UClass::SetSuperStruct</span><span class="params">(UStruct* NewSuperStruct)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºå½“å‰ &quot;UClass&quot; è¿˜æ˜¯æ²¡æœ‰åˆå§‹åŒ– &quot;Name&quot;ï¼Œæ‰€ä»¥ &quot;UnhashObject&quot; ç›´æ¥è¢«return</span></span><br><span class="line">	<span class="built_in">UnhashObject</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// æ²¡æœ‰åˆå§‹åŒ– &quot;SuperFuncMap&quot;ï¼Œç•¥è¿‡</span></span><br><span class="line">	<span class="built_in">ClearFunctionMapsCaches</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½® &quot;SuperClass&quot;ï¼Œåˆ‡å‹¿é€’å½’æ­»å¾ªç¯</span></span><br><span class="line">	Super::<span class="built_in">SetSuperStruct</span>(NewSuperStruct);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ²¡æœ‰åˆå§‹åŒ– &quot;SparseClassData&quot;ï¼Œä½†ä¼šå»æŸ¥æ‰¾SuperClassæ˜¯å¦æœ‰ &quot;SparseClassData&quot; ä¿¡æ¯</span></span><br><span class="line"> 	<span class="comment">// å¦‚æœæœ‰ï¼Œå°†å…¶ç±»å‹ç»™è‡ªå·±å®‰ä¸Šï¼Œä½†çˆ¶ç±»ä¸­çš„ &quot;SparseClassData&quot; ç»“æ„ä½“ä¸­ä¿å­˜çš„æ•°æ®å¹¶ä¸ä¼šè¢«ç»§æ‰¿</span></span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">GetSparseClassDataStruct</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (UScriptStruct* SparseClassDataStructArchetype = <span class="built_in">GetSparseClassDataArchetypeStruct</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">SetSparseClassDataStruct</span>(SparseClassDataStructArchetype);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">HashObject</span>(<span class="keyword">this</span>);	<span class="comment">// æ— æ•ˆæ“ä½œ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// UClassçš„æ³¨å†Œæ˜¯ä»¥å»¶è¿Ÿæ³¨å†Œçš„æ–¹å¼è¿›è¡Œçš„ï¼Œå½“å‰å‡½æ•°åªæ˜¯åœ¨æ·»åŠ å»¶è¿Ÿæ³¨å†Œçš„ä¿¡æ¯ï¼ŒçœŸæ­£çš„æ³¨å†Œè¿˜æ²¡å¼€å§‹...</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UObjectBase::Register</span><span class="params">(<span class="keyword">const</span> TCHAR* PackageName,<span class="keyword">const</span> TCHAR* InName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä¸€ä¸ªè®°å½•å½“å‰æ­£åœ¨æŒ‚èµ·æ³¨å†Œçš„æ‰€æœ‰ &quot;UClass&quot; çš„å•ä¾‹TMap</span></span><br><span class="line">	TMap&lt;UObjectBase*, FPendingRegistrantInfo&gt;&amp; PendingRegistrants = FPendingRegistrantInfo::<span class="built_in">GetMap</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è¯¥ç±»æ·»åŠ åˆ° &quot;PendingRegistrants&quot; ä¸­ï¼Œè¿›è¡ŒæŒ‚èµ·æ³¨å†Œ (å»¶è¿Ÿæ³¨å†Œ)</span></span><br><span class="line">	FPendingRegistrant* PendingRegistration = <span class="keyword">new</span> <span class="built_in">FPendingRegistrant</span>(<span class="keyword">this</span>);</span><br><span class="line">	PendingRegistrants.<span class="built_in">Add</span>(<span class="keyword">this</span>, <span class="built_in">FPendingRegistrantInfo</span>(InName, PackageName));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾€å…¨å±€ &quot;æŒ‚èµ·æ³¨å†Œ&quot; é“¾è¡¨ä¸­æ·»åŠ å½“å‰ç±»</span></span><br><span class="line">    <span class="keyword">if</span> (GLastPendingRegistrant)</span><br><span class="line">    &#123;</span><br><span class="line">        GLastPendingRegistrant-&gt;NextAutoRegister = PendingRegistration;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">check</span>(!GFirstPendingRegistrant);</span><br><span class="line">        GFirstPendingRegistrant = PendingRegistration;</span><br><span class="line">    &#125;</span><br><span class="line">    GLastPendingRegistrant = PendingRegistration;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>åˆ°è¿™é‡Œï¼Œ&quot;UClass&quot; çš„ &quot;ClassWithin&quot; ï¼Œ&quot;SuperClass&quot; éƒ½åˆå§‹åŒ–å¥½äº†ï¼Œä½†å…¶å® &quot;UClass&quot; çš„æ•°æ®è¿œè¿œä¸æ­¢è¿™äº›ï¼Œå‰©ä¸‹çš„ä¼šåœ¨åé¢çš„<a href="#UClass%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%B3%A8%E5%86%8C">å»¶è¿Ÿæ³¨å†Œ</a>ä¸­è¢«åˆå§‹åŒ–ï¼Œå…ˆæœŸå¾…ä¸€ä¸‹å§ ğŸ˜ƒ</p><p>åˆ«å¿˜äº†ï¼Œæˆ‘ä»¬è¿˜æœ‰ &quot;UFunction&quot; å‡½æ•°æ²¡æœ‰æ³¨å†Œï¼ˆåå°„ç³»ç»Ÿå½“ç„¶å°‘ä¸äº†å’±çš„ UFunction å•¦ï½ï½ï½</p><h4 id="registernativefunc"><a class="anchor" href="#registernativefunc">#</a> RegisterNativeFunc</h4><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Class.cpp ä»¥ä¸‹ä»£ç çœç•¥çš„éƒ¨åˆ†å‰æ–‡éƒ½å·²ç»åˆ†æè¿‡äº†</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetPrivateStaticClassBody</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="comment">/* ..., */</span></span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">void</span>(*RegisterNativeFunc)(), </span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="comment">/* ... */</span></span></span></span><br><span class="line"><span class="params"><span class="function">	)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// .....</span></span><br><span class="line">    <span class="built_in">RegisterNativeFunc</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ObjectMacros.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMPLEMENT_CLASS(TClass, TClassCrc) \</span></span><br><span class="line"><span class="meta">	UClass* TClass::GetPrivateStaticClass() \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		<span class="comment">/* ... */</span> \</span></span><br><span class="line"><span class="meta">		GetPrivateStaticClassBody( \</span></span><br><span class="line"><span class="meta">			<span class="comment">/* ... */</span> \</span></span><br><span class="line"><span class="meta">			StaticRegisterNatives##TClass, \</span></span><br><span class="line"><span class="meta">            <span class="comment">/* ... */</span> \                          </span></span><br><span class="line">			); \</span><br><span class="line">        <span class="comment">/* ... */</span> \     </span><br><span class="line">	&#125; \</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">// ClassName.gen.cpp</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UClassName::StaticRegisterNativesUClassName</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        UClass* Class = UClassName::<span class="built_in">StaticClass</span>();</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">const</span> FNameNativePtrPair Funcs[] = &#123;</span><br><span class="line">            &#123; <span class="string">&quot;UFunctionName&quot;</span>, &amp;UClassName::execUFunctionName &#125;,</span><br><span class="line">            <span class="comment">// ...... å…¶ä»–åœ¨ &quot;RPC_WRAPPERS_NO_PURE_DECLS&quot; å®ä¸­å®šä¹‰çš„ &quot;execå‡½æ•°&quot; éƒ½ä¼šåŠ å…¥åˆ° &quot;Funcs&quot; æ•°ç»„é‡Œï¼Œç”¨äºä¸‹é¢çš„ &quot;RegisterFunctions&quot; æ³¨å†Œå‡½æ•°ã€‚</span></span><br><span class="line">        &#125;;</span><br><span class="line">        FNativeFunctionRegistrar::<span class="built_in">RegisterFunctions</span>(Class, Funcs, <span class="built_in">UE_ARRAY_COUNT</span>(Funcs));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Class.cpp</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FNativeFunctionRegistrar::RegisterFunctions</span><span class="params">(class UClass* Class, <span class="keyword">const</span> FNameNativePtrPair* InArray, int32 NumFunctions)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (; NumFunctions; ++InArray, --NumFunctions)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">// é€ä¸ªæ³¨å†Œ &quot;Funcs&quot; æ•°ç»„é‡Œé¢çš„å‡½æ•°</span></span><br><span class="line">		Class-&gt;<span class="built_in">AddNativeFunction</span>(<span class="built_in">UTF8_TO_TCHAR</span>(InArray-&gt;NameUTF8), InArray-&gt;Pointer);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UClass::AddNativeFunction</span><span class="params">(<span class="keyword">const</span> WIDECHAR* InName, FNativeFuncPtr InPointer)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">FName <span class="title">InFName</span><span class="params">(InName)</span></span>;</span><br><span class="line">    <span class="comment">/* çœç•¥çƒ­é‡è½½ä»£ç  */</span></span><br><span class="line">    <span class="comment">// &quot;TArray&lt;FNativeFunctionLookup&gt; NativeFunctionLookupTable&quot; æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¾€è¿™ä¸ªæ•°ç»„çš„æœ«ç«¯æ·»åŠ ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">	<span class="keyword">new</span>(NativeFunctionLookupTable)<span class="built_in">FNativeFunctionLookup</span>(InFName, InPointer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FNativeFunctionLookup</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// å‡½æ•°å</span></span><br><span class="line">	FName Name;</span><br><span class="line">    <span class="comment">// æœ¬åœ°å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">	FNativeFuncPtr Pointer;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">FNativeFunctionLookup</span>(FName InName, FNativeFuncPtr InPointer)</span><br><span class="line">		:	<span class="built_in">Name</span>(InName)</span><br><span class="line">		,	<span class="built_in">Pointer</span>(InPointer)</span><br><span class="line">	&#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p></p><p>ä¸€é¡¿æ“ä½œä¸‹æ¥ï¼Œå…¶å®åªæ˜¯æŠŠæˆ‘ä»¬åœ¨ &quot;ClassName.h&quot; ä¸­å®šä¹‰çš„ UFunction ç»™æ·»åŠ åˆ°å…¶ &quot;UClass&quot; çš„ &quot;NativeFunctionLookupTable&quot; æ•°ç»„ä¸­ã€‚æœ‰äº†è¿™ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å‡½æ•°åæŸ¥æ‰¾åˆ°å¯¹åº”çš„ &quot;exec å‡½æ•°&quot;ï¼Œè¿™å°±ç›¸å½“äºå®ç°äº†å‡½æ•°çš„åå°„äº†</p><p>okkï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ UE æ˜¯æ€ä¹ˆ<strong>å¤„ç†æŒ‚èµ·çš„ UClass çš„æ³¨å†Œ</strong>çš„å§ï½ï½ï½</p><h3 id="uclassçš„å»¶è¿Ÿæ³¨å†Œa-iduclassçš„å»¶è¿Ÿæ³¨å†Œa"><a class="anchor" href="#uclassçš„å»¶è¿Ÿæ³¨å†Œa-iduclassçš„å»¶è¿Ÿæ³¨å†Œa">#</a> UClass çš„å»¶è¿Ÿæ³¨å†Œ &lt;a id=&quot;UClass çš„å»¶è¿Ÿæ³¨å†Œ&quot;&gt;&lt;/a&gt;</h3><p>&quot;<strong>UObjectProcessRegistrants</strong>&quot;å‡½æ•°æ˜¯&quot;UClass&quot; æŒ‚èµ·æ³¨å†Œçš„å…¥å£ï¼Œå…¶è°ƒç”¨é“¾å¦‚ä¸‹ï¼š</p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectProcessRegistrants( è°ƒç”¨é“¾</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">WinMain</span>() -&gt; <span class="built_in">GuardedMain</span>() -&gt; <span class="built_in">EnginePreInit</span>() -&gt; FEngineLoop::<span class="built_in">PreInit</span>() -&gt; FEngineLoop::<span class="built_in">PreInitPreStartupScreen</span>() -&gt; FEngineLoop::<span class="built_in">AppInit</span>() -&gt; FCoreDelegates::OnInit.<span class="built_in">Broadcast</span>() -&gt; FCoreDelegates::OnInit.<span class="built_in">AddStatic</span>(InitUObject) -&gt; <span class="built_in">StaticUObjectInit</span>() -&gt; <span class="built_in">UObjectBaseInit</span>() -&gt; <span class="built_in">UObjectProcessRegistrants</span>()</span><br></pre></td></tr></table></figure><p></p><p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬çš„æŒ‚èµ·æ³¨å†Œå®é™…ä¸Šä¹Ÿæ˜¯åœ¨ &quot;FEngineLoop::PreInit&quot; é˜¶æ®µè¿›è¡Œçš„ã€‚åªä¸è¿‡ &quot;AppInit&quot; åœ¨ &quot;UClassRegisterAllCompiledInClasses&quot; ä¹‹åè€Œå·²ã€‚åœ¨æˆ‘ä»¬è¿›å…¥ &quot;UObjectProcessRegistrants&quot; çš„è§£æä¹‹å‰ï¼Œå…¶å®è°ƒç”¨é“¾ä¸­è¿˜æœ‰ä¸€ä¸ªå‡½æ•°éå¸¸å€¼å¾—æˆ‘ä»¬åˆ†æï¼Œé‚£å°±æ˜¯ &quot;StaticUObjectInit&quot;ã€‚æ˜¯çš„ï¼Œè¿™æ˜¯é™æ€åˆå§‹åŒ– &quot;UObject&quot; çš„å‡½æ•°ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹ &quot;StaticUObjectInit&quot; éƒ½åšäº†ä»€ä¹ˆå§ï½ï½ï½</p><h4 id="staticuobjectinit"><a class="anchor" href="#staticuobjectinit">#</a> StaticUObjectInit</h4><p></p><figure class="highlight c++"><figcaption><span>StaticUObjectInit</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Obj.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">StaticUObjectInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// UObjectåˆå§‹åŒ–çš„æœ€åé˜¶æ®µï¼Œé‡è¦å‡½æ•°ï¼ä¸‹æ–‡è§£æ</span></span><br><span class="line">	<span class="built_in">UObjectBaseInit</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä¸ºä¸´æ—¶åŒ…åˆ†é…å†…å­˜ï¼Œè¯¥ä¸´æ—¶åŒ…ä¸ä¼šè¢«GCï¼Œæ²¡æœ‰å…·ä½“åŒ…åçš„UObjectä¼šè¢«åŠ å…¥è¯¥ä¸´æ—¶åŒ…ä¸­</span></span><br><span class="line">	GObjTransientPkg = NewObject&lt;UPackage&gt;(<span class="literal">nullptr</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;/Engine/Transient&quot;</span>), RF_Transient);</span><br><span class="line">	GObjTransientPkg-&gt;<span class="built_in">AddToRoot</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="uobjectbaseinit"><a class="anchor" href="#uobjectbaseinit">#</a> UObjectBaseInit</h4><p></p><figure class="highlight c++"><figcaption><span>UObjectBaseInit</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UObjectBase.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯¥å‡½æ•°é¦–å…ˆåˆå§‹åŒ–äº† &quot;GUObjectAllocator&quot; çš„æ°¸ä¹…å¯¹è±¡æ± (ä¸ä¼šè¢«GC)ï¼Œå’Œ &quot;GUObjectArray&quot; çš„å¯¹è±¡æ± ï¼Œæœ€ååˆå§‹åŒ–å¼‚æ­¥çº¿ç¨‹ï¼Œç”¨äºåŒ…è¯»å–ã€‚æœ€åè°ƒç”¨å’±çš„ &quot;UObjectProcessRegistrants&quot; å¤„ç†æŒ‚èµ·æ³¨å†Œçš„ &quot;UClass&quot;ã€‚æ‰€æœ‰çš„è¿‡ç¨‹å’±éƒ½ä¼šåœ¨æ³¨é‡Šé‡Œä»‹ç»ä¸€éï¼Œä¸åƒçœ‹GCçš„è¯»è€…ä¹Ÿå¯ä»¥è·³è¿‡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UObjectBaseInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€äº›ç”¨äºåˆå§‹åŒ– &quot;GUObjectAllocator&quot; å’Œ &quot;GUObjectArray&quot; çš„å‚æ•°</span></span><br><span class="line">	int32 MaxObjectsNotConsideredByGC = <span class="number">0</span>;</span><br><span class="line">	int32 SizeOfPermanentObjectPool = <span class="number">0</span>;</span><br><span class="line">	int32 MaxUObjects = <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span>; <span class="comment">// Default to ~2M UObjects</span></span><br><span class="line">	<span class="keyword">bool</span> bPreAllocateUObjectArray = <span class="literal">false</span>;	</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éEditoræ¨¡å¼ä¸‹ï¼Œä»é…ç½®æ–‡ä»¶ä¸­è¯»å–ç›¸åº”æ•°æ®ï¼Œå¹¶é…ç½®åˆ°åˆšåˆšå£°æ˜çš„å‚æ•°ä¸­</span></span><br><span class="line">	<span class="keyword">if</span> (FPlatformProperties::<span class="built_in">RequiresCookedData</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		FString Value;</span><br><span class="line">		<span class="keyword">bool</span> bIsCookOnTheFly = FParse::<span class="built_in">Value</span>(FCommandLine::<span class="built_in">Get</span>(), <span class="built_in">TEXT</span>(<span class="string">&quot;-filehostip=&quot;</span>), Value);</span><br><span class="line">		<span class="keyword">if</span> (bIsCookOnTheFly)</span><br><span class="line">		&#123;</span><br><span class="line">			GCreateGCClusters = <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–å¹¶è®¾ç½®å‚æ•°</span></span><br><span class="line">			GConfig-&gt;<span class="built_in">GetInt</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;/Script/Engine.GarbageCollectionSettings&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;gc.MaxObjectsNotConsideredByGC&quot;</span>), MaxObjectsNotConsideredByGC, GEngineIni);</span><br><span class="line"></span><br><span class="line">			GConfig-&gt;<span class="built_in">GetInt</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;/Script/Engine.GarbageCollectionSettings&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;gc.SizeOfPermanentObjectPool&quot;</span>), SizeOfPermanentObjectPool, GEngineIni);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		GConfig-&gt;<span class="built_in">GetInt</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;/Script/Engine.GarbageCollectionSettings&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;gc.MaxObjectsInGame&quot;</span>), MaxUObjects, GEngineIni);</span><br><span class="line"></span><br><span class="line">		GConfig-&gt;<span class="built_in">GetBool</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;/Script/Engine.GarbageCollectionSettings&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;gc.PreAllocateUObjectArray&quot;</span>), bPreAllocateUObjectArray, GEngineIni);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// Editoræ¨¡å¼ä¸‹å°†ç¦ç”¨ &quot;GUObjectAllocator&quot; çš„æ°¸ä¹…å¯¹è±¡æ± </span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> IS_PROGRAM</span></span><br><span class="line">		MaxUObjects = <span class="number">100000</span>; <span class="comment">// Default to 100K for programs</span></span><br><span class="line">		GConfig-&gt;<span class="built_in">GetInt</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;/Script/Engine.GarbageCollectionSettings&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;gc.MaxObjectsInProgram&quot;</span>), MaxUObjects, GEngineIni);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">		GConfig-&gt;<span class="built_in">GetInt</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;/Script/Engine.GarbageCollectionSettings&quot;</span>), <span class="built_in">TEXT</span>(<span class="string">&quot;gc.MaxObjectsInEditor&quot;</span>), MaxUObjects, GEngineIni);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœå¯ç”¨æ°¸ä¹…å¯¹è±¡æ± ä½†å¯å¿½ç•¥GCçš„Objectæ•°é‡ä¸º0ï¼Œåˆ™GCä¼šæŠŠæ°¸ä¹…æ± ä¸­çš„å¯¹è±¡Markä¸ºä¸å¯è¾¾ï¼Œå¹¶å°†å…¶æ¸…ç†æ‰ã€‚æ‰€ä»¥è¿™ç§æ¸…ç©ºä¹Ÿåº”è¯¥ç¦ç”¨æ°¸ä¹…æ± </span></span><br><span class="line">	<span class="keyword">if</span> (MaxObjectsNotConsideredByGC &lt;= <span class="number">0</span> &amp;&amp; SizeOfPermanentObjectPool &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		SizeOfPermanentObjectPool = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// åˆå§‹åŒ– GUObjectAllocatorçš„æ°¸ä¹…æ±  å’Œ GUObjectArrayçš„å¯¹è±¡æ± &quot;ObjObjects&quot;ï¼Œè¯¥å¯¹è±¡æ± æ—¢å­˜æ°¸ä¹…å¯¹è±¡åˆå­˜å½“å‰å­˜æ´»çš„å‚ä¸GCçš„å¯¹è±¡ï¼Œæ°¸ä¹…å¯¹è±¡ä¼šå­˜åœ¨æ•°ç»„çš„åé¢ã€‚</span></span><br><span class="line">	GUObjectAllocator.<span class="built_in">AllocatePermanentObjectPool</span>(SizeOfPermanentObjectPool);</span><br><span class="line">	GUObjectArray.<span class="built_in">AllocateObjectPool</span>(MaxUObjects, MaxObjectsNotConsideredByGC, bPreAllocateUObjectArray);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªå…¨å±€çš„å¼‚æ­¥åŒ…è¯»å–å™¨ï¼Œå¹¶æ›´æ–°å½“å‰å¼‚æ­¥çº¿ç¨‹æ•°ã€‚</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">InitAsyncThread</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="built_in">InitAsyncThread</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ ‡å¿—ç€ &quot;UObjectç³»ç»Ÿ&quot; åˆå§‹åŒ–å®Œæˆ</span></span><br><span class="line">	Internal::<span class="built_in">GetUObjectSubsystemInitialised</span>() = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å§‹å¤„ç† &quot;UClass&quot; çš„æŒ‚èµ·æ³¨å†Œ</span></span><br><span class="line">	<span class="built_in">UObjectProcessRegistrants</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>&quot;UObjectBaseInit&quot; å‡½æ•°ä¸»è¦å°±æ˜¯åœ¨ä¸º GC åšå‡†å¤‡ï¼Œç„¶ååˆå§‹åŒ–äº†ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹ï¼Œç”¨äºåé¢çš„ &quot;UClass&quot; çš„å»¶è¿Ÿæ³¨å†Œã€‚ç»ˆäº... å¯ä»¥ç»§ç»­æ³¨å†Œå’±çš„ &quot;UClass&quot; äº†ï¼ˆå…´å¥‹ï¼‰</p><h4 id="uobjectprocessregistrants"><a class="anchor" href="#uobjectprocessregistrants">#</a> UObjectProcessRegistrants</h4><p></p><figure class="highlight c++"><figcaption><span>UObjectProcessRegistrants</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectBase.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UObjectProcessRegistrants</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// æ‰€æœ‰éœ€è¦æ³¨å†Œçš„ &quot;UObjects&quot; æ•°ç»„</span></span><br><span class="line">	TArray&lt;FPendingRegistrant&gt; PendingRegistrants;</span><br><span class="line">    <span class="comment">// æ›´æ–° &quot;PendingRegistrants&quot; æ•°ç»„</span></span><br><span class="line">	<span class="built_in">DequeuePendingAutoRegistrants</span>(PendingRegistrants);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå†æ³¨å†Œ &quot;PendingRegistrants&quot; æ•°ç»„ä¸­çš„æ‰€æœ‰Objects</span></span><br><span class="line">	<span class="keyword">for</span>(int32 RegistrantIndex = <span class="number">0</span>;RegistrantIndex &lt; PendingRegistrants.<span class="built_in">Num</span>();++RegistrantIndex)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">const</span> FPendingRegistrant&amp; PendingRegistrant = PendingRegistrants[RegistrantIndex];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// çœŸæ­£æ³¨å†Œ &quot;UClass&quot; çš„å‡½æ•°ï¼Œé‡è¦ï¼ä¸‹æ–‡åˆ†æ</span></span><br><span class="line">		<span class="built_in">UObjectForceRegistration</span>(PendingRegistrant.Object, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è¿™é‡Œéœ€è¦æ›´æ–°å’±çš„ &quot;PendingRegistrants&quot; æ•°ç»„ï¼Œå› ä¸ºåœ¨æ³¨å†Œçš„æ—¶å€™å¯èƒ½ä¼šè§¦å‘å¦ä¸€ä¸ªModuleçš„åŠ è½½ï¼Œä»è€Œå¯¼è‡´æœ‰æ–°çš„ &quot;æŒ‚èµ·æ³¨å†Œ&quot; è¿›æ¥ï¼Œæˆ‘ä»¬è¦æŠŠæ–°çš„ &quot;æŒ‚èµ·æ³¨å†Œ&quot; ä¹Ÿä¸€èµ·å¤„ç†äº†</span></span><br><span class="line">		<span class="built_in">DequeuePendingAutoRegistrants</span>(PendingRegistrants);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DequeuePendingAutoRegistrants</span><span class="params">(TArray&lt;FPendingRegistrant&gt;&amp; OutPendingRegistrants)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	FPendingRegistrant* NextPendingRegistrant = GFirstPendingRegistrant;</span><br><span class="line">    <span class="comment">// æ¸…ç©ºé“¾è¡¨èŠ‚ç‚¹è®°å½•ï¼Œä»¥ä¾¿ä¸‹æ¬¡ä½¿ç”¨</span></span><br><span class="line">	GFirstPendingRegistrant = <span class="literal">NULL</span>;</span><br><span class="line">	GLastPendingRegistrant = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">// å°†æ‰€æœ‰æ–°çš„ &quot;æŒ‚èµ·æ³¨å†Œ&quot; åŠ è½½å¤åˆ¶åˆ°å’±çš„ &quot;PendingRegistrants&quot; æ•°ç»„ä¸­ï¼Œå¹¶é‡Šæ”¾åŸæ¥æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜</span></span><br><span class="line">	<span class="keyword">while</span>(NextPendingRegistrant)</span><br><span class="line">	&#123;</span><br><span class="line">		FPendingRegistrant* PendingRegistrant = NextPendingRegistrant;</span><br><span class="line">		OutPendingRegistrants.<span class="built_in">Add</span>(*PendingRegistrant);</span><br><span class="line">		NextPendingRegistrant = PendingRegistrant-&gt;NextAutoRegister;</span><br><span class="line">		<span class="keyword">delete</span> PendingRegistrant;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="uobjectforceregistration"><a class="anchor" href="#uobjectforceregistration">#</a> UObjectForceRegistration</h4><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectBase.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UObjectForceRegistration</span><span class="params">(UObjectBase* Object, <span class="keyword">bool</span> bCheckForModuleRelease)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è·å–å’±ä»¬æ”¶é›†é˜¶æ®µå¤„ç†å¥½çš„TMap</span></span><br><span class="line">	TMap&lt;UObjectBase*, FPendingRegistrantInfo&gt;&amp; PendingRegistrants = FPendingRegistrantInfo::<span class="built_in">GetMap</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨ä¼ è¿›æ¥çš„ &quot;UClass&quot; ä½œä¸ºé”®ï¼Œæ‰¾åˆ°å¯¹åº”çš„ &quot;UClass&quot; æŒ‚èµ·æ³¨å†Œä¿¡æ¯</span></span><br><span class="line">	FPendingRegistrantInfo* Info = PendingRegistrants.<span class="built_in">Find</span>(Object);</span><br><span class="line">	<span class="keyword">if</span> (Info)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">const</span> TCHAR* PackageName = Info-&gt;PackageName;</span><br><span class="line">		<span class="keyword">const</span> TCHAR* Name = Info-&gt;Name;</span><br><span class="line">		PendingRegistrants.<span class="built_in">Remove</span>(Object);  <span class="comment">// å…ˆåˆ é™¤ï¼Œé¿å…äºŒæ¬¡å»¶è¿Ÿæ³¨å†Œ</span></span><br><span class="line">        <span class="comment">// å¼€å§‹å»¶è¿Ÿæ³¨å†Œï¼Œä¸‹æ–‡åˆ†æ</span></span><br><span class="line">		Object-&gt;<span class="built_in">DeferredRegister</span>(UClass::<span class="built_in">StaticClass</span>(),PackageName,Name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UObjectBase::DeferredRegister</span><span class="params">(UClass *UClassStaticClass,<span class="keyword">const</span> TCHAR* PackageName,<span class="keyword">const</span> TCHAR* InName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// è®¾ç½®å¯¹è±¡çš„å±æ€§</span></span><br><span class="line">	UPackage* Package = <span class="built_in">CreatePackage</span>(PackageName);</span><br><span class="line">	<span class="built_in">check</span>(Package);</span><br><span class="line">	Package-&gt;<span class="built_in">SetPackageFlags</span>(PKG_CompiledIn);</span><br><span class="line">	OuterPrivate = Package;</span><br><span class="line"></span><br><span class="line">	ClassPrivate = UClassStaticClass;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å°†è¯¥å¯¹è±¡æ·»åŠ åˆ° &quot;FUObjectHashTables&quot; å•ä¾‹ä¸­(åˆ°è¿™ä¸€æ­¥Objectæ‰æœ‰Name...)</span></span><br><span class="line">	<span class="built_in">AddObject</span>(<span class="built_in">FName</span>(InName), EInternalObjectFlags::None);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç¡®ä¿è¯¥å¯¹è±¡åœ¨æ ¹é›†ä¸­ï¼Œå¿½ç•¥GC</span></span><br><span class="line">	<span class="built_in">check</span>(!GUObjectArray.<span class="built_in">IsDisregardForGC</span>(<span class="keyword">this</span>) || GUObjectArray.<span class="built_in">IndexToObject</span>(InternalIndex)-&gt;<span class="built_in">IsRootSet</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UObjectBase::AddObject</span><span class="params">(FName InName, EInternalObjectFlags InSetInternalFlags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®åå­—ï¼Œå†…éƒ¨å¯¹è±¡æ ‡å¿—(ç”¨äºGCç­‰)</span></span><br><span class="line">	NamePrivate = InName;</span><br><span class="line">	EInternalObjectFlags InternalFlagsToSet = InSetInternalFlags;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">IsInGameThread</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		InternalFlagsToSet |= EInternalObjectFlags::Async;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (ObjectFlags &amp; RF_MarkAsRootSet)</span><br><span class="line">	&#123;		</span><br><span class="line">		InternalFlagsToSet |= EInternalObjectFlags::RootSet;</span><br><span class="line">		ObjectFlags &amp;= ~RF_MarkAsRootSet;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (ObjectFlags &amp; RF_MarkAsNative)</span><br><span class="line">	&#123;</span><br><span class="line">		InternalFlagsToSet |= EInternalObjectFlags::Native;</span><br><span class="line">		ObjectFlags &amp;= ~RF_MarkAsNative;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// ç»™Objectåˆ†é…ä¸€ä¸ª &quot;Index&quot;ï¼Œä»¥ä¾¿ &quot;GUObjectArray&quot; èƒ½é€šè¿‡ &quot;IndexToObject&quot; æ‰¾åˆ°è¿™ä¸ªObjectï¼Œå¹¶é‡æ–°è®¾ç½®è¯¥Objectçš„Flags</span></span><br><span class="line">	<span class="built_in">AllocateUObjectIndexForCurrentThread</span>(<span class="keyword">this</span>);</span><br><span class="line">	<span class="built_in">check</span>(InName != NAME_None &amp;&amp; InternalIndex &gt;= <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (InternalFlagsToSet != EInternalObjectFlags::None)</span><br><span class="line">	&#123;</span><br><span class="line">		GUObjectArray.<span class="built_in">IndexToObject</span>(InternalIndex)-&gt;<span class="built_in">SetFlags</span>(InternalFlagsToSet);</span><br><span class="line">	&#125;	</span><br><span class="line">    <span class="comment">// &quot;HashObject&quot; æ˜¯å¯¹ &quot;FUObjectHashTable&quot; å•ä¾‹çš„æ“ä½œï¼Œé‡è¦ï¼ä¸‹æ–‡åˆ†æ</span></span><br><span class="line">	<span class="built_in">HashObject</span>(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>åœ¨åˆ†æ &quot;HashObject&quot; ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç®€å•äº†è§£ä¸€ä¸‹ &quot;FUObjectHashTables&quot; ç±»çš„ä½œç”¨å’Œå†…éƒ¨ç»“æ„ã€‚</p><p><img data-src="FUObjectHashTables.png" alt="FUObjectHashTables"></p><p>&quot;FUObjectHashTables&quot; æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œä¸‹é¢çš„ &quot;Get&quot; å‡½æ•°æ˜¯ç”¨æ¥è·å–å…¨å±€å”¯ä¸€çš„å•ä¾‹çš„ã€‚å…¶å±æ€§åŒ…æ‹¬ï¼š</p><ul><li>FHashBucketï¼šç‰¹æ®Šçš„æ•£åˆ—å­˜å‚¨æ¡¶ä»¥èŠ‚çœå†…å­˜ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ª &quot;UObject&quot; æˆ–ä¸€ä¸ª &quot;TSet&quot;</li><li>TMap&lt;int32, FHashBucket&gt; Hashï¼šä¸€ä¸ªæ ‡å‡†çš„å“ˆå¸Œè¡¨ï¼Œ&quot;key&quot; æ˜¯é€šè¿‡ &quot;FName&quot; è®¡ç®—å‡ºæ¥çš„å“ˆå¸Œå€¼ï¼Œ&quot;value&quot; æ˜¯ä¸€ä¸ªå“ˆå¸Œæ¡¶ï¼Œå­˜ç€ä¸€ä¸ª &quot;UObject&quot; æˆ– &quot;TSet&quot; (å¤æ‚æ•°æ®ç»“æ„)ï¼Œè¿™ä¸ª &quot;Hash&quot; TMap ä¼šæŠŠæˆ‘ä»¬æ³¨å†Œçš„æ‰€æœ‰ &quot;UObject&quot; ç»™å­˜èµ·æ¥ï¼Œç”¨äºåå°„</li><li>TMultiMap&lt;int32, class UObjectBase*&gt; HashOuterï¼šå¯¹åº”äº &quot;Hash&quot;ï¼Œæ³¨å†Œ &quot;UObject&quot; æ—¶ï¼Œä¼šå¯¹åº”çš„å¾€ &quot;HashOuter&quot; é‡Œé¢æ·»åŠ ä¸€æ¡è®°å½•ï¼Œ&quot;key&quot; ä¸º è¯¥å¯¹è±¡çš„ &quot;Outer&quot; çš„å“ˆå¸Œå€¼ï¼Œ&quot;value&quot; ä¸ºè¯¥å¯¹è±¡è‡ªèº«</li><li>TMap&lt;UObjectBase*, FHashBucket&gt; ObjectOuterMapï¼šæ¯ä¸ª &quot;Outer&quot; éƒ½ä¼šåœ¨è¿™ä¸ª &quot;TMap&quot; ä¸­ï¼Œä»¥è‡ªå·±ä½œä¸º &quot;key&quot;ï¼Œç”Ÿæˆä¸€ä¸ª &quot;FHashBucket&quot;ï¼Œå¦‚æœæœ‰ &quot;UObject&quot; éœ€è¦æ³¨å†Œæ—¶ï¼Œä¼šå¾€å¯¹åº”çš„ &quot;Outer&quot; çš„æ¡¶é‡Œé¢ï¼ŒæŠŠè‡ªå·±æ·»åŠ è¿›å»</li><li>TMap&lt;UClass*, FHashBucket&gt; ClassToObjectListMapï¼šæ¯ä¸ª &quot;UClass&quot; éƒ½ä¼šåœ¨è¿™ä¸ª &quot;TMap&quot; ä¸­ï¼Œä»¥è‡ªå·±ä½œä¸º &quot;key&quot;ï¼Œç”Ÿæˆä¸€ä¸ª &quot;FHashBucket&quot;ï¼Œå¦‚æœæœ‰ &quot;UObject&quot; éœ€è¦æ³¨å†Œæ—¶ï¼Œä¼šå¾€å¯¹åº”çš„ &quot;UClass&quot; çš„æ¡¶é‡Œé¢ï¼ŒæŠŠè‡ªå·±æ·»åŠ è¿›å»</li><li>TMap&lt;UClass*, TSet&lt;UClass*&gt;&gt; ClassToChildListMapï¼šæ¯ä¸ª &quot;UClass&quot; éƒ½ä¼šåœ¨è¿™ä¸ª &quot;TMap&quot; ä¸­ï¼Œä»¥è‡ªå·±ä½œä¸º &quot;key&quot;ï¼Œç”Ÿæˆä¸€ä¸ª &quot;TSet&lt;UClass&gt;&quot; å®¹å™¨ï¼Œå¦‚æœæœ‰ &quot;UObject&quot; éœ€è¦æ³¨å†Œæ—¶ï¼Œä¼šå¾€å¯¹åº”çš„ &quot;USuperClass&quot; çš„å®¹å™¨ä¸­ï¼ŒæŠŠè‡ªå·±çš„ &quot;UClass&quot; æ·»åŠ è¿›å» (å¦‚æœä¹‹å‰æ²¡æœ‰æ·»åŠ è¿‡)</li><li>TAtomic&lt;uint64&gt; ClassToChildListMapVersionï¼šæ¯æ¬¡æ›´æ–° &quot;ClassToChildListMap&quot; (åŒ…æ‹¬æ·»åŠ å’Œåˆ é™¤å…ƒç´ )ï¼Œè¿™ä¸ª &quot;Version&quot; éƒ½ä¼šè‡ªå¢</li><li>TMap&lt;UPackage*, FHashBucket&gt; PackageToObjectListMapï¼šæ¯ä¸ª &quot;UClass&quot; éƒ½ä¼šåœ¨è¿™ä¸ª &quot;TMap&quot; ä¸­ï¼Œä»¥è‡ªå·±ä½œä¸º &quot;key&quot;ï¼Œç”Ÿæˆä¸€ä¸ª &quot;FHashBucket&quot; ï¼Œå¦‚æœæœ‰ &quot;UObject&quot; éœ€è¦åˆ›å»ºæ—¶ï¼Œä¼šå¾€å¯¹åº”çš„ &quot;FHashBucket&quot; çš„å®¹å™¨ä¸­ï¼ŒæŠŠè‡ªå·±æ·»åŠ è¿›å»</li><li>TMap&lt;UObjectBase*, UPackage*&gt; ObjectToPackageMapï¼š&quot;UObject*&quot; åˆ° &quot;UPackage*&quot; çš„æ˜ å°„</li></ul><p>è¿™äº›å®¹å™¨éƒ½æ˜¯ç”¨äºå…¨å±€æŸ¥æ‰¾ &quot;UObject&quot; çš„å„ç§å±æ€§ï¼Œæ— ç–‘æ˜¯ä¸ºäº†æ‰©å±• &quot;UObject&quot; çš„åå°„åŠŸèƒ½çš„ä¸€ä¸ªç±»ï¼Œç±»å†…çš„å‡½æ•°ï¼ŒåŒ…æ‹¬ &quot;UObjectBase.cpp&quot; ä¸­çš„å¾ˆå¤šå‡½æ•°éƒ½æ˜¯ä¸ºè¿™äº›å®¹å™¨æœåŠ¡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ³¨å†Œ &quot;UClass&quot; æ—¶ï¼Œå¾ˆæœ‰å¿…è¦å°†å…¶æ·»åŠ åˆ° &quot;FUObjectHashTable&quot; ä¸­ã€‚</p><h4 id="hashobject"><a class="anchor" href="#hashobject">#</a> HashObject</h4><p></p><figure class="highlight c++"><figcaption><span>HashObject</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObejctHash.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HashObject</span><span class="params">(UObjectBase* Object)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	FName Name = Object-&gt;<span class="built_in">GetFName</span>();</span><br><span class="line">	<span class="keyword">if</span> (Name != NAME_None)</span><br><span class="line">	&#123;</span><br><span class="line">		int32 Hash = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– &quot;UObjectHashTable&quot; å•ä¾‹ï¼Œå¹¶ä¸Šé”</span></span><br><span class="line">		FUObjectHashTables&amp; ThreadHash = FUObjectHashTables::<span class="built_in">Get</span>();</span><br><span class="line">		<span class="function">FHashTableLock <span class="title">HashLock</span><span class="params">(ThreadHash)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¡ç®—å½“å‰ Object çš„ &quot;Hash&quot; é”®</span></span><br><span class="line">		Hash = <span class="built_in">GetObjectHash</span>(Name);</span><br><span class="line">        <span class="comment">// å°†è¿™ä¸ªå¯¹è±¡æ·»åŠ åˆ° &quot;FUObjectHashTables&quot; å•ä¾‹çš„TMap &quot;Hash&quot; ä¸­</span></span><br><span class="line">		ThreadHash.<span class="built_in">AddToHash</span>(Hash, Object);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœè¯¥ Object å­˜åœ¨ &quot;Outer&quot;</span></span><br><span class="line">		<span class="keyword">if</span> (PTRINT Outer = (PTRINT)Object-&gt;<span class="built_in">GetOuter</span>())</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// å°†è¿™ä¸ªå¯¹è±¡æ·»åŠ åˆ° &quot;FUObjectHashTables&quot; å•ä¾‹çš„ &quot;HashOuter&quot; ä¸­</span></span><br><span class="line">			Hash = <span class="built_in">GetObjectOuterHash</span>(Name, Outer);</span><br><span class="line">			ThreadHash.HashOuter.<span class="built_in">Add</span>(Hash, Object);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†è¿™ä¸ªå¯¹è±¡æ·»åŠ åˆ° &quot;FUObjectHashTables&quot; å•ä¾‹çš„ &quot;ObjectOuterMap&quot; ä¸­</span></span><br><span class="line">			<span class="built_in">AddToOuterMap</span>(ThreadHash, Object);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†è¿™ä¸ªå¯¹è±¡æ·»åŠ åˆ° &quot;FUObjectHashTables&quot; å•ä¾‹çš„ &quot;ClassToObjectListMap&quot; å’Œ &quot;ClassToChildListMap&quot; ä¸­</span></span><br><span class="line">		<span class="built_in">AddToClassMap</span>( ThreadHash, Object );</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>æ²¡é”™ï¼Œ&quot;HashObject&quot; è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸ºäº†ç»´æŠ¤ &quot;UObjectHashTables&quot; ä¸­çš„å…¨å±€ TMap çš„ã€‚å…¶å®åˆ°è¿™é‡Œï¼Œå’± &quot;UClass&quot; çš„åˆå§‹åŒ–å·²ç»å®Œæˆä¸€å¤§åŠäº†ã€‚ä½†å‰©ä¸‹çš„æ³¨å†Œå·¥ä½œï¼Œå¯¹äº &quot;UClass&quot; çš„åå°„ç³»ç»Ÿä¹Ÿæ˜¯å°¤ä¸ºé‡è¦çš„ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬çš„ &quot;CDO&quot; å’Œ &quot;TokenStream&quot;(GC) äº†ï¼ˆæ¯•ç«Ÿæ˜¯åœºé•¿é€”æ—…è¡Œï¼Œæ€ä¹ˆå¯èƒ½è¿™ä¹ˆå¿«ç»“æŸå˜›ï½ï½ï½</p><h3 id="åå¤„ç†æ³¨å†Œçš„ååŠéƒ¨åˆ†"><a class="anchor" href="#åå¤„ç†æ³¨å†Œçš„ååŠéƒ¨åˆ†">#</a> åå¤„ç†ï¼ˆæ³¨å†Œçš„ååŠéƒ¨åˆ†ï¼‰</h3><p>&quot;UClass&quot; çš„åå¤„ç†æ˜¯åœ¨ &quot;<strong>ProcessNewlyLoadedUObjects</strong>&quot; ä¸­è¿›è¡Œçš„ï¼Œå…¶è°ƒç”¨é“¾ä¸º</p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">WinMain</span>() -&gt; <span class="built_in">GuardedMain</span>() -&gt; <span class="built_in">EnginePreInit</span>() -&gt; FEngineLoop::<span class="built_in">PreInit</span>() -&gt; <span class="built_in">PreInitPostStartupScreen</span>() -&gt; <span class="built_in">ProcessNewlyLoadedUObjects</span>()</span><br></pre></td></tr></table></figure><p></p><p>å¯ä»¥çœ‹å‡ºï¼Œåå¤„ç†å…¶å®æ˜¯åœ¨ &quot;PreInit&quot; çš„ååŠéƒ¨åˆ† &quot;PreInitPostStartupScreen&quot; è¿›è¡Œçš„ï¼Œä¹‹å‰çš„æ³¨å†Œéƒ½æ˜¯åœ¨å‰åŠéƒ¨åˆ† &quot;PreInitPreStartupScreen&quot; å®Œæˆçš„ã€‚ç†æ¸…æ¥šäº†åå¤„ç†æ‰§è¡Œçš„æ—¶é—´ç‚¹ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹åå¤„ç†éƒ½åšäº†ä»€ä¹ˆå§ï½ï½ï½</p><h4 id="processnewlyloadeduobjects"><a class="anchor" href="#processnewlyloadeduobjects">#</a> ProcessNewlyLoadedUObjects</h4><p></p><figure class="highlight c++"><figcaption><span>ProcessNewlyLoadedUObjects</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectBase.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ProcessNewlyLoadedUObjects</span><span class="params">(FName Package, <span class="keyword">bool</span> bCanProcessNewlyLoadedObjects)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// &quot;UClass&quot; çš„æ³¨å†Œé˜¶æ®µï¼Œå‰æ–‡åˆ†æè¿‡äº†</span></span><br><span class="line">	<span class="built_in">UClassRegisterAllCompiledInClasses</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æ˜¯å¦æœ‰æ–°æ”¶é›†åˆ°çš„ &quot;UClass&quot; æˆ– &quot;UStruct&quot; æˆ– &quot;UEnum&quot;ï¼Œæœ‰åˆ™å¯¹å…¶è¿›è¡Œå¤„ç†</span></span><br><span class="line">	<span class="keyword">const</span> TArray&lt;UClass* (*)()&gt;&amp; DeferredCompiledInRegistration = <span class="built_in">GetDeferredCompiledInRegistration</span>();</span><br><span class="line">	<span class="keyword">const</span> TArray&lt;FPendingStructRegistrant&gt;&amp; DeferredCompiledInStructRegistration = <span class="built_in">GetDeferredCompiledInStructRegistration</span>();</span><br><span class="line">	<span class="keyword">const</span> TArray&lt;FPendingEnumRegistrant&gt;&amp; DeferredCompiledInEnumRegistration = <span class="built_in">GetDeferredCompiledInEnumRegistration</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> bNewUObjects = <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">while</span> (GFirstPendingRegistrant || DeferredCompiledInRegistration.<span class="built_in">Num</span>() || DeferredCompiledInStructRegistration.<span class="built_in">Num</span>() || DeferredCompiledInEnumRegistration.<span class="built_in">Num</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		bNewUObjects = <span class="literal">true</span>;		<span class="comment">// æ ‡è®°æœ‰æ–°UObjectç”Ÿæˆï¼Œç”¨äºåé¢å¼•ç”¨è®°å·æµçš„åˆ›å»º</span></span><br><span class="line">		<span class="built_in">UObjectProcessRegistrants</span>();	<span class="comment">// å»¶è¿Ÿæ³¨å†ŒUObjectsï¼Œå‰æ–‡åˆ†æè¿‡äº†</span></span><br><span class="line">		<span class="built_in">UObjectLoadAllCompiledInStructs</span>();	<span class="comment">// æ³¨å†ŒUEnumï¼Œè®¾ç½®å†…éƒ¨å•ä¾‹ç­‰</span></span><br><span class="line">		<span class="built_in">UObjectLoadAllCompiledInDefaultProperties</span>(); <span class="comment">// åˆå§‹åŒ–å±æ€§é“¾ç­‰ï¼Œåˆ›å»ºCDOï¼Œè¯¦è§ä¸‹æ–‡</span></span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å½“å‰å¤„äº &quot;EngineLoop::PreInit&quot; é˜¶æ®µï¼Œæ‰€ä»¥GIsInitialLoadä¸ºtureï¼Œä¸‹é¢è¿™ä¸ªå‡½æ•°å¹¶ä¸ä¼šæ‰§è¡Œï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯è¦å¯¹å…¶è¿›è¡Œåˆ†æçš„ï¼Œä»¥ä¾¿å’±å¯¹è¿™ä¸ªå‡½æ•°æœ‰æ›´ä¸ºå…¨é¢çš„ç†è§£</span></span><br><span class="line">	<span class="keyword">if</span> (bNewUObjects &amp;&amp; !GIsInitialLoad)</span><br><span class="line">	&#123;</span><br><span class="line">		UClass::<span class="built_in">AssembleReferenceTokenStreams</span>();	<span class="comment">// ä¸º &quot;UClass&quot; åˆ›å»ºå¼•ç”¨è®°å·æµï¼Œè¯¦è§ä¸‹æ–‡</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>å’‹ä¸€çœ‹ï¼Œå¥½åƒè¿™ä¸€æ­¥åªåšäº†ä¸‰ä»¶äº‹ï¼Œç»§ç»­åˆå§‹åŒ– &quot;UClass&quot; çš„ç›¸å…³å±æ€§ï¼Œåˆ›å»º CDO å’Œæ„å»º TokenStreamsã€‚ä½†å…¶å®è¿™ä¸€æ­¥è¿˜æŠŠä¹‹å‰çš„æ³¨å†Œå’Œå»¶è¿Ÿæ³¨å†Œä¹ŸåŒ…å«è¿›å»äº†ã€‚æ‰€ä»¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ³¨å†Œæ­¥éª¤ã€‚åªè¦ä½ åœ¨æ”¶é›†é˜¶æ®µæ”¶é›†åˆ°ä¸€ä¸ª &quot;UClass&quot; å†è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œéƒ½æ˜¯å¯ä»¥ä¸€æ¡é¾™å®Œæˆæ³¨å†Œçš„ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆä¸€æ¡å¯ä»¥å¤„ç†æ‰€æœ‰æ³¨å†Œä»»åŠ¡çš„å‡½æ•°ï¼Ÿç«Ÿç„¶æœ‰è¿™ä¹ˆä¸€æ¡å‡½æ•°ï¼Œä¸ºä»€ä¹ˆä¹‹å‰è¿˜è¾›è¾›è‹¦è‹¦æŠŠæ³¨å†Œçš„æ­¥éª¤æ‹†å¼€æ¥å®Œæˆï¼Ÿ</p><p>åŸå› æ€»ç»“èµ·æ¥æœ‰ä¸‰ç‚¹ï¼š</p><ol><li>é¦–å…ˆï¼Œæˆ‘ä»¬ä¹‹å‰è®²å¾—éƒ½æ˜¯ &quot;EngineLoop::PreInit&quot; ä¸­çš„æ³¨å†Œï¼Œæ­¤é˜¶æ®µéœ€è¦æ³¨å†Œçš„ &quot;UClass&quot; å¯èƒ½å¾ˆå¤šï¼Œå› ä¸ºå¼•æ“åˆšå¯åŠ¨ï¼Œå¾ˆå¤šåº•å±‚çš„ä¸Šå±‚çš„æ¨¡å—ä¸­çš„ç±»éƒ½éœ€è¦æ³¨å†Œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦åˆ†æ­¥éª¤æ¥å»¶è¿Ÿæ³¨å†Œï¼Œè¿™æ ·å¼•æ“ä¹Ÿèƒ½åŒæ—¶å®Œæˆä¸€äº›å…¶ä»–çš„åˆå§‹åŒ–ä»»åŠ¡ã€‚</li><li>å…¶æ¬¡ï¼Œæˆ‘ä»¬åé¢åŠ¨æ€åŠ è½½è¿›æ¥çš„æ¨¡å—æ˜¯ä¸ä¼šå†è¿›å…¥ PreInit é˜¶æ®µçš„ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸åšä¸€ä¸ªå®Œå…¨å¯ä»¥ä¸€æ¡é¾™æ³¨å†Œ &quot;UClass&quot; çš„å‡½æ•°ï¼Œæ¥å®ŒæˆåŠ¨æ€åŠ è½½çš„æ¨¡å—çš„ç±»çš„ &quot;UClass&quot; çš„æ³¨å†Œ</li><li>æœ€åï¼Œä¹Ÿæ˜¯ä¸ºäº†ç¡®ä¿ &quot;PreInit&quot; é˜¶æ®µä¸­æ³¨å†Œçš„ &quot;UClass&quot; æ²¡æœ‰é—æ¼ï¼Œåæ­£æ³¨å†Œé˜¶æ®µå¤„ç†è¿‡çš„ &quot;UClass&quot; ä¼šè¢«æ¸…ç†æ‰ã€‚å¦‚æœæ²¡æœ‰æ•°æ®é—æ¼ï¼Œå’±ä¹Ÿä¼šç›´æ¥è¿”å›ï¼Œå¹¶ä¸ä¼šäºŒæ¬¡æ³¨å†ŒåŒä¸€ä¸ª &quot;UClass&quot;ã€‚</li></ol><p>å¥½çš„ï¼Œæ¥ä¸‹æ¥è¿›å…¥ &quot;UObjectLoadAllCompiledInDefaultProperties&quot; å’Œ &quot;AssembleReferenceTokenStreams&quot; çš„å‡½æ•°è§£æã€‚</p><h4 id="uobjectloadallcompiledindefaultproperties"><a class="anchor" href="#uobjectloadallcompiledindefaultproperties">#</a> UObjectLoadAllCompiledInDefaultProperties</h4><p></p><figure class="highlight c++"><figcaption><span>UObjectLoadAllCompiledInDefaultProperties</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UObjectBase.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UObjectLoadAllCompiledInDefaultProperties</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> FName <span class="title">LongEnginePackageName</span><span class="params">(TEXT(<span class="string">&quot;/Script/Engine&quot;</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &quot;DeferredCompiledInRegistration&quot; å­˜ç€æ‰€æœ‰ç±»çš„æ„é€ å‡½æ•°ï¼ŒåŒ…æ‹¬å±æ€§é“¾ç­‰çš„åˆå§‹åŒ–</span></span><br><span class="line">	TArray&lt;UClass *(*)()&gt;&amp; DeferredCompiledInRegistration = <span class="built_in">GetDeferredCompiledInRegistration</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">bool</span> bHaveRegistrants = DeferredCompiledInRegistration.<span class="built_in">Num</span>() != <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>( bHaveRegistrants )</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">// åˆ†ç±»æ³¨å†Œï¼Œå…ˆæ³¨å†Œåº•å±‚æ¨¡å— &quot;UClass&quot;ï¼Œå†æ³¨å†Œä¸Šå±‚ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿æ€§èƒ½åˆ†æ</span></span><br><span class="line">		TArray&lt;UClass*&gt; NewClasses;</span><br><span class="line">		TArray&lt;UClass*&gt; NewClassesInCoreUObject;</span><br><span class="line">		TArray&lt;UClass*&gt; NewClassesInEngine;</span><br><span class="line">		TArray&lt;UClass* (*)()&gt; PendingRegistrants = <span class="built_in">MoveTemp</span>(DeferredCompiledInRegistration);</span><br><span class="line">		<span class="keyword">for</span> (UClass* (*Registrant)() : PendingRegistrants)</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// åå¤„ç† &quot;UClass&quot; ä¸­çš„å±æ€§ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶åï¼Œå±æ€§é“¾ç­‰ï¼Œè¯¦è§ä¸Šæ–‡</span></span><br><span class="line">			UClass* Class = <span class="built_in">Registrant</span>();</span><br><span class="line">			<span class="keyword">if</span> (Class-&gt;<span class="built_in">GetOutermost</span>()-&gt;<span class="built_in">GetFName</span>() == GLongCoreUObjectPackageName)</span><br><span class="line">			&#123;</span><br><span class="line">				NewClassesInCoreUObject.<span class="built_in">Add</span>(Class);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (Class-&gt;<span class="built_in">GetOutermost</span>()-&gt;<span class="built_in">GetFName</span>() == LongEnginePackageName)</span><br><span class="line">			&#123;</span><br><span class="line">				NewClassesInEngine.<span class="built_in">Add</span>(Class);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				NewClasses.<span class="built_in">Add</span>(Class);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»º &quot;CoreUObject&quot; æ¨¡å— &quot;UClass&quot; çš„ &quot;CDO&quot;</span></span><br><span class="line">            <span class="keyword">for</span> (UClass* Class : NewClassesInCoreUObject)</span><br><span class="line">			&#123;</span><br><span class="line">                <span class="comment">// &quot;GetDefaultObject&quot; ä¼šåœ¨ä¸‹æ–‡è¿›è¡Œè§£æ</span></span><br><span class="line">				Class-&gt;<span class="built_in">GetDefaultObject</span>();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºå¼•æ“å…¶ä»–æ¨¡å—çš„ &quot;UClass&quot; çš„ &quot;CDO&quot;</span></span><br><span class="line">            <span class="keyword">for</span> (UClass* Class : NewClassesInEngine) </span><br><span class="line">			&#123;</span><br><span class="line">				Class-&gt;<span class="built_in">GetDefaultObject</span>();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæˆ‘ä»¬è‡ªå»ºç±»çš„ &quot;UClass&quot; çš„ &quot;CDO&quot;</span></span><br><span class="line">			<span class="keyword">for</span> (UClass* Class : NewClasses)</span><br><span class="line">			&#123;</span><br><span class="line">				Class-&gt;<span class="built_in">GetDefaultObject</span>();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">		<span class="comment">// çœç•¥æ€§èƒ½åˆ†æçš„éƒ¨åˆ†ä»£ç </span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>è¿™å—ä»£ç ä¹Ÿä¸éš¾ç†è§£ï¼Œå°±æ˜¯åå¤„ç† &quot;UClass&quot; ä¸­çš„ä¸€äº›å±æ€§ï¼Œç„¶åç»™ &quot;UClass&quot; åˆ†ç±»ï¼ŒæŒ‰åº•å±‚åˆ°ä¸Šå±‚çš„é¡ºåºåˆ›å»º &quot;CDO&quot; å˜›ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿå…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯ï¼Œä¾èµ–å…³ç³»ã€‚ä¸Šå±‚ç±»ä¾èµ–åº•å±‚ç±»ï¼Œåœ¨åˆ›å»º &quot;CDO&quot; æ—¶å¯èƒ½ä¼šç”¨åˆ°åŸºç±»æˆ–è€…åŒ…çš„ &quot;CDO&quot;ï¼Œå¦‚æœè¿™äº›è¢«ä¾èµ–çš„ç±»çš„ &quot;CDO&quot; èƒ½åœ¨è¿™ä¹‹å‰å°±æ„é€ ï¼Œå­ç±» &quot;CDO&quot; çš„åˆ›å»ºä¹Ÿä¼šæ–¹ä¾¿ä¸å°‘ã€‚è¿˜æœ‰å°±æ˜¯ä¸ºäº†æ–¹ä¾¿å¯¹æ¯ç§åˆ†ç±»åˆ›å»º &quot;CDO&quot; è¿›è¡Œæ€§èƒ½åˆ†æï¼Œè¿™å—ä»£ç å’±çœç•¥æ‰äº†ã€‚æ¥ä¸‹æ¥å»çœ‹çœ‹æ€ä¹ˆåˆ›å»º &quot;CDO&quot; çš„å§ )</p><h4 id="getdefaultobject"><a class="anchor" href="#getdefaultobject">#</a> GetDefaultObject</h4><p></p><figure class="highlight c++"><figcaption><span>GetDefaultObject</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Class.h</span></span><br><span class="line"></span><br><span class="line"><span class="function">UObject* <span class="title">GetDefaultObject</span><span class="params">(<span class="keyword">bool</span> bCreateIfNeeded = <span class="literal">true</span>)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// æ²¡æœ‰æ‰åˆ›å»ºï¼Œæœ‰åˆ™ç›´æ¥è¿”å›ã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (ClassDefaultObject == <span class="literal">nullptr</span> &amp;&amp; bCreateIfNeeded)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">const_cast</span>&lt;UClass*&gt;(<span class="keyword">this</span>)-&gt;<span class="built_in">CreateDefaultObject</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ClassDefaultObject;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">UObject* <span class="title">UClass::CreateDefaultObject</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> ( ClassDefaultObject == <span class="literal">NULL</span> )</span><br><span class="line">	&#123;</span><br><span class="line">		UClass* ParentClass = <span class="built_in">GetSuperClass</span>();</span><br><span class="line">		UObject* ParentDefaultObject = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">if</span> ( ParentClass != <span class="literal">NULL</span> )</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå­˜åœ¨çˆ¶ç±»ï¼Œç¡®ä¿çˆ¶ç±»å·²æ³¨å†Œ</span></span><br><span class="line">			<span class="built_in">UObjectForceRegistration</span>(ParentClass);</span><br><span class="line">            <span class="comment">// ç¡®ä¿çˆ¶ç±»å·²ç»æœ‰CDOï¼Œè¿™ä¸€æ­¥æ˜¯ä¼šé€’å½’åœ°åˆ›å»ºå…¶çˆ¶ç±»çš„çˆ¶ç±»çš„ &quot;CDO&quot; çš„</span></span><br><span class="line">			ParentDefaultObject = ParentClass-&gt;<span class="built_in">GetDefaultObject</span>(); </span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰ &quot;UClass&quot; æ˜¯ &quot;UObject&quot;ï¼Œæˆ–è€…è¯¥ç±»æ²¡æœ‰çˆ¶ç±»</span></span><br><span class="line">		<span class="keyword">if</span> ( (ParentDefaultObject != <span class="literal">NULL</span>) || (<span class="keyword">this</span> == UObject::<span class="built_in">StaticClass</span>()) )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// å¦‚æœè¿™æ˜¯ä¸€ä¸ªè“å›¾ç±»çš„ &quot;UClass&quot;ï¼Œåˆ™å¯èƒ½æ˜¯æ²¡æœ‰å®Œå…¨åŠ è½½è¿›æ¥ã€‚åœ¨æ­¤è°ƒç”¨ &quot;Preload&quot; å’Œ &quot;StaticLink&quot; ä»¥ç¡®ä¿æ­£ç¡®åœ°ä¸ºCDOè®¾ç½®é›¶å†…å­˜å’Œè¯»å…¥å±æ€§</span></span><br><span class="line">            <span class="keyword">if</span>( <span class="built_in">HasAnyClassFlags</span>(CLASS_CompiledFromBlueprint) &amp;&amp; (PropertyLink == <span class="literal">NULL</span>) &amp;&amp; !GIsDuplicatingClassForReinstancing)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">auto</span> ClassLinker = <span class="built_in">GetLinker</span>();</span><br><span class="line">				<span class="keyword">if</span> (ClassLinker &amp;&amp; !ClassLinker-&gt;bDynamicClassLinker)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span> (!GEventDrivenLoaderEnabled)</span><br><span class="line">					&#123;</span><br><span class="line">						UField* FieldIt = Children;</span><br><span class="line">						<span class="keyword">while</span> (FieldIt &amp;&amp; (FieldIt-&gt;<span class="built_in">GetOuter</span>() == <span class="keyword">this</span>))</span><br><span class="line">						&#123;</span><br><span class="line">							<span class="comment">// å¦‚æœç±»ä¹‹é—´å­˜åœ¨å¾ªç¯ä¾èµ–å…³ç³»ï¼Œåˆ™å¯èƒ½éœ€è¦é¢„åŠ è½½ä»¥ç¡®ä¿èƒ½åŠ è½½å®Œæ‰€æœ‰ä¾èµ–å­—æ®µ</span></span><br><span class="line">							<span class="keyword">if</span> (FieldIt-&gt;<span class="built_in">HasAnyFlags</span>(RF_NeedLoad))</span><br><span class="line">							&#123;</span><br><span class="line">                                <span class="comment">// å­—æ®µé¢„åŠ è½½ï¼Œä¸å±•å¼€</span></span><br><span class="line">								ClassLinker-&gt;<span class="built_in">Preload</span>(FieldIt);</span><br><span class="line">							&#125;</span><br><span class="line">							FieldIt = FieldIt-&gt;Next;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="comment">// å¤„ç† &quot;UClass&quot; çš„å±æ€§é“¾ï¼Œç•™åˆ°åˆ«çš„æ–‡ç« è§£æ</span></span><br><span class="line">					<span class="built_in">StaticLink</span>(<span class="literal">true</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// åœ¨å¾ªç¯ä¾èµ–çš„æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„ &quot;Preload&quot; è°ƒç”¨å¯èƒ½ä¼šè‡ªå·±è°ƒç”¨æ­¤æ–¹æ³•</span></span><br><span class="line">            <span class="comment">// è¿™æ„å‘³ç€ä¸€æ—¦å®Œæˆäº†æ‰€æœ‰ &quot;Preload&quot; è°ƒç”¨ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ &quot;CDO&quot; ä»ç„¶ä¸ºNULLï¼Œä»¥ä¿è¯æˆ‘ä»¬ä¸ä¼šä½¿å·²è®¾ç½®çš„ &quot;CDO&quot; æ— æ•ˆ</span></span><br><span class="line">            <span class="keyword">if</span> (ClassDefaultObject == <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				FString PackageName;</span><br><span class="line">				FString CDOName;</span><br><span class="line">				<span class="keyword">bool</span> bDoNotify = <span class="literal">false</span>;</span><br><span class="line">                <span class="comment">// å¦‚æœå¯ä»¥åŠ è½½ &quot;CDO&quot;ï¼Œåˆ™åˆå§‹åŒ–åŒ…åå’ŒCDOåç­‰</span></span><br><span class="line">				<span class="keyword">if</span> (GIsInitialLoad &amp;&amp; <span class="built_in">GetOutermost</span>()-&gt;<span class="built_in">HasAnyPackageFlags</span>(PKG_CompiledIn) &amp;&amp; !<span class="built_in">GetOutermost</span>()-&gt;<span class="built_in">HasAnyPackageFlags</span>(PKG_RuntimeGenerated))</span><br><span class="line">				&#123;</span><br><span class="line">					PackageName = <span class="built_in">GetOutermost</span>()-&gt;<span class="built_in">GetFName</span>().<span class="built_in">ToString</span>();</span><br><span class="line">					CDOName = <span class="built_in">GetDefaultObjectName</span>().<span class="built_in">ToString</span>();</span><br><span class="line">					<span class="built_in">NotifyRegistrationEvent</span>(*PackageName, *CDOName, ENotifyRegistrationType::NRT_ClassCDO, ENotifyRegistrationPhase::NRP_Started);</span><br><span class="line">					bDoNotify = <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">// &quot;RF_ArchetypeObject&quot; æ ‡å¿—é€šå¸¸å¯¹ &quot;RF_ClassDefaultObject&quot; æ˜¯å†—ä½™çš„ï¼Œ</span></span><br><span class="line">                <span class="comment">// ä½†æ˜¯æˆ‘ä»¬éœ€è¦å°† &quot;CDO&quot; æ ‡è®°ä¸º &quot;RF_ArchetypeObject&quot;ï¼Œä»¥ä¾¿å°†è¯¥æ ‡å¿—ä¼ æ’­åˆ°ä»»ä½•é»˜è®¤å­å¯¹è±¡ã€‚</span></span><br><span class="line">				ClassDefaultObject = <span class="built_in">StaticAllocateObject</span>(<span class="keyword">this</span>, <span class="built_in">GetOuter</span>(), NAME_None, <span class="built_in">EObjectFlags</span>(RF_Public|RF_ClassDefaultObject|RF_ArchetypeObject));</span><br><span class="line">				<span class="built_in">check</span>(ClassDefaultObject);</span><br><span class="line">				<span class="comment">// è“å›¾ &quot;CDO&quot; æœ‰å±æ€§å§‹ç»ˆä¼šè¢«åˆå§‹åŒ–(ç”¨äºåé¢CDOçš„æ„é€ å‡½æ•°)</span></span><br><span class="line">				<span class="keyword">const</span> <span class="keyword">bool</span> bShouldInitializeProperties = !<span class="built_in">HasAnyClassFlags</span>(CLASS_Native | CLASS_Intrinsic);</span><br><span class="line">				<span class="comment">// å°†æ­¤ç±»å¼•å…¥çš„æ‰€æœ‰ç¨€ç–ä»£ç†çš„åç§»é‡æ³¨å†Œåˆ°ç¨€ç–ä»£ç†å­˜å‚¨ä¸­(æ”¾åˆ°ä»£ç†çš„æ–‡ç« é‡Œé¢è§£æï¼Œåªéœ€è¦çŸ¥é“åœ¨è¿™ä¸ªæ—¶å€™æ³¨å†Œå³å¯)</span></span><br><span class="line">				<span class="keyword">for</span> (TFieldIterator&lt;FMulticastSparseDelegateProperty&gt; <span class="built_in">SparseDelegateIt</span>(<span class="keyword">this</span>, EFieldIteratorFlags::ExcludeSuper, EFieldIteratorFlags::ExcludeDeprecated); SparseDelegateIt; ++SparseDelegateIt)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">const</span> FSparseDelegate&amp; SparseDelegate = SparseDelegateIt-&gt;<span class="built_in">GetPropertyValue_InContainer</span>(ClassDefaultObject);</span><br><span class="line">					USparseDelegateFunction* SparseDelegateFunction = CastChecked&lt;USparseDelegateFunction&gt;(SparseDelegateIt-&gt;SignatureFunction);</span><br><span class="line">					FSparseDelegateStorage::<span class="built_in">RegisterDelegateOffset</span>(ClassDefaultObject, SparseDelegateFunction-&gt;DelegateName, (<span class="keyword">size_t</span>)&amp;SparseDelegate - (<span class="keyword">size_t</span>)ClassDefaultObject);</span><br><span class="line">				&#125;</span><br><span class="line">                <span class="comment">// å¦‚æœæ˜¯è“å›¾ç±» &quot;UClass&quot; åˆ™åˆå§‹åŒ–åŠ¨æ€ç±»çš„ç›¸å…³å±æ€§</span></span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">HasAnyClassFlags</span>(CLASS_CompiledFromBlueprint))</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span> (UDynamicClass* DynamicClass = Cast&lt;UDynamicClass&gt;(<span class="keyword">this</span>))</span><br><span class="line">					&#123;</span><br><span class="line">						(*(DynamicClass-&gt;DynamicClassInitializer))(DynamicClass);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">                <span class="comment">// æ„é€ ä¸€ä¸ª &quot;CDO&quot;ï¼Œ&quot;ClassConstructor&quot; å…¶å®å°±æ˜¯æˆ‘ä»¬ &quot;GENERATED_BODY()&quot; é‡Œé¢ï¼Œ&quot;UHT&quot; ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„æ„é€ å‡½æ•°åŒ…è£…å™¨ï¼Œæ˜¯ä¸€ä¸ªè£…ç€è¯¥ç±»çš„æ„é€ å‡½æ•°çš„å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">				(*ClassConstructor)(<span class="built_in">FObjectInitializer</span>(ClassDefaultObject, ParentDefaultObject, <span class="literal">false</span>, bShouldInitializeProperties));</span><br><span class="line">				<span class="keyword">if</span> (bDoNotify)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">NotifyRegistrationEvent</span>(*PackageName, *CDOName, ENotifyRegistrationType::NRT_ClassCDO, ENotifyRegistrationPhase::NRP_Finished);</span><br><span class="line">				&#125;</span><br><span class="line">                <span class="comment">// &quot;CDO&quot; çš„åå¤„ç†ï¼Œè™šå‡½æ•°ï¼Œå¯ä»¥é‡è½½æ¥å¤„ç†æ›´å¤šçš„é€»è¾‘</span></span><br><span class="line">				ClassDefaultObject-&gt;<span class="built_in">PostCDOContruct</span>();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ClassDefaultObject;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>æ€»ç»“èµ·æ¥å°±æ˜¯ï¼Œ<strong>å¼•æ“ä¼šå…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦åˆ›å»º &quot;CDO&quot;ï¼Œéœ€è¦åˆ™ä¼˜å…ˆåˆ›å»ºé€’å½’åˆ›å»ºæ‰€æœ‰åŸºç±»çš„ &quot;CDO&quot; (å¦‚æœæ²¡æœ‰)ã€‚å¦‚æœæ²¡æœ‰åŸºç±»ï¼Œæˆ–è€…è¯¥å¯¹è±¡çš„ &quot;UClass&quot; å°±æ˜¯ &quot;UObject&quot;ï¼ˆè“å›¾åˆ›å»ºçš„ç±»æ²¡æœ‰åŠ è½½å®Œä¹Ÿæ˜¯ &quot;UObject&quot;ï¼Œè¦è°ƒç”¨ &quot;Preload&quot; å’Œ &quot;Link&quot; ä½¿å…¶å®ŒæˆåŠ è½½ï¼‰ï¼Œæœ€åå°±æ˜¯ä¸º &quot;CDO&quot; ç”³è¯·å†…å­˜ï¼Œæ³¨å†Œä»£ç†ï¼Œæ„é€  &quot;CDO&quot;ï¼Œå½“ç„¶è¿˜æœ‰é¢„ç•™çš„åå¤„ç†æ¥å£ã€‚</strong></p><p>æœ€åæ˜¯åˆ›å»º &quot;å¼•ç”¨æµæ ‡è®°&quot;ï¼Œå†æé†’ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ³¨å†Œ &quot;UClass&quot; çš„æ—¶å€™æ˜¯ä¸ä¼šåˆ›å»º &quot;TokenStream&quot; çš„ï¼Œ&quot;UClass::AssembleReferenceTokenStreams&quot; ä¼šåœ¨è®©åç»­çš„ &quot;GUObjectArray.CloseDisregardForGC&quot; ä¸­è§¦å‘ï¼Œè¿™é‡Œä¹‹æ‰€ä»¥è¦åŠ è¿™ä¸€æ­¥ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬çš„ &quot;ProcessNewlyLoadedUObjects&quot; å‡½æ•°æ˜¯å¯ä»¥ç”¨äºæ¨¡å—åŠ¨æ€åŠ è½½æ—¶æ³¨å†Œ &quot;UClass&quot; çš„ï¼Œè€ŒåŠ¨æ€åŠ è½½æ—¶æ˜¯ä¼šç›´æ¥åˆ›å»ºå¼•ç”¨æµæ ‡è®°çš„ã€‚å¥½çš„ï¼Œè®©æˆ‘ä»¬å¼€å§‹æœ€åä¸€è½®è§£æå§ï½ï½ï½ï¼ˆæœ€åä¸€æ­¥å•¦ï¼Œæœ‰ç‚¹ä¸èˆ...</p><h4 id="assemblereferencetokenstreams"><a class="anchor" href="#assemblereferencetokenstreams">#</a> AssembleReferenceTokenStreams</h4><p></p><figure class="highlight c++"><figcaption><span>AssembleReferenceTokenStreams</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Class.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UClass::AssembleReferenceTokenStreams</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// éå†æ‰€æœ‰ &quot;UClass&quot; å¯¹è±¡ï¼Œå¼ºåˆ¶åˆ›å»º &quot;CDO&quot;ï¼Œå†ä¸º &quot;UClass&quot; åˆ›å»ºå¼•ç”¨è®°å·æµ(å¦‚æœæ²¡è£…ä¸Š)</span></span><br><span class="line">    <span class="keyword">for</span> (FRawObjectIterator <span class="built_in">It</span>(<span class="literal">false</span>); It; ++It)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (UClass* Class = Cast&lt;UClass&gt;((UObject*)(It-&gt;Object)))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (!GExitPurge &amp;&amp; !Class-&gt;<span class="built_in">HasAnyFlags</span>(RF_BeingRegenerated))</span><br><span class="line">			&#123;</span><br><span class="line">				Class-&gt;<span class="built_in">GetDefaultObject</span>(); </span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!Class-&gt;<span class="built_in">HasAnyFlags</span>(RF_ClassDefaultObject) &amp;&amp; !Class-&gt;<span class="built_in">HasAnyClassFlags</span>(CLASS_TokenStreamAssembled))</span><br><span class="line">			&#123;</span><br><span class="line">				Class-&gt;<span class="built_in">AssembleReferenceTokenStream</span>();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UClass::AssembleReferenceTokenStream</span><span class="params">(<span class="keyword">bool</span> bForce = <span class="comment">/*false*/</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// Lock for non-native classes</span></span><br><span class="line">	<span class="function">FScopeLockIfNotNative <span class="title">ReferenceTokenStreamLock</span><span class="params">(ReferenceTokenStreamCritical, !(ClassFlags &amp; CLASS_Native))</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯¥ &quot;Class&quot; æ²¡æœ‰åˆ›å»º &quot;TokenStream&quot;ï¼Œæˆ–è€…è¢«è¦æ±‚å¼ºåˆ¶åˆ›å»º</span></span><br><span class="line">	<span class="keyword">if</span> (!<span class="built_in">HasAnyClassFlags</span>(CLASS_TokenStreamAssembled) || bForce)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (bForce)</span><br><span class="line">		&#123;</span><br><span class="line">			ReferenceTokenStream.<span class="built_in">Empty</span>();</span><br><span class="line">			ClassFlags &amp;= ~CLASS_TokenStreamAssembled;</span><br><span class="line">		&#125;</span><br><span class="line">		TArray&lt;<span class="keyword">const</span> FStructProperty*&gt; EncounteredStructProps;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// éå†å®šä¹‰åœ¨è¿™ä¸ªç±»ä¸­çš„æ‰€æœ‰FProperty(æ”¯æŒåå°„çš„å±æ€§)</span></span><br><span class="line">		<span class="keyword">for</span>( TFieldIterator&lt;FProperty&gt; <span class="built_in">It</span>(<span class="keyword">this</span>,EFieldIteratorFlags::ExcludeSuper); It; ++It)</span><br><span class="line">		&#123;</span><br><span class="line">			FProperty* Property = *It;</span><br><span class="line">            <span class="comment">// å°†è¯¥å±æ€§åŠ å…¥åˆ° &quot;UClass&quot; çš„ &quot;ReferenceTOkenStream&quot; (ç”¨äºGCçš„å¼•ç”¨è®°å·æµ)ï¼Œå…¶è°ƒç”¨é“¾ä¸‹æ–‡ä¼šè¿›è¡Œåˆ†æ</span></span><br><span class="line">			Property-&gt;<span class="built_in">EmitReferenceInfo</span>(*<span class="keyword">this</span>, <span class="number">0</span>, EncounteredStructProps);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (UClass* SuperClass = <span class="built_in">GetSuperClass</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// è¿™é‡Œéœ€è¦é”çˆ¶ç±»æµæ˜¯ä¸ºäº†é¿å…å…¶åœ¨æ¸¸æˆçº¿ç¨‹è¢«é‡æ„</span></span><br><span class="line">			<span class="function">FScopeLockIfNotNative <span class="title">SuperClassReferenceTokenStreamLock</span><span class="params">(SuperClass-&gt;ReferenceTokenStreamCritical, !(SuperClass-&gt;ClassFlags &amp; CLASS_Native))</span></span>;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// ç¡®ä¿çˆ¶ç±»çš„ &quot;ReferenceTokenStream&quot; å·²åˆå§‹åŒ–</span></span><br><span class="line">			SuperClass-&gt;<span class="built_in">AssembleReferenceTokenStream</span>();</span><br><span class="line">			<span class="keyword">if</span> (!SuperClass-&gt;ReferenceTokenStream.<span class="built_in">IsEmpty</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">// å°†çˆ¶ç±»çš„ &quot;ReferenceTokenStream&quot; åŠ å…¥åˆ°è‡ªå·±è¿™é‡Œ</span></span><br><span class="line">				ReferenceTokenStream.<span class="built_in">PrependStream</span>(SuperClass-&gt;ReferenceTokenStream);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">// å¦‚æœè¯¥å¯¹è±¡å‚ä¸åå°„ï¼Œè€Œåˆæ²¡æœ‰åŸºç±»å¯¹è±¡ã€‚æƒ³æƒ³ä¼šæ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿé‚£å¿…ç„¶æ˜¯ &quot;UObject&quot; å‘€ï¼Œæ‰€ä»¥ç›´æ¥åŠ åˆ°æ°¸ä¹…å¯¹è±¡å¼•ç”¨é‡Œé¢ </span></span><br><span class="line">			UObjectBase::<span class="built_in">EmitBaseReferences</span>(<span class="keyword">this</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">check</span>(ClassAddReferencedObjects != <span class="literal">NULL</span>);</span><br><span class="line">			<span class="keyword">const</span> <span class="keyword">bool</span> bKeepOuter = <span class="literal">true</span>;	<span class="comment">// GetFName() != NAME_Package;</span></span><br><span class="line">			<span class="keyword">const</span> <span class="keyword">bool</span> bKeepClass = <span class="literal">true</span>;	<span class="comment">// !HasAnyInternalFlags(EInternalObjectFlags::Native) || IsA(UDynamicClass::StaticClass());</span></span><br><span class="line"></span><br><span class="line">			ClassAddReferencedObjectsType AddReferencedObjectsFn = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !WITH_EDITOR</span></span><br><span class="line">			<span class="comment">// éç¼–è¾‘å™¨æ¨¡å¼ä¸‹ &quot;UObject::ARO&quot; æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥ä¸éœ€è¦ &quot;ARO&quot; æ¥ç”Ÿæˆè®°å·æµ</span></span><br><span class="line">            <span class="comment">// åªæœ‰å®ç°äº†è‡ªå·±çš„ &quot;ARO&quot; å‡½æ•°çš„ç±»æ‰éœ€è¦ç”Ÿæˆè®°å·æµ</span></span><br><span class="line">			<span class="keyword">if</span> (ClassAddReferencedObjects != &amp;UObject::AddReferencedObjects)</span><br><span class="line">			&#123;</span><br><span class="line">				AddReferencedObjectsFn = ClassAddReferencedObjects;</span><br><span class="line">			&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">			AddReferencedObjectsFn = ClassAddReferencedObjects;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">            <span class="comment">// ä¿®å¤çˆ¶ç±»è®°å·æµè¿æ¥åçš„ä¸€äº›åå¤„ç†ï¼Œä¿®å¤ &quot;ReferenceTokenStream&quot; çš„ &quot;TokenIndex&quot; </span></span><br><span class="line">			ReferenceTokenStream.<span class="built_in">Fixup</span>(AddReferencedObjectsFn, bKeepOuter, bKeepClass);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (ReferenceTokenStream.<span class="built_in">IsEmpty</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ä¸ºå¼•ç”¨è®°å·æµæ·»åŠ ä¸€ä¸ªæœ«å°¾å…ƒç´ </span></span><br><span class="line">		<span class="function"><span class="keyword">static</span> <span class="keyword">const</span> FName <span class="title">EOSDebugName</span><span class="params">(<span class="string">&quot;EndOfStreamToken&quot;</span>)</span></span>;</span><br><span class="line">		<span class="built_in">EmitObjectReference</span>(<span class="number">0</span>, EOSDebugName, GCRT_EndOfStream);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// æ”¶ç¼©å¼•ç”¨è®°å·æµè‡³é€‚å½“çš„Size</span></span><br><span class="line">		ReferenceTokenStream.<span class="built_in">Shrink</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°† &quot;UClass&quot; æ ‡è®°ä¸ºå·²åˆ›å»º &quot;TokenStream&quot;</span></span><br><span class="line">		ClassFlags |= CLASS_TokenStreamAssembled;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>æœ€åï¼Œ&quot;CloseDisregardForGC&quot; å°†åœ¨ &quot;EngineLoop::PreInit&quot; çš„æœ€åé˜¶æ®µè¢«è°ƒç”¨ï¼Œä»è€Œè°ƒç”¨ &quot;AssembleReferenceTokenStreams&quot; æ¥åˆ›å»ºæ‰€æœ‰ &quot;UClass&quot; çš„å¼•ç”¨è®°å·æµï¼Œè€Œè¿™ä¹Ÿå°†æ˜¯æˆ‘ä»¬è¿™æ¬¡æ—…ç¨‹çš„ç»ˆç‚¹ã€‚æ•´ç¯‡åšå®¢å†™ä¸‹æ¥ï¼Œå…¶å®å¹¶ä¸æ˜¯ä¸€ç›´åœ¨è®² &quot;UClass&quot; çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œæœ‰æŒºå¤§ä¸€éƒ¨åˆ†ç¯‡å¹…æ˜¯åœ¨è§£é‡Š å¼•æ“ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšã€‚å› ä¸ºæˆ‘è®¤ä¸ºé˜…è¯»æºç ä¸ä»…ä»…æ˜¯ä¸ºäº†ææ¸…æ¥šè¿™ä¸€å—æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ›´åº”è¯¥é—®ä¸€ä¸‹è‡ªå·±ï¼Œä¸ºä»€ä¹ˆå¼•æ“ä¼šé€‰æ‹©è¿™ç§åšæ³•ï¼ŒçŸ¥å…¶ç„¶ä¸å¦‚çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚å¦‚æœè®©æˆ‘ä»¬æ¥å®ç°è¿™ä¸€å—çš„åŠŸèƒ½ï¼Œæˆ‘åˆæ˜¯å¦ä¼šæƒ³åˆ°è¿™ç§æ–¹æ³•ï¼Œäº¦æˆ–è€…å…¶ä»–çš„æ–¹æ¡ˆï¼Œæˆ‘è®¤ä¸ºè¿™äº›éƒ½æ˜¯å¾ˆå€¼å¾—æˆ‘ä»¬å»æ€è€ƒçš„ã€‚</p><p>æœ€åçš„æœ€åæ€»ç»“ä¸€ä¸‹æ•´ä¸ªæµç¨‹å§ã€‚</p><ul><li>ç¼–è¯‘ï¼Œ&quot;UHT&quot; ä¸ºæˆ‘ä»¬ç”Ÿæˆä¸¤ä¸ªç”¨äºå®ç°åå°„çš„ç±»ï¼Œå…¶éœ€è¦é…åˆ &quot;ObjectMacros&quot; è¿™ä¸ªç±»æ¥è¿›è¡Œä½¿ç”¨</li><li>æ”¶é›†ï¼Œåœ¨æˆ‘ä»¬å¼•æ“åˆå§‹åŒ–ä¹‹å‰ (WinMain ä¹‹å‰)ï¼ŒC++ ä¼šç”Ÿæˆ static ç±»ï¼Œè€Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ”¶é›†æ¯ä¸ªæ¨¡å—çš„ç±»ä¿¡æ¯çš„ä¸€ä¸ªæ—¶æœºï¼Œè¿™ç›´æ¥å†³å®šäº†æˆ‘ä»¬åé¢ä¼šåˆå§‹åŒ–é‚£äº›ç±»çš„ &quot;UClass&quot;</li><li>æ³¨å†Œï¼Œåœ¨è¿™ä¸ªé˜¶æ®µæˆ‘ä»¬ä¼šä¸ºæ‰€æœ‰æ”¶é›†åˆ°çš„ &quot;UClass&quot; ç”³è¯·å†…å­˜ï¼Œå¹¶è°ƒç”¨å…¶æ„é€ å‡½æ•°ï¼Œä½†åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆ Startup &quot;CoreUObject&quot; æ¨¡å—ï¼Œå› ä¸ºè¿™é‡Œé¢æœ‰æˆ‘ä»¬çš„ &quot;UObjectAllocator&quot;ï¼Œæˆ‘ä»¬ç”³è¯·å†…å­˜è¦ç”¨åˆ°ä»–ã€‚æœ€åæˆ‘ä»¬ä¼šæŠŠå¤„ç†å¥½çš„ &quot;UClass&quot; åŠ åˆ°å»¶è¿Ÿæ³¨å†Œçš„åˆ—è¡¨é‡Œé¢ï¼Œç­‰å¾…ä¸‹ä¸€æ­¥å¤„ç†</li><li>å»¶è¿Ÿæ³¨å†Œï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬ä¼šå»ä¸°å¯Œåˆšåˆšæ³¨å†Œè¿‡çš„ &quot;UClass&quot;ï¼ŒåŒ…æ‹¬ä¸€äº›ç§æœ‰å±æ€§çš„è®¾ç½® &quot;SuperClass&quot;, &quot;PackageName&quot; ç­‰ç­‰ï¼Œæˆ‘ä»¬è¿˜ä¼šå°† &quot;UClass&quot; å¯¹è±¡æ·»åŠ è¿›å…¨å±€å”¯ä¸€çš„ &quot;FUObjectHashTables&quot; é‡Œé¢ï¼Œä»¥å®ç°ä½•æ—¶ä½•åœ°éƒ½èƒ½åˆ©ç”¨ &quot;UObject ç³»ç»Ÿ&quot; çš„åå°„çš„ä¾¿åˆ©ã€‚å½“ç„¶è¿˜ä¼šå¯¹å…¶ UFunction è¿›è¡Œå¤„ç†</li><li>åå¤„ç†ï¼ˆä¹Ÿæ˜¯æ³¨å†Œï¼‰ï¼Œæˆ‘ä»¬ç»§ç»­å‰è¿›ï¼Œåˆå§‹åŒ–äº† &quot;UClass&quot; çš„å…¶ä»–å±æ€§ï¼ˆé“¾æ¥å‡½æ•°ï¼Œå±æ€§é“¾ï¼Œæ¥å£æ•°ç»„ï¼Œå…ƒæ•°æ®ç­‰ï¼‰ï¼Œåˆ›å»ºå¹¶åˆå§‹åŒ– &quot;CDO&quot;ã€‚æœ€åè¿˜å¤„ç†äº† &quot;UClass&quot; çš„å¼•ç”¨è®°å·æµã€‚åˆ°æ­¤ï¼Œå®Œäº‹æ”¶å·¥ã€‚</li></ul><p>ç»“è¯­ï¼šæ—…ç¨‹ç»“æŸï¼Œæœ‰ç‚¹ç´¯ï¼Œä¸è¿‡å¾ˆå€¼å¾—ã€‚æœŸå¾…ä¸ä½ çš„ä¸‹ä¸€æ¬¡æ—…ç¨‹ ğŸ˜ƒ</p></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-11-17 19:03:11" itemprop="dateModified" datetime="2021-11-17T19:03:11+08:00">2021-11-17</time> </span><span id="2021/11/08/UE4/UE4CPP/UClassçš„è¯ç”Ÿä¸æˆé•¿/" class="item leancloud_visitors" data-flag-title="UClassçš„è¯ç”Ÿä¸æˆé•¿" title="é˜…è¯»æ¬¡æ•°"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">é˜…è¯»æ¬¡æ•°</span> <span class="leancloud-visitors-count"></span> <span class="text">æ¬¡</span></span></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>-YIFEI- <i class="ic i-at"><em>@</em></i>ä¸€ä¸ªå¹´è½»äººå¥”å‘æ¢¦æƒ³çš„è¶³è¿¹</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://kotori_suki.github.io/2021/11/08/UE4/UE4CPP/UClass%E7%9A%84%E8%AF%9E%E7%94%9F%E4%B8%8E%E6%88%90%E9%95%BF/" title="UClassçš„è¯ç”Ÿä¸æˆé•¿">https://kotori_suki.github.io/2021/11/08/UE4/UE4CPP/UClassçš„è¯ç”Ÿä¸æˆé•¿/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/11/06/UE4/UE4CPP/Unreal%20GC%E8%BF%87%E7%A8%8B/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclga70tsj20zk0m84mr.jpg" title="Unreal GCè¿‡ç¨‹"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> UE4_C++</span><h3>Unreal GCè¿‡ç¨‹</h3></a></div><div class="item right"><a href="/2021/11/11/UE4/UE4CPP/UE4%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%B8%8E%E7%94%A8%E6%B3%95/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclflwv2aj20zk0m84qp.jpg" title="UE4ä»£ç†çš„å®ç°ä¸ç”¨æ³•"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i> UE4_C++</span><h3>UE4ä»£ç†çš„å®ç°ä¸ç”¨æ³•</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#uclass%E7%9A%84%E8%AF%9E%E7%94%9F%E4%B8%8E%E6%88%90%E9%95%BF"><span class="toc-number">1.</span> <span class="toc-text">UClass çš„è¯ç”Ÿä¸æˆé•¿</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#uclass-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">UClass ç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E-generated_body-%E5%BC%80%E5%A7%8B"><span class="toc-number">1.2.</span> <span class="toc-text">ä» &quot;GENERATED_BODY ()&quot; å¼€å§‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#declare_class"><span class="toc-number">1.2.1.</span> <span class="toc-text">DECLARE_CLASS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E5%88%B0uclass%E7%9A%84%E6%9E%84%E9%80%A0"><span class="toc-number">1.3.</span> <span class="toc-text">å›åˆ° UClass çš„æ„é€ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#uclass%E7%9A%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">UClass çš„ä¿¡æ¯æ”¶é›†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#implement_class"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">IMPLEMENT_CLASS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#z_compiledindefer_uclass_umyclassname"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">Z_CompiledInDefer_UClass_UMyClassName</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#z_construct_uclass_umyclassname"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">Z_Construct_UClass_UMyClassName</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#constructuclass"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">ConstructUClass</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uclass%E7%9A%84%E6%B3%A8%E5%86%8C"><span class="toc-number">1.3.2.</span> <span class="toc-text">UClass çš„æ³¨å†Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#uclassregisterallcompiledinclasses"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">UClassRegisterAllCompiledInClasses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getprivatestaticclassbody"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">GetPrivateStaticClassBody</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#uclassuclass"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">UClass::UClass</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#initializeprivatestaticclass"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">InitializePrivateStaticClass</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#registernativefunc"><span class="toc-number">1.3.2.5.</span> <span class="toc-text">RegisterNativeFunc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uclass%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%B3%A8%E5%86%8Ca-iduclass%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%B3%A8%E5%86%8Ca"><span class="toc-number">1.3.3.</span> <span class="toc-text">UClass çš„å»¶è¿Ÿæ³¨å†Œ &lt;a id&#x3D;&quot;UClass çš„å»¶è¿Ÿæ³¨å†Œ&quot;&gt;&lt;&#x2F;a&gt;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#staticuobjectinit"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">StaticUObjectInit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#uobjectbaseinit"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">UObjectBaseInit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#uobjectprocessregistrants"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">UObjectProcessRegistrants</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#uobjectforceregistration"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">UObjectForceRegistration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hashobject"><span class="toc-number">1.3.3.5.</span> <span class="toc-text">HashObject</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%A4%84%E7%90%86%E6%B3%A8%E5%86%8C%E7%9A%84%E5%90%8E%E5%8D%8A%E9%83%A8%E5%88%86"><span class="toc-number">1.3.4.</span> <span class="toc-text">åå¤„ç†ï¼ˆæ³¨å†Œçš„ååŠéƒ¨åˆ†ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#processnewlyloadeduobjects"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">ProcessNewlyLoadedUObjects</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#uobjectloadallcompiledindefaultproperties"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">UObjectLoadAllCompiledInDefaultProperties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getdefaultobject"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">GetDefaultObject</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#assemblereferencetokenstreams"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">AssembleReferenceTokenStreams</span></a></li></ol></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li><a href="/2021/10/25/UE4/UE4CPP/API%E4%B8%8D%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C-%E4%B9%8B-GetGameMode/" rel="bookmark" title="APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetGameMode">APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetGameMode</a></li><li><a href="/2021/10/25/UE4/UE4CPP/API%E4%B8%8D%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C-%E4%B9%8B-GetPlayerController/" rel="bookmark" title="APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetPlayerController">APIä¸æ­£å¸¸å·¥ä½œ ä¹‹ GetPlayerController</a></li><li><a href="/2021/10/25/UE4/UE4CPP/unreal%20%E5%BC%95%E6%93%8E%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" rel="bookmark" title="unrealå¼•æ“å¯åŠ¨æµç¨‹">unrealå¼•æ“å¯åŠ¨æµç¨‹</a></li><li><a href="/2021/10/26/UE4/UE4CPP/%E4%BB%8ESVG%E6%96%87%E4%BB%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E6%97%85%E7%A8%8B/" rel="bookmark" title="ä»SVGæ–‡ä»¶å¼€å§‹çš„æ—…ç¨‹~~~">ä»SVGæ–‡ä»¶å¼€å§‹çš„æ—…ç¨‹~~~</a></li><li><a href="/2021/10/29/UE4/UE4CPP/%E5%8F%8D%E5%B0%84%E7%B3%BB%E7%BB%9F%20API/" rel="bookmark" title="åå°„ç³»ç»ŸAPI  è§£æå’Œä½¿ç”¨">åå°„ç³»ç»ŸAPI è§£æå’Œä½¿ç”¨</a></li><li><a href="/2021/10/31/UE4/UE4CPP/Session%E7%9A%84%E4%BD%BF%E7%94%A8%20C++%E7%AF%87/" rel="bookmark" title="Sessionçš„ä½¿ç”¨ C++ç¯‡">Sessionçš„ä½¿ç”¨ C++ç¯‡</a></li><li><a href="/2021/11/02/UE4/UE4CPP/Unreal%20%E5%BA%8F%E5%88%97%E5%8C%96/" rel="bookmark" title="Unreal åºåˆ—åŒ–~~~">Unreal åºåˆ—åŒ–~~~</a></li><li><a href="/2021/11/06/UE4/UE4CPP/Unreal%20GC%E8%BF%87%E7%A8%8B/" rel="bookmark" title="Unreal GCè¿‡ç¨‹">Unreal GCè¿‡ç¨‹</a></li><li class="active"><a href="/2021/11/08/UE4/UE4CPP/UClass%E7%9A%84%E8%AF%9E%E7%94%9F%E4%B8%8E%E6%88%90%E9%95%BF/" rel="bookmark" title="UClassçš„è¯ç”Ÿä¸æˆé•¿">UClassçš„è¯ç”Ÿä¸æˆé•¿</a></li><li><a href="/2021/11/11/UE4/UE4CPP/UE4%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%B8%8E%E7%94%A8%E6%B3%95/" rel="bookmark" title="UE4ä»£ç†çš„å®ç°ä¸ç”¨æ³•">UE4ä»£ç†çš„å®ç°ä¸ç”¨æ³•</a></li><li><a href="/2021/11/15/UE4/UE4CPP/FProperty%E7%9A%84%E5%88%86%E6%9E%90%E4%B8%8E%E6%80%BB%E7%BB%93/" rel="bookmark" title="FPropertyçš„åˆ†æä¸æ€»ç»“">FPropertyçš„åˆ†æä¸æ€»ç»“</a></li><li><a href="/2021/11/22/UE4/UE4CPP/Unreal%20%E5%A4%9A%E7%A7%8D%E6%8C%87%E9%92%88%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/" rel="bookmark" title="Unreal å¤šç§æŒ‡é’ˆå®ç°åŸç†">Unreal å¤šç§æŒ‡é’ˆå®ç°åŸç†</a></li><li><a href="/2021/11/26/UE4/UE4CPP/Unreal%20Slate/" rel="bookmark" title="Unreal Slate">Unreal Slate</a></li><li><a href="/2021/12/01/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20%E6%80%BB%E8%A7%88%20&%20UEngine%20&%20UGameInstance/" rel="bookmark" title="Gameplay â€”â€” æ€»è§ˆ & UEngine & UGameInstance">Gameplay â€”â€” æ€»è§ˆ & UEngine & UGameInstance</a></li><li><a href="/2021/12/03/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20FWorldContext%20&%20UWorld%20&%20ULevel/" rel="bookmark" title="Gameplay â€”â€” FWorldContext & UWorld & ULevel">Gameplay â€”â€” FWorldContext & UWorld & ULevel</a></li><li><a href="/2021/12/06/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20AActor%20&%20UActorComponent/" rel="bookmark" title="Gameplay â€”â€” AActor & UActorComponent">Gameplay â€”â€” AActor & UActorComponent</a></li><li><a href="/2021/12/09/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20APawn%20&%20AController%20&%20APlayerController/" rel="bookmark" title="Gameplay â€”â€” APawn & AController & APlayerController">Gameplay â€”â€” APawn & AController & APlayerController</a></li><li><a href="/2021/12/12/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20AGameMode%20&%20AGameState%20&%20APlayerState/" rel="bookmark" title="Gameplay â€”â€” AGameMode & AGameState & APlayerState">Gameplay â€”â€” AGameMode & AGameState & APlayerState</a></li><li><a href="/2021/12/15/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20USavegame%20&%20UPlayer/" rel="bookmark" title="Gameplay â€”â€” USavegame & UPlayer">Gameplay â€”â€” USavegame & UPlayer</a></li><li><a href="/2021/12/17/UE4/UE4CPP/Unreal%20GAS%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" rel="bookmark" title="Unreal GAS æºç è§£æ">Unreal GAS æºç è§£æ</a></li><li><a href="/2021/12/28/UE4/UE4CPP/CustomItemModule/" rel="bookmark" title="Custom Item Module">Custom Item Module</a></li><li><a href="/2021/12/30/UE4/UE4CPP/Unreal%20%E5%BC%82%E6%AD%A5%E4%B8%8E%E5%B9%B6%E8%A1%8C%E7%BC%96%E7%A8%8B/" rel="bookmark" title="Unreal å¼‚æ­¥ä¸å¹¶è¡Œç¼–ç¨‹">Unreal å¼‚æ­¥ä¸å¹¶è¡Œç¼–ç¨‹</a></li><li><a href="/2022/01/03/UE4/UE4CPP/Unreal%20MovementComponent%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" rel="bookmark" title="Unreal MovementComponent æºç è§£æ">Unreal MovementComponent æºç è§£æ</a></li><li><a href="/2022/01/08/UE4/UE4CPP/Unreal%20%E8%93%9D%E5%9B%BE%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/" rel="bookmark" title="Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶">Unreal è“å›¾åº•å±‚å®ç°æœºåˆ¶</a></li><li><a href="/2022/02/12/UE4/UE4CPP/Unreal%20%E5%8A%A8%E7%94%BB%E7%9B%B8%E5%85%B3/" rel="bookmark" title="Unreal MotionMatching">Unreal MotionMatching</a></li><li><a href="/2022/03/15/UE4/UE4CPP/Unreal%20%E5%B8%B8%E7%94%A8%E6%8E%A5%E5%8F%A3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%20%E4%B9%8B%E4%B8%80/" rel="bookmark" title="Unreal å¸¸ç”¨æ¥å£æºç åˆ†æ ä¹‹ä¸€">Unreal å¸¸ç”¨æ¥å£æºç åˆ†æ ä¹‹ä¸€</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="-YIFEI-" data-src="/images/avatar.jpg"><p class="name" itemprop="name">-YIFEI-</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">57</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">15</span> <span class="name">åˆ†ç±»</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0tvdG9yaS1TdWtp" title="https:&#x2F;&#x2F;github.com&#x2F;Kotori-Suki"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS90dnQtNjA=" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;tvt-60"><i class="ic i-zhihu"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li></ul></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/11/06/UE4/UE4CPP/Unreal%20GC%E8%BF%87%E7%A8%8B/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/11/11/UE4/UE4CPP/UE4%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%B8%8E%E7%94%A8%E6%B3%95/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A6%82%E8%BF%B0/" title="åˆ†ç±»äº æ¦‚è¿°">æ¦‚è¿°</a></div><span><a href="/2021/08/16/CPPBase/DesignPattern/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%85%AD%E5%A4%A7%E5%8E%9F%E5%88%99%20&%20%E6%A6%82%E8%BF%B0/" title="è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™ &amp; æ¦‚è¿°">è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™ & æ¦‚è¿°</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/Gameplay/" title="åˆ†ç±»äº Gameplay">Gameplay</a></div><span><a href="/2021/12/12/UE4/UE4CPP/Gameplay%20%E2%80%94%E2%80%94%20AGameMode%20&%20AGameState%20&%20APlayerState/" title="Gameplay â€”â€” AGameMode &amp; AGameState &amp; APlayerState">Gameplay â€”â€” AGameMode & AGameState & APlayerState</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a></div><span><a href="/2021/10/25/UE4/UE4CPP/unreal%20%E5%BC%95%E6%93%8E%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/" title="unrealå¼•æ“å¯åŠ¨æµç¨‹">unrealå¼•æ“å¯åŠ¨æµç¨‹</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a></div><span><a href="/2021/08/20/CPPBase/%E5%85%B3%E9%94%AE%E8%AF%8D%E8%A7%A3%E6%9E%90/" title="C++å…³é”®è¯è§£æ">C++å…³é”®è¯è§£æ</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a></div><span><a href="/2021/08/23/CPPBase/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98/" title="è¿­ä»£å™¨å¤±æ•ˆé—®é¢˜">è¿­ä»£å™¨å¤±æ•ˆé—®é¢˜</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è¡Œä¸ºå‹æ¨¡å¼">è¡Œä¸ºå‹æ¨¡å¼</a></div><span><a href="/2021/08/19/CPPBase/DesignPattern/Strategy/" title="ç­–ç•¥æ¨¡å¼">ç­–ç•¥æ¨¡å¼</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è¡Œä¸ºå‹æ¨¡å¼">è¡Œä¸ºå‹æ¨¡å¼</a></div><span><a href="/2021/08/19/CPPBase/DesignPattern/TemplateMethod/" title="æ¨¡æ¿æ¨¡å¼">æ¨¡æ¿æ¨¡å¼</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/UE4/" title="åˆ†ç±»äº UE4">UE4</a> <i class="ic i-angle-right"></i> <a href="/categories/UE4/UE4CPP/" title="åˆ†ç±»äº UE4_C++">UE4_C++</a></div><span><a href="/2021/11/15/UE4/UE4CPP/FProperty%E7%9A%84%E5%88%86%E6%9E%90%E4%B8%8E%E6%80%BB%E7%BB%93/" title="FPropertyçš„åˆ†æä¸æ€»ç»“">FPropertyçš„åˆ†æä¸æ€»ç»“</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</a> <i class="ic i-angle-right"></i> <a href="/categories/CPPBase/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="åˆ†ç±»äº è¡Œä¸ºå‹æ¨¡å¼">è¡Œä¸ºå‹æ¨¡å¼</a></div><span><a href="/2021/08/21/CPPBase/DesignPattern/State/" title="çŠ¶æ€æ¨¡å¼">çŠ¶æ€æ¨¡å¼</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CPPBase/" title="åˆ†ç±»äº C++åŸºç¡€">C++åŸºç¡€</a></div><span><a href="/2021/08/20/CPPBase/C++11%E6%96%B0%E7%89%B9%E6%80%A7/" title="C++11æ–°ç‰¹æ€§ ä½¿ç”¨ç¯‡1">C++11æ–°ç‰¹æ€§ ä½¿ç”¨ç¯‡1</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2021 â€“ <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">-YIFEI- @ Afei's Blog</span></div><div class="powered-by">åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/11/08/UE4/UE4CPP/UClassçš„è¯ç”Ÿä¸æˆé•¿/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰ã‚„ã‚Œã‚„ã‚Œã ãœ",hide:"(Â´Ğ”ï½€)å¤§å¤‰ã ï¼"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>